{"version":3,"sources":["webpack://GoldenLayout/webpack/universalModuleDefinition","webpack://GoldenLayout/webpack/bootstrap","webpack://GoldenLayout/external {\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\",\"root\":\"$\"}","webpack://GoldenLayout/./src/js_es6/utils/utils.js","webpack://GoldenLayout/./src/js_es6/utils/EventEmitter.js","webpack://GoldenLayout/./src/js_es6/utils/ConfigMinifier.js","webpack://GoldenLayout/./src/js_es6/utils/EventHub.js","webpack://GoldenLayout/./src/js_es6/utils/BubblingEvent.js","webpack://GoldenLayout/./src/js_es6/errors/ConfigurationError.js","webpack://GoldenLayout/./src/js_es6/config/ItemDefaultConfig.js","webpack://GoldenLayout/./src/js_es6/items/AbstractContentItem.js","webpack://GoldenLayout/./src/js_es6/utils/DragListener.js","webpack://GoldenLayout/./src/js_es6/controls/DragProxy.js","webpack://GoldenLayout/./src/js_es6/controls/Tab.js","webpack://GoldenLayout/./src/js_es6/controls/HeaderButton.js","webpack://GoldenLayout/./src/js_es6/controls/Header.js","webpack://GoldenLayout/./src/js_es6/items/Stack.js","webpack://GoldenLayout/./src/js_es6/controls/Splitter.js","webpack://GoldenLayout/./src/js_es6/items/RowOrColumn.js","webpack://GoldenLayout/./src/js_es6/items/Root.js","webpack://GoldenLayout/./src/js_es6/container/ItemContainer.js","webpack://GoldenLayout/./src/js_es6/utils/ReactComponentHandler.js","webpack://GoldenLayout/./src/js_es6/items/Component.js","webpack://GoldenLayout/./src/js_es6/controls/BrowserPopout.js","webpack://GoldenLayout/./src/js_es6/controls/DragSource.js","webpack://GoldenLayout/./src/js_es6/controls/DropTargetIndicator.js","webpack://GoldenLayout/./src/js_es6/controls/TransitionIndicator.js","webpack://GoldenLayout/./src/js_es6/config/defaultConfig.js","webpack://GoldenLayout/./src/js_es6/LayoutManager.js"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__0__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","getTouchEvent","event","$","zepto","touches","targetTouches","originalEvent","getQueryStringParam","param","location","hash","matches","match","RegExp","search","pair","keyValuePairs","substr","split","params","length","copy","target","source","animFrame","fn","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","setTimeout","indexOf","needle","haystack","Array","Error","isFunction","Int8Array","obj","toString","fnBind","context","boundArgs","undefined","Function","apply","concat","bound","args","slice","arguments","this","getUniqueId","Math","random","replace","stripTags","input","trim","EventEmitter","_mSubscriptions","on","sEvent","fCallback","oContext","push","ctx","emit","subs","unshift","allEventSubs","unbind","bUnbound","splice","off","trigger","ConfigMinifier","_keys","_values","config","min","_nextLevel","minifiedConfig","orig","from","to","translationFn","minKey","parseInt","dictionary","index","EventHub","layoutManager","_layoutManager","_dontPropagateToParent","_childEventSource","_onEventFromThis","_boundOnEventFromChild","_onEventFromChild","isSubWindow","_propagateToParent","_propagateToChildren","__gl","__glArgs","document","createEvent","opener","initEvent","createEventObject","eventType","eventName","dispatchEvent","fireEvent","childGl","openPopouts","getGlInstance","eventHub","_$onEventFromParent","BubblingEvent","origin","isPropagationStopped","ConfigurationError","message","node","itemDefaultConfig","isClosable","reorderEnabled","title","AbstractContentItem","parent","_extendItemNode","type","contentItems","isInitialised","isMaximised","isRoot","isRow","isColumn","isStack","isComponent","_pendingEventPropagations","_throttledEvents","_propagateEvent","content","_createContentItems","functionName","functionArguments","bottomUp","skipSelf","callDownwards","contentItem","keepChild","_$destroy","Root","removeChild","undisplayChild","_$init","oldChild","newChild","_$destroyOldChild","_$normalizeContentItem","parentNode","element","replaceChild","header","tabs","browserPopout","createPopout","emitBubblingEvent","e","preventDefault","_$minimiseItem","_$maximiseItem","selectedItem","selectItem","addClass","removeClass","id","hasId","filter","result","next","getItemsByFilter","item","_$getItemsByProperty","componentName","components","instances","instance","x","y","area","dropTargetIndicator","highlightArea","addChild","_callOnActiveComponents","hide","updateSize","show","methodName","activeContentItem","stacks","getItemsByType","getActiveContentItem","container","remove","offset","width","height","x1","left","y1","top","x2","y2","surface","setSize","childElementContainer","append","oContentItem","createContentItem","_scheduleEventPropagationToLayoutManager","_propagateEventToLayoutManager","DragListener","eElement","nButtonCode","_timeout","_eElement","_oDocument","_eBody","body","_nButtonCode","_nDelay","_nDistance","_nX","_nY","_nOriginalX","_nOriginalY","_bDragging","_fMove","onMouseMove","_fUp","onMouseUp","_fDown","onMouseDown","oEvent","button","coordinates","_getCoordinates","one","_startDrag","abs","clearTimeout","find","css","pageX","pageY","DragProxy","dragListener","originalParent","_dragListener","_contentItem","_originalParent","_area","_lastValidArea","_onDrag","_onDrop","_side","_sided","after","attr","html","_undisplayTree","_$calculateItemAreas","_setDimensions","_minX","_minY","_maxX","_maxY","_width","_height","_setDropPosition","offsetX","offsetY","settings","constrainDragToContainer","_$getArea","_$highlightDropZone","_updateTree","_$onDrop","_$setParent","dimensions","dragProxyWidth","dragProxyHeight","headerHeight","Tab","titleElement","closeElement","isActive","setTitle","_onDragStart","destroy","_onTabClickFn","_onTabClick","_onCloseClickFn","_onCloseClick","_onCloseMousedown","tab","_canDestroy","toggleMaximise","setActiveContentItem","stopPropagation","HeaderButton","label","cssClass","action","_header","_action","controlsContainer","_template","join","Header","selectionEnabled","_onHeaderClick","tabsContainer","tabDropdownContainer","_updateTabSizes","tabsMarkedForRemoval","closeButton","dockButton","tabDropdownButton","hideAdditionalTabsDropdown","_hideAdditionalTabsDropdown","mouseup","_lastVisibleTabIndex","_tabControlOffset","tabControlOffset","_createControls","before","j","activeTab","setActive","activeItemIndex","reorderOnTabMenuClick","position","previous","_docker","docked","_setupHeaderPosition","_isClosable","isDockable","dock","toggle","closeStack","popout","maximiseLabel","minimiseLabel","maximise","maximiseButton","tabDropdownLabel","showTabDropdown","_showAdditionalTabsDropdown","labels","tabDropdown","_getHeaderSetting","_onPopoutClick","showCloseIcon","popoutWholeStack","select","showTabMenu","size","val","tabElement","marginLeft","availableWidth","outerWidth","cumulativeTabWidth","visibleTabWidth","overlap","tabOverlapAllowance","tabOverlapAllowanceExceeded","activeIndex","outerHeight","Stack","_activeContentItem","cfg","hasHeaders","showPopoutIcon","showMaximiseIcon","close","minimise","_dropZones","_dropSegment","_contentAreaDimensions","_dropIndex","dimension","realSize","_$validateClosability","RowOrColumn","isDocked","initialItem","createTab","_$hide","_validateDocking","_$show","removeTab","max","hideTab","len","_$setClosable","_resetHeaderDropZone","stack","rowOrColumn","isVertical","isHorizontal","insertBefore","hasCorrectParent","segment","hoverArea","_highlightHeaderDropZone","_highlightBodyDropZone","getArea","headerArea","contentArea","contentWidth","contentHeight","right","bottom","tabTop","tabLeft","placeHolderLeft","headerOffset","tabWidth","tabsLength","isAboveTab","tabDropPlaceholder","placeHolderTop","innerHeight","side","headerPosition","Splitter","grabSize","_isVertical","_size","_grabSize","_createElement","dragHandle","handleExcessSize","handleExcessPos","_splitterSize","borderWidth","_splitterGrabSize","borderGrabWidth","_isColumn","_dimension","_splitter","_splitterPosition","_splitterMinPosition","_splitterMaxPosition","_$suspendResize","newItemSize","itemSize","splitterElement","_createSplitter","_isDocked","undisplayedItemSize","splitterIndex","childItem","removedItemSize","_calculateRelativeSizes","_setAbsoluteSizes","collapsed","headerSize","required","column","first","last","row","toggleClass","sizeData","_calculateAbsoluteSizes","additionalPixel","itemSizes","totalWidth","totalHeight","totalSplitterSize","totalAssigned","floor","total","itemsWithoutSetDimension","round","_respectMinItemWidth","reducePercent","reducedWidth","entry","minItemWidth","entriesOverMin","totalOverMin","totalUnderMin","remainingWidth","allEntries","splitter","_onSplitterDrag","_onSplitterDragStop","_onSplitterDragStart","count","that","can","_setDockable","arr","minWidth","minHeight","horizontal","vertical","items","_getItemsForSplitter","minSize","beforeMinDim","_getMinimumDimensions","beforeMinSize","afterMinDim","afterMinSize","sizeBefore","sizeAfter","splitterPositionInRange","totalRelativeSize","containerElement","_containerElement","sibbling","ItemContainer","isHidden","_config","_element","_contentElement","percentage","direction","delta","rowOrColumnChild","componentState","state","setState","extend","getState","ReactComponentHandler","_reactComponent","_originalComponentWillUpdate","_container","_initialState","_reactClass","_getReactClass","_render","_destroy","ReactDOM","render","_getReactComponent","getElement","component","componentWillUpdate","_onUpdate","unmountComponentAtNode","nextProps","nextState","reactClass","getComponent","defaultProps","glEventHub","glContainer","ref","_gotReactComponent","props","React","createElement","Component","ComponentConstructor","isReactConfig","componentConfig","_$setSize","shown","_$shown","BrowserPopout","parentId","indexInParent","_dimensions","_parentId","_indexInParent","_popoutWindow","_id","_createWindow","screenX","screenLeft","screenY","screenTop","toConfig","__glInstance","_$closeWindow","getWindow","childConfig","parentItem","getItemsById","checkReadyInterval","url","_createUrl","options","_serializeWindowOptions","innerWidth","menubar","toolbar","personalbar","resizable","scrollbars","status","open","_positionWindow","_onClose","setInterval","_onInitialised","clearInterval","blockedPopoutsThrowError","error","windowOptions","windowOptionsString","urlParts","storageKey","minifyConfig","localStorage","setItem","JSON","stringify","href","moveTo","focus","popIn","DragSource","itemConfig","_itemConfig","_createDragListener","_removeDragListener","dragProxy","transitionIndicator","transitionElements","DropTargetIndicator","TransitionIndicator","_toElement","_fromDimensions","_totalAnimationDuration","_animationStartTime","fromElement","toElement","cssProperty","toDimensions","_measure","animationProgress","Date","now","getTime","currentFrameStyles","opacity","_nextAnimationFrame","defaultConfig","closePopoutsOnUnload","responsiveMode","minItemHeight","popin","LayoutManager","_isFullPage","_resizeTimeoutId","_components","_itemAreas","_resizeFunction","_onResize","_unloadFunction","_onUnload","_maximisedItem","_maximisePlaceholder","_creationTimeoutPassed","_subWindowsCreated","_dragSources","_updatingColumnsResponsive","_firstLoad","_createConfig","_typeToItem","unminifyConfig","constructor","_componentFunction","console","warn","configNode","_$reconcilePopoutWindows","maximisedItemId","getComponentNameFromConfig","componentToUse","_createSubWindows","readyState","init","_adjustToWindowMode","_setContainer","_create","_bindEvents","_adjustColumnsResponsive","ready","forEach","dragSource","typeErrorMsg","keys","objectKeys","configOrContentItem","windowLeft","windowTop","child","isItem","self","addId","isNaN","lm","utils","removeFromArray","_$silent","deselect","_$cleanupBeforeMaximisedItemDestroyed","prepend","removeId","smallestSurface","Infinity","mathingArea","sides","allContentItems","_getAllContentItems","_$createRootItemAreas","contentItemOrConfig","isPlainObject","newContentItem","closed","addChildren","resize","windowConfigKey","getItem","parse","removeItem","nextNode","popInButton","click","offsetHeight","margin","padding","overflow","errorMsg","_useResponsiveLayout","columnCount","stackColumnCount","rootContentItem","firstStackContainer","_findAllStackContainers","_addChildContentItemsToContainer","stackContainers","_findAllStackContainersRecursive"],"mappings":"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","file":"golden-layout.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"jquery\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"GoldenLayout\"] = factory(require(\"jquery\"));\n\telse\n\t\troot[\"GoldenLayout\"] = factory(root[\"$\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","import $ from 'jquery'\r\n\r\nexport function F() {}\r\n\r\nexport function getTouchEvent(event){\r\n    if($.zepto){\r\n        return event.touches ? event.targetTouches[0] : event;\r\n    } else {\r\n        return event.originalEvent && event.originalEvent.touches ? event.originalEvent.touches[0] : event;\r\n    }\r\n}\r\n\r\nexport function extend(subClass, superClass) {\r\n    subClass.prototype = createObject(superClass.prototype);\r\n    subClass.prototype.contructor = subClass;\r\n}\r\n\r\nexport function createObject(prototype) {\r\n    if (typeof Object.create === 'function') {\r\n        return Object.create(prototype);\r\n    } else {\r\n        F.prototype = prototype;\r\n        return new F();\r\n    }\r\n}\r\n\r\nexport function objectKeys(object) {\r\n    var keys, key;\r\n\r\n    if (typeof Object.keys === 'function') {\r\n        return Object.keys(object);\r\n    } else {\r\n        keys = [];\r\n        for (key in object) {\r\n            keys.push(key);\r\n        }\r\n        return keys;\r\n    }\r\n}\r\n\r\nexport function getHashValue(key) {\r\n    var matches = location.hash.match(new RegExp(key + '=([^&]*)'));\r\n    return matches ? matches[1] : null;\r\n}\r\n\r\nexport function getQueryStringParam(param) {\r\n    if (window.location.hash) {\r\n        return getHashValue(param);\r\n    } else if (!window.location.search) {\r\n        return null;\r\n    }\r\n\r\n    var keyValuePairs = window.location.search.substr(1).split('&'),\r\n        params = {},\r\n        pair,\r\n        i;\r\n\r\n    for (i = 0; i < keyValuePairs.length; i++) {\r\n        pair = keyValuePairs[i].split('=');\r\n        params[pair[0]] = pair[1];\r\n    }\r\n\r\n    return params[param] || null;\r\n}\r\n\r\nexport function copy(target, source) {\r\n    for (var key in source) {\r\n        target[key] = source[key];\r\n    }\r\n    return target;\r\n}\r\n\r\n/**\r\n * This is based on Paul Irish's shim, but looks quite odd in comparison. Why?\r\n * Because\r\n * a) it shouldn't affect the global requestAnimationFrame function\r\n * b) it shouldn't pass on the time that has passed\r\n *\r\n * @param   {Function} fn\r\n *\r\n * @returns {void}\r\n */\r\nexport function animFrame(fn) {\r\n    return (window.requestAnimationFrame ||\r\n        window.webkitRequestAnimationFrame ||\r\n        window.mozRequestAnimationFrame ||\r\n        function(callback) {\r\n            window.setTimeout(callback, 1000 / 60);\r\n        })(function() {\r\n        fn();\r\n    });\r\n}\r\n\r\nexport function indexOf(needle, haystack) {\r\n    if (!(haystack instanceof Array)) {\r\n        throw new Error('Haystack is not an Array');\r\n    }\r\n\r\n    if (haystack.indexOf) {\r\n        return haystack.indexOf(needle);\r\n    } else {\r\n        for (var i = 0; i < haystack.length; i++) {\r\n            if (haystack[i] === needle) {\r\n                return i;\r\n            }\r\n        }\r\n        return -1;\r\n    }\r\n}\r\n\r\n\r\nexport var isFunction = (typeof /./ != 'function' && typeof Int8Array != 'object') ? \r\n    function isFunction(obj) {\r\n        return typeof obj == 'function' || false;\r\n    } : function isFunction(obj) {\r\n        return toString.call(obj) === '[object Function]';\r\n    }\r\n\r\nexport function fnBind(fn, context, boundArgs) {\r\n\r\n    if (Function.prototype.bind !== undefined) {\r\n        return Function.prototype.bind.apply(fn, [context].concat(boundArgs || []));\r\n    }\r\n\r\n    var bound = function() {\r\n\r\n        // Join the already applied arguments to the now called ones (after converting to an array again).\r\n        var args = (boundArgs || []).concat(Array.prototype.slice.call(arguments, 0));\r\n\r\n        // If not being called as a constructor\r\n        if (!(this instanceof bound)) {\r\n            // return the result of the function called bound to target and partially applied.\r\n            return fn.apply(context, args);\r\n        }\r\n        // If being called as a constructor, apply the function bound to self.\r\n        fn.apply(this, args);\r\n    };\r\n    // Attach the prototype of the function to our newly created function.\r\n    bound.prototype = fn.prototype;\r\n    return bound;\r\n}\r\n\r\nexport function removeFromArray(item, array) {\r\n    var index = indexOf(item, array);\r\n\r\n    if (index === -1) {\r\n        throw new Error('Can\\'t remove item from array. Item is not in the array');\r\n    }\r\n\r\n    array.splice(index, 1);\r\n}\r\n\r\nexport function now() {\r\n    if (typeof Date.now === 'function') {\r\n        return Date.now();\r\n    } else {\r\n        return (new Date()).getTime();\r\n    }\r\n}\r\n\r\nexport function getUniqueId() {\r\n    return (Math.random() * 1000000000000000)\r\n        .toString(36)\r\n        .replace('.', '');\r\n}\r\n\r\n/**\r\n * A basic XSS filter. It is ultimately up to the\r\n * implementing developer to make sure their particular\r\n * applications and usecases are save from cross site scripting attacks\r\n *\r\n * @param   {String} input\r\n * @param    {Boolean} keepTags\r\n *\r\n * @returns {String} filtered input\r\n */\r\nexport function filterXss(input, keepTags) {\r\n\r\n    var output = input\r\n        .replace(/javascript/gi, 'j&#97;vascript')\r\n        .replace(/expression/gi, 'expr&#101;ssion')\r\n        .replace(/onload/gi, 'onlo&#97;d')\r\n        .replace(/script/gi, '&#115;cript')\r\n        .replace(/onerror/gi, 'on&#101;rror');\r\n\r\n    if (keepTags === true) {\r\n        return output;\r\n    } else {\r\n        return output\r\n            .replace(/>/g, '&gt;')\r\n            .replace(/</g, '&lt;');\r\n    }\r\n}\r\n\r\n/**\r\n * Removes html tags from a string\r\n *\r\n * @param   {String} input\r\n *\r\n * @returns {String} input without tags\r\n */\r\nexport function stripTags(input) {\r\n    return $.trim(input.replace(/(<([^>]+)>)/ig, ''));\r\n}\r\n","import {\r\n    isFunction\r\n} from '../utils/utils'\r\n\r\n/**\r\n * The name of the event that's triggered for every other event\r\n *\r\n * usage\r\n *\r\n * myEmitter.on( EventEmitter.ALL_EVENT, function( eventName, argsArray ){\r\n *  //do stuff\r\n * });\r\n *\r\n * @type {String}\r\n */\r\nexport const ALL_EVENT = '__all'\r\n\r\n\r\n/**\r\n * A generic and very fast EventEmitter\r\n * implementation. On top of emitting the\r\n * actual event it emits an\r\n *\r\n * EventEmitter.ALL_EVENT\r\n *\r\n * event for every event triggered. This allows\r\n * to hook into it and proxy events forwards\r\n *\r\n * @constructor\r\n */\r\nexport default class EventEmitter {\r\n\r\n    constructor() {\r\n        this._mSubscriptions = {};\r\n        this._mSubscriptions[ALL_EVENT] = [];\r\n\r\n\r\n        /**\r\n         * Listen for events\r\n         *\r\n         * @param   {String} sEvent    The name of the event to listen to\r\n         * @param   {Function} fCallback The callback to execute when the event occurs\r\n         * @param   {[Object]} oContext The value of the this pointer within the callback function\r\n         *\r\n         * @returns {void}\r\n         */\r\n        this.on = function(sEvent, fCallback, oContext) {\r\n            if (!isFunction(fCallback)) {\r\n                throw new Error('Tried to listen to event ' + sEvent + ' with non-function callback ' + fCallback);\r\n            }\r\n\r\n            if (!this._mSubscriptions[sEvent]) {\r\n                this._mSubscriptions[sEvent] = [];\r\n            }\r\n\r\n            this._mSubscriptions[sEvent].push({\r\n                fn: fCallback,\r\n                ctx: oContext\r\n            });\r\n        };\r\n\r\n        /**\r\n         * Emit an event and notify listeners\r\n         *\r\n         * @param   {String} sEvent The name of the event\r\n         * @param    {Mixed}  various additional arguments that will be passed to the listener\r\n         *\r\n         * @returns {void}\r\n         */\r\n        this.emit = function(sEvent) {\r\n            var i, ctx, args;\r\n\r\n            args = Array.prototype.slice.call(arguments, 1);\r\n\r\n            var subs = this._mSubscriptions[sEvent];\r\n\r\n            if (subs) {\r\n                subs = subs.slice();\r\n                for (i = 0; i < subs.length; i++) {\r\n                    ctx = subs[i].ctx || {};\r\n                    subs[i].fn.apply(ctx, args);\r\n                }\r\n            }\r\n\r\n            args.unshift(sEvent);\r\n\r\n            var allEventSubs = this._mSubscriptions[ALL_EVENT].slice()\r\n\r\n            for (i = 0; i < allEventSubs.length; i++) {\r\n                ctx = allEventSubs[i].ctx || {};\r\n                allEventSubs[i].fn.apply(ctx, args);\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Removes a listener for an event, or all listeners if no callback and context is provided.\r\n         *\r\n         * @param   {String} sEvent    The name of the event\r\n         * @param   {Function} fCallback The previously registered callback method (optional)\r\n         * @param   {Object} oContext  The previously registered context (optional)\r\n         *\r\n         * @returns {void}\r\n         */\r\n        this.unbind = function(sEvent, fCallback, oContext) {\r\n            if (!this._mSubscriptions[sEvent]) {\r\n                throw new Error('No subscribtions to unsubscribe for event ' + sEvent);\r\n            }\r\n\r\n            var i, bUnbound = false;\r\n\r\n            for (i = 0; i < this._mSubscriptions[sEvent].length; i++) {\r\n                if (\r\n                    (!fCallback || this._mSubscriptions[sEvent][i].fn === fCallback) &&\r\n                    (!oContext || oContext === this._mSubscriptions[sEvent][i].ctx)\r\n                ) {\r\n                    this._mSubscriptions[sEvent].splice(i, 1);\r\n                    bUnbound = true;\r\n                }\r\n            }\r\n\r\n            if (bUnbound === false) {\r\n                throw new Error('Nothing to unbind for ' + sEvent);\r\n            }\r\n        };\r\n\r\n        /**\r\n         * Alias for unbind\r\n         */\r\n        this.off = this.unbind;\r\n\r\n        /**\r\n         * Alias for emit\r\n         */\r\n        this.trigger = this.emit;\r\n    }\r\n}\r\n","import {\r\n    indexOf\r\n} from '../utils/utils'\r\n\r\n/**\r\n * Minifies and unminifies configs by replacing frequent keys\r\n * and values with one letter substitutes. Config options must\r\n * retain array position/index, add new options at the end.\r\n *\r\n * @constructor\r\n */\r\n\r\n\r\nexport default class ConfigMinifier {\r\n    constructor() {\r\n        this._keys = [\r\n            'settings',\r\n            'hasHeaders',\r\n            'constrainDragToContainer',\r\n            'selectionEnabled',\r\n            'dimensions',\r\n            'borderWidth',\r\n            'minItemHeight',\r\n            'minItemWidth',\r\n            'headerHeight',\r\n            'dragProxyWidth',\r\n            'dragProxyHeight',\r\n            'labels',\r\n            'close',\r\n            'maximise',\r\n            'minimise',\r\n            'popout',\r\n            'content',\r\n            'componentName',\r\n            'componentState',\r\n            'id',\r\n            'width',\r\n            'type',\r\n            'height',\r\n            'isClosable',\r\n            'title',\r\n            'popoutWholeStack',\r\n            'openPopouts',\r\n            'parentId',\r\n            'activeItemIndex',\r\n            'reorderEnabled',\r\n            'borderGrabWidth',\r\n\r\n\r\n\r\n\r\n            //Maximum 36 entries, do not cross this line!\r\n        ];\r\n        if (this._keys.length > 36) {\r\n            throw new Error('Too many keys in config minifier map');\r\n        }\r\n\r\n        this._values = [\r\n            true,\r\n            false,\r\n            'row',\r\n            'column',\r\n            'stack',\r\n            'component',\r\n            'close',\r\n            'maximise',\r\n            'minimise',\r\n            'open in new window'\r\n        ];\r\n    }\r\n\r\n\r\n    /**\r\n     * Takes a GoldenLayout configuration object and\r\n     * replaces its keys and values recursively with\r\n     * one letter counterparts\r\n     *\r\n     * @param   {Object} config A GoldenLayout config object\r\n     *\r\n     * @returns {Object} minified config\r\n     */\r\n    minifyConfig(config) {\r\n        var min = {};\r\n        this._nextLevel(config, min, '_min');\r\n        return min;\r\n    }\r\n\r\n    /**\r\n     * Takes a configuration Object that was previously minified\r\n     * using minifyConfig and returns its original version\r\n     *\r\n     * @param   {Object} minifiedConfig\r\n     *\r\n     * @returns {Object} the original configuration\r\n     */\r\n    unminifyConfig(minifiedConfig) {\r\n        var orig = {};\r\n        this._nextLevel(minifiedConfig, orig, '_max');\r\n        return orig;\r\n    }\r\n\r\n    /**\r\n     * Recursive function, called for every level of the config structure\r\n     *\r\n     * @param   {Array|Object} orig\r\n     * @param   {Array|Object} min\r\n     * @param    {String} translationFn\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _nextLevel(from, to, translationFn) {\r\n        var key, minKey;\r\n\r\n        for (key in from) {\r\n\r\n            /**\r\n             * For in returns array indices as keys, so let's cast them to numbers\r\n             */\r\n            if (from instanceof Array) key = parseInt(key, 10);\r\n\r\n            /**\r\n             * In case something has extended Object prototypes\r\n             */\r\n            if (!from.hasOwnProperty(key)) continue;\r\n\r\n            /**\r\n             * Translate the key to a one letter substitute\r\n             */\r\n            minKey = this[translationFn](key, this._keys);\r\n\r\n            /**\r\n             * For Arrays and Objects, create a new Array/Object\r\n             * on the minified object and recurse into it\r\n             */\r\n            if (typeof from[key] === 'object') {\r\n                to[minKey] = from[key] instanceof Array ? [] : {};\r\n                this._nextLevel(from[key], to[minKey], translationFn);\r\n\r\n                /**\r\n                 * For primitive values (Strings, Numbers, Boolean etc.)\r\n                 * minify the value\r\n                 */\r\n            } else {\r\n                to[minKey] = this[translationFn](from[key], this._values);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Minifies value based on a dictionary\r\n     *\r\n     * @param   {String|Boolean} value\r\n     * @param   {Array<String|Boolean>} dictionary\r\n     *\r\n     * @returns {String} The minified version\r\n     */\r\n    _min(value, dictionary) {\r\n        /**\r\n         * If a value actually is a single character, prefix it\r\n         * with ___ to avoid mistaking it for a minification code\r\n         */\r\n        if (typeof value === 'string' && value.length === 1) {\r\n            return '___' + value;\r\n        }\r\n\r\n        var index = indexOf(value, dictionary);\r\n\r\n        /**\r\n         * value not found in the dictionary, return it unmodified\r\n         */\r\n        if (index === -1) {\r\n            return value;\r\n\r\n            /**\r\n             * value found in dictionary, return its base36 counterpart\r\n             */\r\n        } else {\r\n            return index.toString(36);\r\n        }\r\n    }\r\n\r\n    _max(value, dictionary) {\r\n        /**\r\n         * value is a single character. Assume that it's a translation\r\n         * and return the original value from the dictionary\r\n         */\r\n        if (typeof value === 'string' && value.length === 1) {\r\n            return dictionary[parseInt(value, 36)];\r\n        }\r\n\r\n        /**\r\n         * value originally was a single character and was prefixed with ___\r\n         * to avoid mistaking it for a translation. Remove the prefix\r\n         * and return the original character\r\n         */\r\n        if (typeof value === 'string' && value.substr(0, 3) === '___') {\r\n            return value[3];\r\n        }\r\n        /**\r\n         * value was not minified\r\n         */\r\n        return value;\r\n    }\r\n}\r\n\r\n","import EventEmitter from '../utils/EventEmitter'\r\nimport { \r\n  ALL_EVENT\r\n} from '../utils/EventEmitter'\r\nimport {\r\n    fnBind\r\n} from '../utils/utils'\r\nimport $ from 'jquery'\r\n\r\n/**\r\n * An EventEmitter singleton that propagates events\r\n * across multiple windows. This is a little bit trickier since\r\n * windows are allowed to open childWindows in their own right\r\n *\r\n * This means that we deal with a tree of windows. Hence the rules for event propagation are:\r\n *\r\n * - Propagate events from this layout to both parents and children\r\n * - Propagate events from parent to this and children\r\n * - Propagate events from children to the other children (but not the emitting one) and the parent\r\n *\r\n * @constructor\r\n *\r\n * @param {lm.LayoutManager} layoutManager\r\n */\r\n\r\n\r\nexport default class EventHub extends EventEmitter {\r\n    constructor(layoutManager) {\r\n        \r\n        super();\r\n\r\n        this._layoutManager = layoutManager;\r\n        this._dontPropagateToParent = null;\r\n        this._childEventSource = null;\r\n        this.on(ALL_EVENT, fnBind(this._onEventFromThis, this));\r\n        this._boundOnEventFromChild = fnBind(this._onEventFromChild, this);\r\n        $(window).on('gl_child_event', this._boundOnEventFromChild);\r\n    }\r\n\r\n    /**\r\n     * Called on every event emitted on this eventHub, regardles of origin.\r\n     *\r\n     * @private\r\n     *\r\n     * @param {Mixed}\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _onEventFromThis() {\r\n        var args = Array.prototype.slice.call(arguments);\r\n\r\n        if (this._layoutManager.isSubWindow && args[0] !== this._dontPropagateToParent) {\r\n            this._propagateToParent(args);\r\n        }\r\n        this._propagateToChildren(args);\r\n\r\n        //Reset\r\n        this._dontPropagateToParent = null;\r\n        this._childEventSource = null;\r\n    }\r\n\r\n    /**\r\n     * Called by the parent layout.\r\n     *\r\n     * @param   {Array} args Event name + arguments\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _$onEventFromParent(args) {\r\n        this._dontPropagateToParent = args[0];\r\n        this.emit.apply(this, args);\r\n    }\r\n\r\n    /**\r\n     * Callback for child events raised on the window\r\n     *\r\n     * @param   {DOMEvent} event\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _onEventFromChild(event) {\r\n        this._childEventSource = event.originalEvent.__gl;\r\n        this.emit.apply(this, event.originalEvent.__glArgs);\r\n    }\r\n\r\n    /**\r\n     * Propagates the event to the parent by emitting\r\n     * it on the parent's DOM window\r\n     *\r\n     * @param   {Array} args Event name + arguments\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _propagateToParent(args) {\r\n        var event,\r\n            eventName = 'gl_child_event';\r\n\r\n        if (document.createEvent) {\r\n            event = window.opener.document.createEvent('HTMLEvents');\r\n            event.initEvent(eventName, true, true);\r\n        } else {\r\n            event = window.opener.document.createEventObject();\r\n            event.eventType = eventName;\r\n        }\r\n\r\n        event.eventName = eventName;\r\n        event.__glArgs = args;\r\n        event.__gl = this._layoutManager;\r\n\r\n        if (document.createEvent) {\r\n            window.opener.dispatchEvent(event);\r\n        } else {\r\n            window.opener.fireEvent('on' + event.eventType, event);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Propagate events to children\r\n     *\r\n     * @param   {Array} args Event name + arguments\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _propagateToChildren(args) {\r\n        var childGl, i;\r\n\r\n        for (i = 0; i < this._layoutManager.openPopouts.length; i++) {\r\n            childGl = this._layoutManager.openPopouts[i].getGlInstance();\r\n\r\n            if (childGl && childGl !== this._childEventSource) {\r\n                childGl.eventHub._$onEventFromParent(args);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Destroys the EventHub\r\n     *\r\n     * @public\r\n     * @returns {void}\r\n     */\r\n\r\n    destroy() {\r\n        $(window).off('gl_child_event', this._boundOnEventFromChild);\r\n    }\r\n}\r\n","\r\n\r\nexport default class BubblingEvent {\r\n    constructor(name, origin) {\r\n        this.name = name;\r\n        this.origin = origin;\r\n        this.isPropagationStopped = false;\r\n    }\r\n\r\n    stopPropagation() {\r\n        this.isPropagationStopped = true;\r\n    }\r\n}\r\n","\r\n\r\nexport default class ConfigurationError extends Error {\r\n    constructor(message, node) {\r\n        super();\r\n\r\n        this.name = 'Configuration Error';\r\n        this.message = message;\r\n        this.node = node;\r\n    }\r\n}\r\n","const itemDefaultConfig = {\r\n    isClosable: true,\r\n    reorderEnabled: true,\r\n    title: ''\r\n}\r\n\r\nexport default itemDefaultConfig\r\n","import EventEmitter from '../utils/EventEmitter'\r\nimport { \r\n  ALL_EVENT\r\n} from '../utils/EventEmitter'\r\n\r\nimport BubblingEvent from '../utils/BubblingEvent'\r\nimport Root from './Root'\r\nimport ConfigurationError from '../errors/ConfigurationError'\r\nimport itemDefaultConfig from '../config/ItemDefaultConfig'\r\n\r\nimport {\r\n    fnBind,\r\n    animFrame,\r\n    indexOf\r\n} from '../utils/utils'\r\n\r\n/**\r\n * This is the baseclass that all content items inherit from.\r\n * Most methods provide a subset of what the sub-classes do.\r\n *\r\n * It also provides a number of functions for tree traversal\r\n *\r\n * @param {lm.LayoutManager} layoutManager\r\n * @param {item node configuration} config\r\n * @param {lm.item} parent\r\n *\r\n * @event stateChanged\r\n * @event beforeItemDestroyed\r\n * @event itemDestroyed\r\n * @event itemCreated\r\n * @event componentCreated\r\n * @event rowCreated\r\n * @event columnCreated\r\n * @event stackCreated\r\n *\r\n * @constructor\r\n */\r\n\r\n\r\nexport default class AbstractContentItem extends EventEmitter {\r\n    constructor(layoutManager, config, parent) {\r\n\r\n        super();\r\n\r\n        this.config = this._extendItemNode(config);\r\n        this.type = config.type;\r\n        this.contentItems = [];\r\n        this.parent = parent;\r\n\r\n        this.isInitialised = false;\r\n        this.isMaximised = false;\r\n        this.isRoot = false;\r\n        this.isRow = false;\r\n        this.isColumn = false;\r\n        this.isStack = false;\r\n        this.isComponent = false;\r\n\r\n        this.layoutManager = layoutManager;\r\n        this._pendingEventPropagations = {};\r\n        this._throttledEvents = ['stateChanged'];\r\n\r\n        this.on(ALL_EVENT, this._propagateEvent, this);\r\n\r\n        if (config.content) {\r\n            this._createContentItems(config);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set the size of the component and its children, called recursively\r\n     *\r\n     * @abstract\r\n     * @returns void\r\n     */\r\n    setSize() {\r\n        throw new Error('Abstract Method');\r\n    }\r\n\r\n    /**\r\n     * Calls a method recursively downwards on the tree\r\n     *\r\n     * @param   {String} functionName      the name of the function to be called\r\n     * @param   {[Array]}functionArguments optional arguments that are passed to every function\r\n     * @param   {[bool]} bottomUp          Call methods from bottom to top, defaults to false\r\n     * @param   {[bool]} skipSelf          Don't invoke the method on the class that calls it, defaults to false\r\n     *\r\n     * @returns {void}\r\n     */\r\n    callDownwards(functionName, functionArguments, bottomUp, skipSelf) {\r\n        var i;\r\n\r\n        if (bottomUp !== true && skipSelf !== true) {\r\n            this[functionName].apply(this, functionArguments || []);\r\n        }\r\n        for (i = 0; i < this.contentItems.length; i++) {\r\n            this.contentItems[i].callDownwards(functionName, functionArguments, bottomUp);\r\n        }\r\n        if (bottomUp === true && skipSelf !== true) {\r\n            this[functionName].apply(this, functionArguments || []);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Removes a child node (and its children) from the tree\r\n     *\r\n     * @param   {ContentItem} contentItem\r\n     *\r\n     * @returns {void}\r\n     */\r\n    removeChild(contentItem, keepChild) {\r\n        /*\r\n         * Get the position of the item that's to be removed within all content items this node contains\r\n         */\r\n        var index = indexOf(contentItem, this.contentItems);\r\n\r\n        /*\r\n         * Make sure the content item to be removed is actually a child of this item\r\n         */\r\n        if (index === -1) {\r\n            throw new Error('Can\\'t remove child item. Unknown content item');\r\n        }\r\n\r\n        /**\r\n\t\t * Call ._$destroy on the content item. \r\n\t\t * Then use 'callDownwards' to destroy any children\r\n\t\t */\r\n        if (keepChild !== true) {\r\n\t\t\tthis.contentItems[index]._$destroy();\r\n\t\t\tthis.contentItems[index].callDownwards('_$destroy', [], true, true);\r\n        }\r\n\r\n        /**\r\n         * Remove the content item from this nodes array of children\r\n         */\r\n        this.contentItems.splice(index, 1);\r\n\r\n        /**\r\n         * Remove the item from the configuration\r\n         */\r\n        this.config.content.splice(index, 1);\r\n\r\n        /**\r\n         * If this node still contains other content items, adjust their size\r\n         */\r\n        if (this.contentItems.length > 0) {\r\n            this.callDownwards('setSize');\r\n\r\n            /**\r\n             * If this was the last content item, remove this node as well\r\n             */\r\n        } else if (!(this instanceof Root) && this.config.isClosable === true) {\r\n            this.parent.removeChild(this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Hides a child node (and its children) from the tree reclaiming its space in the layout\r\n     *\r\n     * @param   {ContentItem} contentItem\r\n     *\r\n     * @returns {void}\r\n     */\r\n    undisplayChild(contentItem) {\r\n        /*\r\n         * Get the position of the item that's to be removed within all content items this node contains\r\n         */\r\n        var index = indexOf(contentItem, this.contentItems);\r\n\r\n        /*\r\n         * Make sure the content item to be removed is actually a child of this item\r\n         */\r\n        if (index === -1) {\r\n            throw new Error('Can\\'t remove child item. Unknown content item');\r\n        }\r\n\r\n        if (!(this instanceof Root) && this.config.isClosable === true) {\r\n            this.parent.undisplayChild(this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sets up the tree structure for the newly added child\r\n     * The responsibility for the actual DOM manipulations lies\r\n     * with the concrete item\r\n     *\r\n     * @param {AbstractContentItem} contentItem\r\n     * @param {[Int]} index If omitted item will be appended\r\n     */\r\n    addChild(contentItem, index) {\r\n        if (index === undefined) {\r\n            index = this.contentItems.length;\r\n        }\r\n\r\n        this.contentItems.splice(index, 0, contentItem);\r\n\r\n        if (this.config.content === undefined) {\r\n            this.config.content = [];\r\n        }\r\n\r\n        this.config.content.splice(index, 0, contentItem.config);\r\n        contentItem.parent = this;\r\n\r\n        if (contentItem.parent.isInitialised === true && contentItem.isInitialised === false) {\r\n            contentItem._$init();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Replaces oldChild with newChild. This used to use jQuery.replaceWith... which for\r\n     * some reason removes all event listeners, so isn't really an option.\r\n     *\r\n     * @param   {AbstractContentItem} oldChild\r\n     * @param   {AbstractContentItem} newChild\r\n     *\r\n     * @returns {void}\r\n     */\r\n    replaceChild(oldChild, newChild, _$destroyOldChild) {\r\n\r\n        newChild = this.layoutManager._$normalizeContentItem(newChild);\r\n\r\n        var index = indexOf(oldChild, this.contentItems),\r\n            parentNode = oldChild.element[0].parentNode;\r\n\r\n        if (index === -1) {\r\n            throw new Error('Can\\'t replace child. oldChild is not child of this');\r\n        }\r\n\r\n        parentNode.replaceChild(newChild.element[0], oldChild.element[0]);\r\n\r\n        /*\r\n         * Optionally destroy the old content item\r\n         */\r\n        if (_$destroyOldChild === true) {\r\n            oldChild.parent = null;\r\n            oldChild._$destroy();\r\n        }\r\n\r\n        /*\r\n         * Wire the new contentItem into the tree\r\n         */\r\n        this.contentItems[index] = newChild;\r\n        newChild.parent = this;\r\n\r\n        /*\r\n         * Update tab reference\r\n         */\r\n        if (this.isStack) {\r\n            this.header.tabs[index].contentItem = newChild;\r\n        }\r\n\r\n        //TODO This doesn't update the config... refactor to leave item nodes untouched after creation\r\n        if (newChild.parent.isInitialised === true && newChild.isInitialised === false) {\r\n            newChild._$init();\r\n        }\r\n\r\n        this.callDownwards('setSize');\r\n    }\r\n\r\n    /**\r\n     * Convenience method.\r\n     * Shorthand for this.parent.removeChild( this )\r\n     *\r\n     * @returns {void}\r\n     */\r\n    remove() {\r\n        this.parent.removeChild(this);\r\n    }\r\n\r\n    /**\r\n     * Removes the component from the layout and creates a new\r\n     * browser window with the component and its children inside\r\n     *\r\n     * @returns {BrowserPopout}\r\n     */\r\n    popout() {\r\n        var browserPopout = this.layoutManager.createPopout(this);\r\n        this.emitBubblingEvent('stateChanged');\r\n        return browserPopout;\r\n    }\r\n\r\n    /**\r\n     * Maximises the Item or minimises it if it is already maximised\r\n     *\r\n     * @returns {void}\r\n     */\r\n    toggleMaximise(e) {\r\n        e && e.preventDefault();\r\n        if (this.isMaximised === true) {\r\n            this.layoutManager._$minimiseItem(this);\r\n        } else {\r\n            this.layoutManager._$maximiseItem(this);\r\n        }\r\n\r\n        this.isMaximised = !this.isMaximised;\r\n        this.emitBubblingEvent('stateChanged');\r\n    }\r\n\r\n    /**\r\n     * Selects the item if it is not already selected\r\n     *\r\n     * @returns {void}\r\n     */\r\n    select() {\r\n        if (this.layoutManager.selectedItem !== this) {\r\n            this.layoutManager.selectItem(this, true);\r\n            this.element.addClass('lm_selected');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * De-selects the item if it is selected\r\n     *\r\n     * @returns {void}\r\n     */\r\n    deselect() {\r\n        if (this.layoutManager.selectedItem === this) {\r\n            this.layoutManager.selectedItem = null;\r\n            this.element.removeClass('lm_selected');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Set this component's title\r\n     *\r\n     * @public\r\n     * @param {String} title\r\n     *\r\n     * @returns {void}\r\n     */\r\n    setTitle(title) {\r\n        this.config.title = title;\r\n        this.emit('titleChanged', title);\r\n        this.emit('stateChanged');\r\n    }\r\n\r\n    /**\r\n     * Checks whether a provided id is present\r\n     *\r\n     * @public\r\n     * @param   {String}  id\r\n     *\r\n     * @returns {Boolean} isPresent\r\n     */\r\n    hasId(id) {\r\n        if (!this.config.id) {\r\n            return false;\r\n        } else if (typeof this.config.id === 'string') {\r\n            return this.config.id === id;\r\n        } else if (this.config.id instanceof Array) {\r\n            return indexOf(id, this.config.id) !== -1;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adds an id. Adds it as a string if the component doesn't\r\n     * have an id yet or creates/uses an array\r\n     *\r\n     * @public\r\n     * @param {String} id\r\n     *\r\n     * @returns {void}\r\n     */\r\n    addId(id) {\r\n        if (this.hasId(id)) {\r\n            return;\r\n        }\r\n\r\n        if (!this.config.id) {\r\n            this.config.id = id;\r\n        } else if (typeof this.config.id === 'string') {\r\n            this.config.id = [this.config.id, id];\r\n        } else if (this.config.id instanceof Array) {\r\n            this.config.id.push(id);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Removes an existing id. Throws an error\r\n     * if the id is not present\r\n     *\r\n     * @public\r\n     * @param   {String} id\r\n     *\r\n     * @returns {void}\r\n     */\r\n    removeId(id) {\r\n        if (!this.hasId(id)) {\r\n            throw new Error('Id not found');\r\n        }\r\n\r\n        if (typeof this.config.id === 'string') {\r\n            delete this.config.id;\r\n        } else if (this.config.id instanceof Array) {\r\n            var index = indexOf(id, this.config.id);\r\n            this.config.id.splice(index, 1);\r\n        }\r\n    }\r\n\r\n    /****************************************\r\n     * SELECTOR\r\n     ****************************************/\r\n    getItemsByFilter(filter) {\r\n        var result = [],\r\n            next = function(contentItem) {\r\n                for (var i = 0; i < contentItem.contentItems.length; i++) {\r\n\r\n                    if (filter(contentItem.contentItems[i]) === true) {\r\n                        result.push(contentItem.contentItems[i]);\r\n                    }\r\n\r\n                    next(contentItem.contentItems[i]);\r\n                }\r\n            };\r\n\r\n        next(this);\r\n        return result;\r\n    }\r\n\r\n    getItemsById(id) {\r\n        return this.getItemsByFilter(function(item) {\r\n            if (item.config.id instanceof Array) {\r\n                return indexOf(id, item.config.id) !== -1;\r\n            } else {\r\n                return item.config.id === id;\r\n            }\r\n        });\r\n    }\r\n\r\n    getItemsByType(type) {\r\n        return this._$getItemsByProperty('type', type);\r\n    }\r\n\r\n    getComponentsByName(componentName) {\r\n        var components = this._$getItemsByProperty('componentName', componentName),\r\n            instances = [],\r\n            i;\r\n\r\n        for (i = 0; i < components.length; i++) {\r\n            instances.push(components[i].instance);\r\n        }\r\n\r\n        return instances;\r\n    }\r\n\r\n    /****************************************\r\n     * PACKAGE PRIVATE\r\n     ****************************************/\r\n    _$getItemsByProperty(key, value) {\r\n        return this.getItemsByFilter(function(item) {\r\n            return item[key] === value;\r\n        });\r\n    }\r\n\r\n    _$setParent(parent) {\r\n        this.parent = parent;\r\n    }\r\n\r\n    _$highlightDropZone(x, y, area) {\r\n        this.layoutManager.dropTargetIndicator.highlightArea(area);\r\n    }\r\n\r\n    _$onDrop(contentItem) {\r\n        this.addChild(contentItem);\r\n    }\r\n\r\n    _$hide() {\r\n        this._callOnActiveComponents('hide');\r\n        this.element.hide();\r\n        this.layoutManager.updateSize();\r\n    }\r\n\r\n    _$show() {\r\n        this._callOnActiveComponents('show');\r\n        this.element.show();\r\n        this.layoutManager.updateSize();\r\n    }\r\n\r\n    _callOnActiveComponents(methodName) {\r\n        var stacks = this.getItemsByType('stack'),\r\n            activeContentItem,\r\n            i;\r\n\r\n        for (i = 0; i < stacks.length; i++) {\r\n            activeContentItem = stacks[i].getActiveContentItem();\r\n\r\n            if (activeContentItem && activeContentItem.isComponent) {\r\n                activeContentItem.container[methodName]();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Destroys this item ands its children\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _$destroy() {\r\n        this.emitBubblingEvent('beforeItemDestroyed');\r\n        this.element.remove();\r\n        this.emitBubblingEvent('itemDestroyed');\r\n    }\r\n\r\n    /**\r\n     * Returns the area the component currently occupies in the format\r\n     *\r\n     * {\r\n     *\t\tx1: int\r\n     *\t\txy: int\r\n     *\t\ty1: int\r\n     *\t\ty2: int\r\n     *\t\tcontentItem: contentItem\r\n     * }\r\n     */\r\n    _$getArea(element) {\r\n        element = element || this.element;\r\n\r\n        var offset = element.offset(),\r\n            width = element.width(),\r\n            height = element.height();\r\n\r\n        return {\r\n            x1: offset.left,\r\n            y1: offset.top,\r\n            x2: offset.left + width,\r\n            y2: offset.top + height,\r\n            surface: width * height,\r\n            contentItem: this\r\n        };\r\n    }\r\n\r\n    /**\r\n     * The tree of content items is created in two steps: First all content items are instantiated,\r\n     * then init is called recursively from top to bottem. This is the basic init function,\r\n     * it can be used, extended or overwritten by the content items\r\n     *\r\n     * Its behaviour depends on the content item\r\n     *\r\n     * @package private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _$init() {\r\n        var i;\r\n        this.setSize();\r\n\r\n        for (i = 0; i < this.contentItems.length; i++) {\r\n            this.childElementContainer.append(this.contentItems[i].element);\r\n        }\r\n\r\n        this.isInitialised = true;\r\n        this.emitBubblingEvent('itemCreated');\r\n        this.emitBubblingEvent(this.type + 'Created');\r\n    }\r\n\r\n    /**\r\n     * Emit an event that bubbles up the item tree.\r\n     *\r\n     * @param   {String} name The name of the event\r\n     *\r\n     * @returns {void}\r\n     */\r\n    emitBubblingEvent(name) {\r\n        var event = new BubblingEvent(name, this);\r\n        this.emit(name, event);\r\n    }\r\n\r\n    /**\r\n     * Private method, creates all content items for this node at initialisation time\r\n     * PLEASE NOTE, please see addChild for adding contentItems add runtime\r\n     * @private\r\n     * @param   {configuration item node} config\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _createContentItems(config) {\r\n        var oContentItem, i;\r\n\r\n        if (!(config.content instanceof Array)) {\r\n            throw new ConfigurationError('content must be an Array', config);\r\n        }\r\n\r\n        for (i = 0; i < config.content.length; i++) {\r\n            oContentItem = this.layoutManager.createContentItem(config.content[i], this);\r\n            this.contentItems.push(oContentItem);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Extends an item configuration node with default settings\r\n     * @private\r\n     * @param   {configuration item node} config\r\n     *\r\n     * @returns {configuration item node} extended config\r\n     */\r\n    _extendItemNode(config) {\r\n\r\n        for (var key in itemDefaultConfig) {\r\n            if (config[key] === undefined) {\r\n                config[key] = itemDefaultConfig[key];\r\n            }\r\n        }\r\n\r\n        return config;\r\n    }\r\n\r\n    /**\r\n     * Called for every event on the item tree. Decides whether the event is a bubbling\r\n     * event and propagates it to its parent\r\n     *\r\n     * @param    {String} name the name of the event\r\n     * @param   {BubblingEvent} event\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _propagateEvent(name, event) {\r\n        if (event instanceof BubblingEvent &&\r\n            event.isPropagationStopped === false &&\r\n            this.isInitialised === true) {\r\n\r\n            /**\r\n             * In some cases (e.g. if an element is created from a DragSource) it\r\n             * doesn't have a parent and is not below root. If that's the case\r\n             * propagate the bubbling event from the top level of the substree directly\r\n             * to the layoutManager\r\n             */\r\n            if (this.isRoot === false && this.parent) {\r\n                this.parent.emit.apply(this.parent, Array.prototype.slice.call(arguments, 0));\r\n            } else {\r\n                this._scheduleEventPropagationToLayoutManager(name, event);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * All raw events bubble up to the root element. Some events that\r\n     * are propagated to - and emitted by - the layoutManager however are\r\n     * only string-based, batched and sanitized to make them more usable\r\n     *\r\n     * @param {String} name the name of the event\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _scheduleEventPropagationToLayoutManager(name, event) {\r\n        if (indexOf(name, this._throttledEvents) === -1) {\r\n            this.layoutManager.emit(name, event.origin);\r\n        } else {\r\n            if (this._pendingEventPropagations[name] !== true) {\r\n                this._pendingEventPropagations[name] = true;\r\n                animFrame(fnBind(this._propagateEventToLayoutManager, this, [name, event]));\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    /**\r\n     * Callback for events scheduled by _scheduleEventPropagationToLayoutManager\r\n     *\r\n     * @param {String} name the name of the event\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _propagateEventToLayoutManager(name, event) {\r\n        this._pendingEventPropagations[name] = false;\r\n        this.layoutManager.emit(name, event);\r\n    }\r\n}\r\n","import EventEmitter from '../utils/EventEmitter'\r\nimport {\r\n    fnBind, \r\n    getTouchEvent\r\n} from '../utils/utils'\r\nimport $ from 'jquery'\r\n\r\nexport default class DragListener extends EventEmitter {\r\n    constructor(eElement, nButtonCode) {\r\n\r\n        super();\r\n\r\n        this._timeout = null\r\n\r\n\r\n        this._eElement = $(eElement);\r\n        this._oDocument = $(document);\r\n        this._eBody = $(document.body);\r\n        this._nButtonCode = nButtonCode || 0;\r\n\r\n        /**\r\n         * The delay after which to start the drag in milliseconds\r\n         */\r\n        this._nDelay = 200;\r\n\r\n        /**\r\n         * The distance the mouse needs to be moved to qualify as a drag\r\n         */\r\n        this._nDistance = 10; //TODO - works better with delay only\r\n\r\n        this._nX = 0;\r\n        this._nY = 0;\r\n\r\n        this._nOriginalX = 0;\r\n        this._nOriginalY = 0;\r\n\r\n        this._bDragging = false;\r\n\r\n        this._fMove = fnBind(this.onMouseMove, this);\r\n        this._fUp = fnBind(this.onMouseUp, this);\r\n        this._fDown = fnBind(this.onMouseDown, this);\r\n\r\n\r\n        this._eElement.on('mousedown touchstart', this._fDown);\r\n    }\r\n\r\n    destroy() {\r\n        this._eElement.unbind('mousedown touchstart', this._fDown);\r\n        this._oDocument.unbind('mouseup touchend', this._fUp);\r\n        this._eElement = null;\r\n        this._oDocument = null;\r\n        this._eBody = null;\r\n    }\r\n\r\n    onMouseDown(oEvent) {\r\n        oEvent.preventDefault();\r\n\r\n        if (oEvent.button == 0 || oEvent.type === \"touchstart\") {\r\n            var coordinates = this._getCoordinates(oEvent);\r\n\r\n            this._nOriginalX = coordinates.x;\r\n            this._nOriginalY = coordinates.y;\r\n\r\n            this._oDocument.on('mousemove touchmove', this._fMove);\r\n            this._oDocument.one('mouseup touchend', this._fUp);\r\n\r\n            this._timeout = setTimeout(fnBind(this._startDrag, this), this._nDelay);\r\n        }\r\n    }\r\n\r\n    onMouseMove(oEvent) {\r\n        if (this._timeout != null) {\r\n            oEvent.preventDefault();\r\n\r\n            var coordinates = this._getCoordinates(oEvent);\r\n\r\n            this._nX = coordinates.x - this._nOriginalX;\r\n            this._nY = coordinates.y - this._nOriginalY;\r\n\r\n            if (this._bDragging === false) {\r\n                if (\r\n                    Math.abs(this._nX) > this._nDistance ||\r\n                    Math.abs(this._nY) > this._nDistance\r\n                ) {\r\n                    clearTimeout(this._timeout);\r\n                    this._startDrag();\r\n                }\r\n            }\r\n\r\n            if (this._bDragging) {\r\n                this.emit('drag', this._nX, this._nY, oEvent);\r\n            }\r\n        }\r\n    }\r\n\r\n    onMouseUp(oEvent) {\r\n        if (this._timeout != null) {\r\n            clearTimeout(this._timeout);\r\n            this._eBody.removeClass('lm_dragging');\r\n            this._eElement.removeClass('lm_dragging');\r\n            this._oDocument.find('iframe').css('pointer-events', '');\r\n            this._oDocument.unbind('mousemove touchmove', this._fMove);\r\n            this._oDocument.unbind('mouseup touchend', this._fUp);\r\n\r\n            if (this._bDragging === true) {\r\n                this._bDragging = false;\r\n                this.emit('dragStop', oEvent, this._nOriginalX + this._nX);\r\n            }\r\n        }\r\n    }\r\n\r\n    _startDrag() {\r\n        this._bDragging = true;\r\n        this._eBody.addClass('lm_dragging');\r\n        this._eElement.addClass('lm_dragging');\r\n        this._oDocument.find('iframe').css('pointer-events', 'none');\r\n        this.emit('dragStart', this._nOriginalX, this._nOriginalY);\r\n    }\r\n\r\n    _getCoordinates(event) {\r\n        event = getTouchEvent(event)\r\n        return {\r\n            x: event.pageX,\r\n            y: event.pageY\r\n        };\r\n    }\r\n}\r\n","import EventEmitter from '../utils/EventEmitter'\r\nimport {\r\n    stripTags,\r\n    getTouchEvent\r\n} from '../utils/utils';\r\nimport $ from 'jquery';\r\n\r\nconst _template = '<div class=\"lm_dragProxy\">' +\r\n    '<div class=\"lm_header\">' +\r\n    '<ul class=\"lm_tabs\">' +\r\n    '<li class=\"lm_tab lm_active\"><i class=\"lm_left\"></i>' +\r\n    '<span class=\"lm_title\"></span>' +\r\n    '<i class=\"lm_right\"></i></li>' +\r\n    '</ul>' +\r\n    '</div>' +\r\n    '<div class=\"lm_content\"></div>' +\r\n    '</div>';\r\n\r\n/**\r\n * This class creates a temporary container\r\n * for the component whilst it is being dragged\r\n * and handles drag events\r\n *\r\n * @constructor\r\n * @private\r\n *\r\n * @param {Number} x              The initial x position\r\n * @param {Number} y              The initial y position\r\n * @param {DragListener} dragListener\r\n * @param {lm.LayoutManager} layoutManager\r\n * @param {AbstractContentItem} contentItem\r\n * @param {AbstractContentItem} originalParent\r\n */\r\nexport default class DragProxy extends EventEmitter {\r\n\r\n    constructor(x, y, dragListener, layoutManager, contentItem, originalParent) {\r\n\r\n        super();\r\n\r\n        this._dragListener = dragListener;\r\n        this._layoutManager = layoutManager;\r\n        this._contentItem = contentItem;\r\n        this._originalParent = originalParent;\r\n\r\n        this._area = null;\r\n        this._lastValidArea = null;\r\n\r\n        this._dragListener.on('drag', this._onDrag, this);\r\n        this._dragListener.on('dragStop', this._onDrop, this);\r\n\r\n        this.element = $(_template);\r\n        if (originalParent && originalParent._side) {\r\n            this._sided = originalParent._sided;\r\n            this.element.addClass('lm_' + originalParent._side);\r\n            if (['right', 'bottom'].indexOf(originalParent._side) >= 0)\r\n                this.element.find('.lm_content').after(this.element.find('.lm_header'));\r\n        }\r\n        this.element.css({\r\n            left: x,\r\n            top: y\r\n        });\r\n        this.element.find('.lm_tab').attr('title', stripTags(this._contentItem.config.title));\r\n        this.element.find('.lm_title').html(this._contentItem.config.title);\r\n        this.childElementContainer = this.element.find('.lm_content');\r\n        this.childElementContainer.append(contentItem.element);\r\n\r\n        this._undisplayTree();\r\n        this._layoutManager._$calculateItemAreas();\r\n        this._setDimensions();\r\n\r\n        $(document.body).append(this.element);\r\n\r\n        var offset = this._layoutManager.container.offset();\r\n\r\n        this._minX = offset.left;\r\n        this._minY = offset.top;\r\n        this._maxX = this._layoutManager.container.width() + this._minX;\r\n        this._maxY = this._layoutManager.container.height() + this._minY;\r\n        this._width = this.element.width();\r\n        this._height = this.element.height();\r\n\r\n        this._setDropPosition(x, y);\r\n    }\r\n\r\n    /**\r\n     * Callback on every mouseMove event during a drag. Determines if the drag is\r\n     * still within the valid drag area and calls the layoutManager to highlight the\r\n     * current drop area\r\n     *\r\n     * @param   {Number} offsetX The difference from the original x position in px\r\n     * @param   {Number} offsetY The difference from the original y position in px\r\n     * @param   {jQuery DOM event} event\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _onDrag(offsetX, offsetY, event) {\r\n        event = getTouchEvent(event)\r\n\r\n        var x = event.pageX,\r\n            y = event.pageY,\r\n            isWithinContainer = x > this._minX && x < this._maxX && y > this._minY && y < this._maxY;\r\n\r\n        if (!isWithinContainer && this._layoutManager.config.settings.constrainDragToContainer === true) {\r\n            return;\r\n        }\r\n\r\n        this._setDropPosition(x, y);\r\n    }\r\n\r\n    /**\r\n     * Sets the target position, highlighting the appropriate area\r\n     *\r\n     * @param   {Number} x The x position in px\r\n     * @param   {Number} y The y position in px\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _setDropPosition(x, y) {\r\n        this.element.css({\r\n            left: x,\r\n            top: y\r\n        });\r\n        this._area = this._layoutManager._$getArea(x, y);\r\n\r\n        if (this._area !== null) {\r\n            this._lastValidArea = this._area;\r\n            this._area.contentItem._$highlightDropZone(x, y, this._area);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Callback when the drag has finished. Determines the drop area\r\n     * and adds the child to it\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _onDrop() {\r\n        this._updateTree()\r\n        this._layoutManager.dropTargetIndicator.hide();\r\n\r\n        /*\r\n         * Valid drop area found\r\n         */\r\n        if (this._area !== null) {\r\n            this._area.contentItem._$onDrop(this._contentItem, this._area);\r\n\r\n            /**\r\n             * No valid drop area available at present, but one has been found before.\r\n             * Use it\r\n             */\r\n        } else if (this._lastValidArea !== null) {\r\n            this._lastValidArea.contentItem._$onDrop(this._contentItem, this._lastValidArea);\r\n\r\n            /**\r\n             * No valid drop area found during the duration of the drag. Return\r\n             * content item to its original position if a original parent is provided.\r\n             * (Which is not the case if the drag had been initiated by createDragSource)\r\n             */\r\n        } else if (this._originalParent) {\r\n            this._originalParent.addChild(this._contentItem);\r\n\r\n            /**\r\n             * The drag didn't ultimately end up with adding the content item to\r\n             * any container. In order to ensure clean up happens, destroy the\r\n             * content item.\r\n             */\r\n        } else {\r\n            this._contentItem._$destroy();\r\n        }\r\n\r\n        this.element.remove();\r\n\r\n        this._layoutManager.emit('itemDropped', this._contentItem);\r\n    }\r\n\r\n    /**\r\n     * Undisplays the item from its original position within the tree\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _undisplayTree() {\r\n\r\n        /**\r\n         * parent is null if the drag had been initiated by a external drag source\r\n         */\r\n        if (this._contentItem.parent) {\r\n            this._contentItem.parent.undisplayChild(this._contentItem);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Removes the item from its original position within the tree\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _updateTree() {\r\n\r\n        /**\r\n         * parent is null if the drag had been initiated by a external drag source\r\n         */\r\n        if (this._contentItem.parent) {\r\n            this._contentItem.parent.removeChild(this._contentItem, true);\r\n        }\r\n\r\n        this._contentItem._$setParent(this);\r\n    }\r\n\r\n    /**\r\n     * Updates the Drag Proxie's dimensions\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _setDimensions() {\r\n        var dimensions = this._layoutManager.config.dimensions,\r\n            width = dimensions.dragProxyWidth,\r\n            height = dimensions.dragProxyHeight;\r\n\r\n        this.element.width(width);\r\n        this.element.height(height);\r\n        width -= (this._sided ? dimensions.headerHeight : 0);\r\n        height -= (!this._sided ? dimensions.headerHeight : 0);\r\n        this.childElementContainer.width(width);\r\n        this.childElementContainer.height(height);\r\n        this._contentItem.element.width(width);\r\n        this._contentItem.element.height(height);\r\n        this._contentItem.callDownwards('_$show');\r\n        this._contentItem.callDownwards('setSize');\r\n    }\r\n}\r\n","import DragListener from '../utils/DragListener'\r\nimport DragProxy from '../controls/DragProxy'\r\nimport {\r\n    fnBind,\r\n    stripTags\r\n} from '../utils/utils'\r\nimport $ from 'jquery'\r\n\r\n/**\r\n * Represents an individual tab within a Stack's header\r\n *\r\n * @param {Header} header\r\n * @param {AbstractContentItem} contentItem\r\n *\r\n * @constructor\r\n */\r\n\r\nconst _template = '<li class=\"lm_tab\"><i class=\"lm_left\"></i>' +\r\n        '<span class=\"lm_title\"></span><div class=\"lm_close_tab\"></div>' +\r\n        '<i class=\"lm_right\"></i></li>'\r\n\r\nexport default class Tab {\r\n\r\n    constructor(header, contentItem) {\r\n        this.header = header;\r\n        this.contentItem = contentItem;\r\n        this.element = $(_template);\r\n        this.titleElement = this.element.find('.lm_title');\r\n        this.closeElement = this.element.find('.lm_close_tab');\r\n        this.closeElement[contentItem.config.isClosable ? 'show' : 'hide']();\r\n        this.isActive = false;\r\n\r\n        this.setTitle(contentItem.config.title);\r\n        this.contentItem.on('titleChanged', this.setTitle, this);\r\n\r\n        this._layoutManager = this.contentItem.layoutManager;\r\n\r\n        if (\r\n            this._layoutManager.config.settings.reorderEnabled === true &&\r\n            contentItem.config.reorderEnabled === true\r\n        ) {\r\n            this._dragListener = new DragListener(this.element);\r\n            this._dragListener.on('dragStart', this._onDragStart, this);\r\n            this.contentItem.on('destroy', this._dragListener.destroy, this._dragListener);\r\n        }\r\n\r\n        this._onTabClickFn = fnBind(this._onTabClick, this);\r\n        this._onCloseClickFn = fnBind(this._onCloseClick, this);\r\n\r\n        this.element.on('mousedown touchstart', this._onTabClickFn);\r\n\r\n        if (this.contentItem.config.isClosable) {\r\n            this.closeElement.on('click touchstart', this._onCloseClickFn);\r\n            this.closeElement.on('mousedown', this._onCloseMousedown);\r\n        } else {\r\n            this.closeElement.remove();\r\n        }\r\n\r\n        this.contentItem.tab = this;\r\n        this.contentItem.emit('tab', this);\r\n        this.contentItem.layoutManager.emit('tabCreated', this);\r\n\r\n        if (this.contentItem.isComponent) {\r\n            this.contentItem.container.tab = this;\r\n            this.contentItem.container.emit('tab', this);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Sets the tab's title to the provided string and sets\r\n     * its title attribute to a pure text representation (without\r\n     * html tags) of the same string.\r\n     *\r\n     * @public\r\n     * @param {String} title can contain html\r\n     */\r\n    setTitle(title) {\r\n        this.element.attr('title', stripTags(title));\r\n        this.titleElement.html(title);\r\n    }\r\n\r\n    /**\r\n     * Sets this tab's active state. To programmatically\r\n     * switch tabs, use header.setActiveContentItem( item ) instead.\r\n     *\r\n     * @public\r\n     * @param {Boolean} isActive\r\n     */\r\n    setActive(isActive) {\r\n        if (isActive === this.isActive) {\r\n            return;\r\n        }\r\n        this.isActive = isActive;\r\n\r\n        if (isActive) {\r\n            this.element.addClass('lm_active');\r\n        } else {\r\n            this.element.removeClass('lm_active');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Destroys the tab\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _$destroy() {\r\n        this.element.off('mousedown touchstart', this._onTabClickFn);\r\n        this.closeElement.off('click touchstart', this._onCloseClickFn);\r\n        if (this._dragListener) {\r\n            this.contentItem.off('destroy', this._dragListener.destroy, this._dragListener);\r\n            this._dragListener.off('dragStart', this._onDragStart);\r\n            this._dragListener = null;\r\n        }\r\n        this.element.remove();\r\n    }\r\n\r\n    /**\r\n     * Callback for the DragListener\r\n     *\r\n     * @param   {Number} x The tabs absolute x position\r\n     * @param   {Number} y The tabs absolute y position\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _onDragStart(x, y) {\r\n        if (!this.header._canDestroy)\r\n            return null;\r\n        if (this.contentItem.parent.isMaximised === true) {\r\n            this.contentItem.parent.toggleMaximise();\r\n        }\r\n        new DragProxy(\r\n            x,\r\n            y,\r\n            this._dragListener,\r\n            this._layoutManager,\r\n            this.contentItem,\r\n            this.header.parent\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Callback when the tab is clicked\r\n     *\r\n     * @param {jQuery DOM event} event\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _onTabClick(event) {\r\n        // left mouse button or tap\r\n        if (event.button === 0 || event.type === 'touchstart') {\r\n            this.header.parent.setActiveContentItem( this.contentItem );\r\n\r\n            // middle mouse button\r\n        } else if (event.button === 1 && this.contentItem.config.isClosable) {\r\n            this._onCloseClick(event);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Callback when the tab's close button is\r\n     * clicked\r\n     *\r\n     * @param   {jQuery DOM event} event\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _onCloseClick(event) {\r\n        event.stopPropagation();\r\n        if (!this.header._canDestroy)\r\n            return;\r\n        this.header.parent.removeChild(this.contentItem);\r\n    }\r\n\r\n    /**\r\n     * Callback to capture tab close button mousedown\r\n     * to prevent tab from activating.\r\n     *\r\n     * @param (jQuery DOM event) event\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _onCloseMousedown(event) {\r\n        event.stopPropagation();\r\n    }\r\n}\r\n","import $ from 'jquery';\r\n\r\nexport default class HeaderButton {\r\n    constructor(header, label, cssClass, action) {\r\n        this._header = header;\r\n        this.element = $('<li class=\"' + cssClass + '\" title=\"' + label + '\"></li>');\r\n        this._header.on('destroy', this._$destroy, this);\r\n        this._action = action;\r\n        this.element.on('click touchstart', this._action);\r\n        this._header.controlsContainer.append(this.element);\r\n    }\r\n\r\n    _$destroy() {\r\n        this.element.off();\r\n        this.element.remove();\r\n    }\r\n}\r\n","import EventEmitter from '../utils/EventEmitter'\r\nimport Tab from '../controls/Tab'\r\nimport HeaderButton from '../controls/HeaderButton'\r\nimport {\r\n    fnBind\r\n} from '../utils/utils';\r\nimport $ from 'jquery';\r\n\r\nconst _template = [\r\n        '<div class=\"lm_header\">',\r\n        '<ul class=\"lm_tabs\"></ul>',\r\n        '<ul class=\"lm_controls\"></ul>',\r\n        '<ul class=\"lm_tabdropdown_list\"></ul>',\r\n        '</div>'\r\n    ].join('');\r\n\r\n/**\r\n * This class represents a header above a Stack ContentItem.\r\n *\r\n * @param {lm.LayoutManager} layoutManager\r\n * @param {AbstractContentItem} parent\r\n */\r\nexport default class Header extends EventEmitter {\r\n\r\n    constructor(layoutManager, parent) {\r\n\r\n        super();\r\n        \r\n        this.layoutManager = layoutManager;\r\n        this.element = $(_template);\r\n\r\n        if (this.layoutManager.config.settings.selectionEnabled === true) {\r\n            this.element.addClass('lm_selectable');\r\n            this.element.on('click touchstart', fnBind(this._onHeaderClick, this));\r\n        }\r\n\r\n        this.tabsContainer = this.element.find('.lm_tabs');\r\n        this.tabDropdownContainer = this.element.find('.lm_tabdropdown_list');\r\n        this.tabDropdownContainer.hide();\r\n        this.controlsContainer = this.element.find('.lm_controls');\r\n        this.parent = parent;\r\n        this.parent.on('resize', this._updateTabSizes, this);\r\n        this.tabs = [];\r\n        this.tabsMarkedForRemoval = [];\r\n        this.activeContentItem = null;\r\n        this.closeButton = null;\r\n        this.dockButton = null;\r\n        this.tabDropdownButton = null;\r\n        this.hideAdditionalTabsDropdown = fnBind(this._hideAdditionalTabsDropdown, this);\r\n        $(document).mouseup(this.hideAdditionalTabsDropdown);\r\n\r\n        this._lastVisibleTabIndex = -1;\r\n        this._tabControlOffset = this.layoutManager.config.settings.tabControlOffset;\r\n        this._createControls();\r\n    }\r\n\r\n    /**\r\n     * Creates a new tab and associates it with a contentItem\r\n     *\r\n     * @param    {AbstractContentItem} contentItem\r\n     * @param    {Integer} index The position of the tab\r\n     *\r\n     * @returns {void}\r\n     */\r\n    createTab(contentItem, index) {\r\n        var tab, i;\r\n\r\n        //If there's already a tab relating to the\r\n        //content item, don't do anything\r\n        for (i = 0; i < this.tabs.length; i++) {\r\n            if (this.tabs[i].contentItem === contentItem) {\r\n                return;\r\n            }\r\n        }\r\n\r\n        tab = new Tab(this, contentItem);\r\n\r\n        if (this.tabs.length === 0) {\r\n            this.tabs.push(tab);\r\n            this.tabsContainer.append(tab.element);\r\n            return;\r\n        }\r\n\r\n        if (index === undefined) {\r\n            index = this.tabs.length;\r\n        }\r\n\r\n        if (index > 0) {\r\n            this.tabs[index - 1].element.after(tab.element);\r\n        } else {\r\n            this.tabs[0].element.before(tab.element);\r\n        }\r\n\r\n        this.tabs.splice(index, 0, tab);\r\n        this._updateTabSizes();\r\n    }\r\n\r\n    /**\r\n     * Finds a tab based on the contentItem its associated with and removes it.\r\n     *\r\n     * @param    {AbstractContentItem} contentItem\r\n     *\r\n     * @returns {void}\r\n     */\r\n    removeTab(contentItem) {\r\n        for (var i = 0; i < this.tabs.length; i++) {\r\n            if (this.tabs[i].contentItem === contentItem) {\r\n                this.tabs[i]._$destroy();\r\n                this.tabs.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n\r\n        for (i = 0; i < this.tabsMarkedForRemoval.length; i++) {\r\n            if (this.tabsMarkedForRemoval[i].contentItem === contentItem) {\r\n                this.tabsMarkedForRemoval[i]._$destroy();\r\n                this.tabsMarkedForRemoval.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n\r\n\r\n        throw new Error('contentItem is not controlled by this header');\r\n    }\r\n\r\n    /**\r\n     * Finds a tab based on the contentItem its associated with and marks it\r\n     * for removal, hiding it too.\r\n     *\r\n     * @param    {AbstractContentItem} contentItem\r\n     *\r\n     * @returns {void}\r\n     */\r\n    hideTab(contentItem){\r\n        for (var i = 0; i < this.tabs.length; i++) {\r\n            if (this.tabs[i].contentItem === contentItem) {\r\n                this.tabs[i].element.hide()\r\n                this.tabsMarkedForRemoval.push(this.tabs[i])\r\n                this.tabs.splice(i, 1);\r\n                return;\r\n            }\r\n        }        \r\n\r\n        throw new Error('contentItem is not controlled by this header');\r\n    }\r\n\r\n    /**\r\n     * The programmatical equivalent of clicking a Tab.\r\n     *\r\n     * @param {AbstractContentItem} contentItem\r\n     */\r\n    setActiveContentItem(contentItem) {\r\n        var i, j, isActive, activeTab;\r\n\r\n        if (this.activeContentItem === contentItem) return;\r\n\r\n        for (i = 0; i < this.tabs.length; i++) {\r\n            isActive = this.tabs[i].contentItem === contentItem;\r\n            this.tabs[i].setActive(isActive);\r\n            if (isActive === true) {\r\n                this.activeContentItem = contentItem;\r\n                this.parent.config.activeItemIndex = i;\r\n            }\r\n        }\r\n\r\n        if (this.layoutManager.config.settings.reorderOnTabMenuClick) {\r\n            /**\r\n             * If the tab selected was in the dropdown, move everything down one to make way for this one to be the first.\r\n             * This will make sure the most used tabs stay visible.\r\n             */\r\n            if (this._lastVisibleTabIndex !== -1 && this.parent.config.activeItemIndex > this._lastVisibleTabIndex) {\r\n                activeTab = this.tabs[this.parent.config.activeItemIndex];\r\n                for (j = this.parent.config.activeItemIndex; j > 0; j--) {\r\n                    this.tabs[j] = this.tabs[j - 1];\r\n                }\r\n                this.tabs[0] = activeTab;\r\n                this.parent.config.activeItemIndex = 0;\r\n            }\r\n        }\r\n\r\n        this._updateTabSizes();\r\n        this.parent.emitBubblingEvent('stateChanged');\r\n    }\r\n\r\n    /**\r\n     * Programmatically operate with header position.\r\n     *\r\n     * @param {string} position one of ('top','left','right','bottom') to set or empty to get it.\r\n     *\r\n     * @returns {string} previous header position\r\n     */\r\n    position(position) {\r\n        var previous = this.parent._header.show;\r\n        if (this.parent._docker && this.parent._docker.docked)\r\n            throw new Error('Can\\'t change header position in docked stack');\r\n        if (previous && !this.parent._side)\r\n            previous = 'top';\r\n        if (position !== undefined && this.parent._header.show != position) {\r\n            this.parent._header.show = position;\r\n            this.parent.config.header ? this.parent.config.header.show = position : this.parent.config.header = { show: position };\r\n            this.parent._setupHeaderPosition();\r\n        }\r\n        return previous;\r\n    }\r\n\r\n    /**\r\n     * Programmatically set closability.\r\n     *\r\n     * @package private\r\n     * @param {Boolean} isClosable Whether to enable/disable closability.\r\n     *\r\n     * @returns {Boolean} Whether the action was successful\r\n     */\r\n    _$setClosable(isClosable) {\r\n        this._canDestroy = isClosable || this.tabs.length > 1;\r\n        if (this.closeButton && this._isClosable()) {\r\n            this.closeButton.element[isClosable ? \"show\" : \"hide\"]();\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Programmatically set ability to dock.\r\n     *\r\n     * @package private\r\n     * @param {Boolean} isDockable Whether to enable/disable ability to dock.\r\n     *\r\n     * @returns {Boolean} Whether the action was successful\r\n     */\r\n    _setDockable(isDockable) {\r\n        if (this.dockButton && this.parent._header && this.parent._header.dock) {\r\n            this.dockButton.element.toggle(!!isDockable);\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * Destroys the entire header\r\n     *\r\n     * @package private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _$destroy() {\r\n        this.emit('destroy', this);\r\n\r\n        for (var i = 0; i < this.tabs.length; i++) {\r\n            this.tabs[i]._$destroy();\r\n        }\r\n        $(document).off('mouseup', this.hideAdditionalTabsDropdown);\r\n        this.element.remove();\r\n    }\r\n\r\n    /**\r\n     * get settings from header\r\n     *\r\n     * @returns {string} when exists\r\n     */\r\n    _getHeaderSetting(name) {\r\n        if (name in this.parent._header)\r\n            return this.parent._header[name];\r\n    }\r\n\r\n    /**\r\n     * Creates the popout, maximise and close buttons in the header's top right corner\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _createControls() {\r\n        var closeStack,\r\n            popout,\r\n            label,\r\n            maximiseLabel,\r\n            minimiseLabel,\r\n            maximise,\r\n            maximiseButton,\r\n            tabDropdownLabel,\r\n            showTabDropdown;\r\n\r\n        /**\r\n         * Dropdown to show additional tabs.\r\n         */\r\n        showTabDropdown = fnBind(this._showAdditionalTabsDropdown, this);\r\n        tabDropdownLabel = this.layoutManager.config.labels.tabDropdown;\r\n        this.tabDropdownButton = new HeaderButton(this, tabDropdownLabel, 'lm_tabdropdown', showTabDropdown);\r\n        this.tabDropdownButton.element.hide();\r\n\r\n        if (this.parent._header && this.parent._header.dock) {\r\n            var button = fnBind(this.parent.dock, this.parent);\r\n            label = this._getHeaderSetting('dock');\r\n            this.dockButton = new HeaderButton(this, label, 'lm_dock', button);\r\n        }\r\n\r\n        /**\r\n         * Popout control to launch component in new window.\r\n         */\r\n        if (this._getHeaderSetting('popout')) {\r\n            popout = fnBind(this._onPopoutClick, this);\r\n            label = this._getHeaderSetting('popout');\r\n            new HeaderButton(this, label, 'lm_popout', popout);\r\n        }\r\n\r\n        /**\r\n         * Maximise control - set the component to the full size of the layout\r\n         */\r\n        if (this._getHeaderSetting('maximise')) {\r\n            maximise = fnBind(this.parent.toggleMaximise, this.parent);\r\n            maximiseLabel = this._getHeaderSetting('maximise');\r\n            minimiseLabel = this._getHeaderSetting('minimise');\r\n            maximiseButton = new HeaderButton(this, maximiseLabel, 'lm_maximise', maximise);\r\n\r\n            this.parent.on('maximised', function() {\r\n                maximiseButton.element.attr('title', minimiseLabel);\r\n            });\r\n\r\n            this.parent.on('minimised', function() {\r\n                maximiseButton.element.attr('title', maximiseLabel);\r\n            });\r\n        }\r\n\r\n        /**\r\n         * Close button\r\n         */\r\n        if (this._isClosable()) {\r\n            closeStack = fnBind(this.parent.remove, this.parent);\r\n            label = this._getHeaderSetting('close');\r\n            this.closeButton = new HeaderButton(this, label, 'lm_close', closeStack);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Shows drop down for additional tabs when there are too many to display.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _showAdditionalTabsDropdown() {\r\n        this.tabDropdownContainer.show();\r\n    }\r\n\r\n    /**\r\n     * Hides drop down for additional tabs when there are too many to display.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _hideAdditionalTabsDropdown(e) {\r\n        this.tabDropdownContainer.hide();\r\n    }\r\n\r\n    /**\r\n     * Checks whether the header is closable based on the parent config and\r\n     * the global config.\r\n     *\r\n     * @returns {Boolean} Whether the header is closable.\r\n     */\r\n    _isClosable() {\r\n        return this.parent.config.isClosable && this.layoutManager.config.settings.showCloseIcon;\r\n    }\r\n\r\n    _onPopoutClick() {\r\n        if (this.layoutManager.config.settings.popoutWholeStack === true) {\r\n            this.parent.popout();\r\n        } else {\r\n            this.activeContentItem.popout();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Invoked when the header's background is clicked (not it's tabs or controls)\r\n     *\r\n     * @param    {jQuery DOM event} event\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _onHeaderClick(event) {\r\n        if (event.target === this.element[0]) {\r\n            this.parent.select();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Pushes the tabs to the tab dropdown if the available space is not sufficient\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _updateTabSizes(showTabMenu) {\r\n        if (this.tabs.length === 0) {\r\n            return;\r\n        }\r\n\r\n        //Show the menu based on function argument\r\n        this.tabDropdownButton.element.toggle(showTabMenu === true);\r\n\r\n        var size = function(val) {\r\n            return val ? 'width' : 'height';\r\n        };\r\n        this.element.css(size(!this.parent._sided), '');\r\n        this.element[size(this.parent._sided)](this.layoutManager.config.dimensions.headerHeight);\r\n        var availableWidth = this.element.outerWidth() - this.controlsContainer.outerWidth() - this._tabControlOffset,\r\n            cumulativeTabWidth = 0,\r\n            visibleTabWidth = 0,\r\n            tabElement,\r\n            i,\r\n            j,\r\n            marginLeft,\r\n            overlap = 0,\r\n            tabWidth,\r\n            tabOverlapAllowance = this.layoutManager.config.settings.tabOverlapAllowance,\r\n            tabOverlapAllowanceExceeded = false,\r\n            activeIndex = (this.activeContentItem ? this.tabs.indexOf(this.activeContentItem.tab) : 0),\r\n            activeTab = this.tabs[activeIndex];\r\n        if (this.parent._sided)\r\n            availableWidth = this.element.outerHeight() - this.controlsContainer.outerHeight() - this._tabControlOffset;\r\n        this._lastVisibleTabIndex = -1;\r\n\r\n        for (i = 0; i < this.tabs.length; i++) {\r\n            tabElement = this.tabs[i].element;\r\n\r\n            //Put the tab in the tabContainer so its true width can be checked\r\n            this.tabsContainer.append(tabElement);\r\n            tabWidth = tabElement.outerWidth() + parseInt(tabElement.css('margin-right'), 10);\r\n\r\n            cumulativeTabWidth += tabWidth;\r\n\r\n            //Include the active tab's width if it isn't already\r\n            //This is to ensure there is room to show the active tab\r\n            if (activeIndex <= i) {\r\n                visibleTabWidth = cumulativeTabWidth;\r\n            } else {\r\n                visibleTabWidth = cumulativeTabWidth + activeTab.element.outerWidth() + parseInt(activeTab.element.css('margin-right'), 10);\r\n            }\r\n\r\n            // If the tabs won't fit, check the overlap allowance.\r\n            if (visibleTabWidth > availableWidth) {\r\n\r\n                //Once allowance is exceeded, all remaining tabs go to menu.\r\n                if (!tabOverlapAllowanceExceeded) {\r\n\r\n                    //No overlap for first tab or active tab\r\n                    //Overlap spreads among non-active, non-first tabs\r\n                    if (activeIndex > 0 && activeIndex <= i) {\r\n                        overlap = (visibleTabWidth - availableWidth) / (i - 1);\r\n                    } else {\r\n                        overlap = (visibleTabWidth - availableWidth) / i;\r\n                    }\r\n\r\n                    //Check overlap against allowance.\r\n                    if (overlap < tabOverlapAllowance) {\r\n                        for (j = 0; j <= i; j++) {\r\n                            marginLeft = (j !== activeIndex && j !== 0) ? '-' + overlap + 'px' : '';\r\n                            this.tabs[j].element.css({\r\n                                'z-index': i - j,\r\n                                'margin-left': marginLeft\r\n                            });\r\n                        }\r\n                        this._lastVisibleTabIndex = i;\r\n                        this.tabsContainer.append(tabElement);\r\n                    } else {\r\n                        tabOverlapAllowanceExceeded = true;\r\n                    }\r\n\r\n                } else if (i === activeIndex) {\r\n                    //Active tab should show even if allowance exceeded. (We left room.)\r\n                    tabElement.css({\r\n                        'z-index': 'auto',\r\n                        'margin-left': ''\r\n                    });\r\n                    this.tabsContainer.append(tabElement);\r\n                }\r\n\r\n                if (tabOverlapAllowanceExceeded && i !== activeIndex) {\r\n                    if (showTabMenu) {\r\n                        //Tab menu already shown, so we just add to it.\r\n                        tabElement.css({\r\n                            'z-index': 'auto',\r\n                            'margin-left': ''\r\n                        });\r\n                        this.tabDropdownContainer.append(tabElement);\r\n                    } else {\r\n                        //We now know the tab menu must be shown, so we have to recalculate everything.\r\n                        this._updateTabSizes(true);\r\n                        return;\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                this._lastVisibleTabIndex = i;\r\n                tabElement.css({\r\n                    'z-index': 'auto',\r\n                    'margin-left': ''\r\n                });\r\n                this.tabsContainer.append(tabElement);\r\n            }\r\n        }\r\n\r\n    }\r\n}\r\n","import AbstractContentItem from '../items/AbstractContentItem'\r\nimport RowOrColumn from '../items/RowOrColumn'\r\nimport Header from '../controls/Header'\r\n\r\nimport {\r\n    fnBind,\r\n    copy,\r\n    indexOf\r\n} from '../utils/utils'\r\nimport $ from 'jquery';\r\n\r\n\r\nexport default class Stack extends AbstractContentItem {\r\n    constructor(layoutManager, config, parent) {\r\n        super(layoutManager, config, parent)\r\n\r\n        this.element = $('<div class=\"lm_item lm_stack\"></div>');\r\n        this._activeContentItem = null;\r\n        var cfg = layoutManager.config;\r\n        this._header = { // defaults' reconstruction from old configuration style\r\n            show: cfg.settings.hasHeaders === true && config.hasHeaders !== false,\r\n            popout: cfg.settings.showPopoutIcon && cfg.labels.popout,\r\n            maximise: cfg.settings.showMaximiseIcon && cfg.labels.maximise,\r\n            close: cfg.settings.showCloseIcon && cfg.labels.close,\r\n            minimise: cfg.labels.minimise,\r\n        };\r\n        if (cfg.header) // load simplified version of header configuration (https://github.com/deepstreamIO/golden-layout/pull/245)\r\n            copy(this._header, cfg.header);\r\n        if (config.header) // load from stack\r\n            copy(this._header, config.header);\r\n        if (config.content && config.content[0] && config.content[0].header) // load from component if stack omitted\r\n            copy(this._header, config.content[0].header);\r\n\r\n        this._dropZones = {};\r\n        this._dropSegment = null;\r\n        this._contentAreaDimensions = null;\r\n        this._dropIndex = null;\r\n\r\n        this.isStack = true;\r\n\r\n        this.childElementContainer = $('<div class=\"lm_items\"></div>');\r\n        this.header = new Header(layoutManager, this);\r\n\r\n        this.element.on('mouseleave mouseenter', fnBind(function(event) {\r\n            if (this._docker && this._docker.docked)\r\n                this.childElementContainer[this._docker.dimension](event.type == 'mouseenter' ? this._docker.realSize : 0);\r\n        }, this));\r\n        this.element.append(this.header.element);\r\n        this.element.append(this.childElementContainer);\r\n        this._setupHeaderPosition();\r\n        this._$validateClosability();\r\n    }\r\n\r\n    dock(mode) {\r\n        if (this._header.dock)\r\n            if (this.parent instanceof RowOrColumn)\r\n                this.parent.dock(this, mode);\r\n    }\r\n\r\n    setSize() {\r\n        if (this.element.css('display') === 'none') return;\r\n        var isDocked = this._docker && this._docker.docked,\r\n            content = {\r\n                width: this.element.width(),\r\n                height: this.element.height()\r\n            };\r\n\r\n        if (this._header.show)\r\n            content[this._sided ? 'width' : 'height'] -= this.layoutManager.config.dimensions.headerHeight;\r\n        if (isDocked)\r\n            content[this._docker.dimension] = this._docker.realSize;\r\n        if (!isDocked || this._docker.dimension == 'height')\r\n            this.childElementContainer.width(content.width);\r\n        if (!isDocked || this._docker.dimension == 'width')\r\n            this.childElementContainer.height(content.height);\r\n\r\n        for (var i = 0; i < this.contentItems.length; i++) {\r\n            this.contentItems[i].element.width(content.width);\r\n            this.contentItems[i].element.height(content.height);\r\n        }\r\n        this.emit('resize');\r\n        this.emitBubblingEvent('stateChanged');\r\n    }\r\n\r\n    _$init() {\r\n        var i, initialItem;\r\n\r\n        if (this.isInitialised === true) return;\r\n\r\n        AbstractContentItem.prototype._$init.call(this);\r\n\r\n        for (i = 0; i < this.contentItems.length; i++) {\r\n            this.header.createTab(this.contentItems[i]);\r\n            this.contentItems[i]._$hide();\r\n        }\r\n\r\n        if (this.contentItems.length > 0) {\r\n            initialItem = this.contentItems[this.config.activeItemIndex || 0];\r\n\r\n            if (!initialItem) {\r\n                throw new Error('Configured activeItemIndex out of bounds');\r\n            }\r\n\r\n            this.setActiveContentItem(initialItem);\r\n        }\r\n        this._$validateClosability();\t\t\r\n\t\tif (this.parent instanceof RowOrColumn) {\r\n\t\t\tthis.parent._validateDocking();\r\n\t\t}\r\n    }\r\n\r\n    setActiveContentItem(contentItem) {\r\n        if (this._activeContentItem === contentItem) return;\r\n\r\n        if (indexOf(contentItem, this.contentItems) === -1) {\r\n            throw new Error('contentItem is not a child of this stack');\r\n        }\r\n\r\n        if (this._activeContentItem !== null) {\r\n            this._activeContentItem._$hide();\r\n        }\r\n\r\n        this._activeContentItem = contentItem;\r\n        this.header.setActiveContentItem(contentItem);\r\n        contentItem._$show();\r\n        this.emit('activeContentItemChanged', contentItem);\r\n        this.layoutManager.emit('activeContentItemChanged', contentItem);\r\n        this.emitBubblingEvent('stateChanged');\r\n    }\r\n\r\n    getActiveContentItem() {\r\n        return this.header.activeContentItem;\r\n    }\r\n\r\n    addChild(contentItem, index) {\r\n        if(index > this.contentItems.length){\r\n            /* \r\n             * UGLY PATCH: PR #428, commit a4e84ec5 fixed a bug appearing on touchscreens during the drag of a panel. \r\n             * The bug was caused by the physical removal of the element on drag: partial documentation is at issue #425. \r\n             * The fix introduced the function undisplayChild() (called 'undisplay' to differentiate it from jQuery.hide), \r\n             * which doesn't remove the element but only hides it: that's why when a tab is dragged & dropped into its \r\n             * original container (at the end), the index here could be off by one.\r\n             */\r\n            index -= 1\r\n        }        \r\n        contentItem = this.layoutManager._$normalizeContentItem(contentItem, this);\r\n        AbstractContentItem.prototype.addChild.call(this, contentItem, index);\r\n        this.childElementContainer.append(contentItem.element);\r\n        this.header.createTab(contentItem, index);\r\n        this.setActiveContentItem(contentItem);\r\n        this.callDownwards('setSize');\r\n        this._$validateClosability();\r\n        if (this.parent instanceof RowOrColumn)\r\n            this.parent._validateDocking();\r\n        this.emitBubblingEvent('stateChanged');\r\n    }\r\n\r\n    removeChild(contentItem, keepChild) {\r\n        var index = indexOf(contentItem, this.contentItems);\r\n        AbstractContentItem.prototype.removeChild.call(this, contentItem, keepChild);\r\n        this.header.removeTab(contentItem);\r\n        if (this.header.activeContentItem === contentItem) {\r\n            if (this.contentItems.length > 0) {\r\n                this.setActiveContentItem(this.contentItems[Math.max(index - 1, 0)]);\r\n            } else {\r\n                this._activeContentItem = null;\r\n            }\r\n        } else if (this.config.activeItemIndex >= this.contentItems.length) {\r\n\t\t\tif (this.contentItems.length > 0) {\r\n\t\t\t\tvar activeIndex = indexOf(this.getActiveContentItem(), this.contentItems);\r\n\t\t\t\tthis.config.activeItemIndex = Math.max(activeIndex, 0);\r\n\t\t\t}\r\n\t\t}\r\n\r\n        this._$validateClosability();\r\n        if (this.parent instanceof RowOrColumn)\r\n            this.parent._validateDocking();\r\n        this.emitBubblingEvent('stateChanged');\r\n    }\r\n\r\n    undisplayChild(contentItem) {\r\n        if(this.contentItems.length > 1){\r\n            var index = indexOf(contentItem, this.contentItems)\r\n            contentItem._$hide && contentItem._$hide()\r\n            this.setActiveContentItem(this.contentItems[index === 0 ? index+1 : index-1])\r\n        } else {\r\n            this.header.hideTab(contentItem);\r\n            contentItem._$hide && contentItem._$hide()\r\n            AbstractContentItem.prototype.undisplayChild.call(this, contentItem);\r\n            if (this.parent instanceof RowOrColumn)\r\n                this.parent._validateDocking();\r\n        }\r\n        this.emitBubblingEvent('stateChanged');\r\n    }\r\n\r\n    /**\r\n     * Validates that the stack is still closable or not. If a stack is able\r\n     * to close, but has a non closable component added to it, the stack is no\r\n     * longer closable until all components are closable.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _$validateClosability() {\r\n        var contentItem,\r\n            isClosable,\r\n            len,\r\n            i;\r\n\r\n        isClosable = this.header._isClosable();\r\n\r\n        for (i = 0, len = this.contentItems.length; i < len; i++) {\r\n            if (!isClosable) {\r\n                break;\r\n            }\r\n\r\n            isClosable = this.contentItems[i].config.isClosable;\r\n        }\r\n\r\n        this.header._$setClosable(isClosable);\r\n    }\r\n\r\n    _$destroy() {\r\n        AbstractContentItem.prototype._$destroy.call(this);\r\n        this.header._$destroy();\r\n        this.element.off('mouseenter mouseleave');\r\n    }\r\n\r\n    /**\r\n     * Ok, this one is going to be the tricky one: The user has dropped {contentItem} onto this stack.\r\n     *\r\n     * It was dropped on either the stacks header or the top, right, bottom or left bit of the content area\r\n     * (which one of those is stored in this._dropSegment). Now, if the user has dropped on the header the case\r\n     * is relatively clear: We add the item to the existing stack... job done (might be good to have\r\n     * tab reordering at some point, but lets not sweat it right now)\r\n     *\r\n     * If the item was dropped on the content part things are a bit more complicated. If it was dropped on either the\r\n     * top or bottom region we need to create a new column and place the items accordingly.\r\n     * Unless, of course if the stack is already within a column... in which case we want\r\n     * to add the newly created item to the existing column...\r\n     * either prepend or append it, depending on wether its top or bottom.\r\n     *\r\n     * Same thing for rows and left / right drop segments... so in total there are 9 things that can potentially happen\r\n     * (left, top, right, bottom) * is child of the right parent (row, column) + header drop\r\n     *\r\n     * @param    {lm.item} contentItem\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _$onDrop(contentItem) {\r\n        /*\r\n         * The item was dropped on the header area. Just add it as a child of this stack and\r\n         * get the hell out of this logic\r\n         */\r\n        if (this._dropSegment === 'header') {\r\n            this._resetHeaderDropZone();\r\n            this.addChild(contentItem, this._dropIndex);\r\n            return;\r\n        }\r\n\r\n        /*\r\n         * The stack is empty. Let's just add the element.\r\n         */\r\n        if (this._dropSegment === 'body') {\r\n            this.addChild(contentItem);\r\n            return;\r\n        }\r\n\r\n        /*\r\n         * The item was dropped on the top-, left-, bottom- or right- part of the content. Let's\r\n         * aggregate some conditions to make the if statements later on more readable\r\n         */\r\n        var isVertical = this._dropSegment === 'top' || this._dropSegment === 'bottom',\r\n            isHorizontal = this._dropSegment === 'left' || this._dropSegment === 'right',\r\n            insertBefore = this._dropSegment === 'top' || this._dropSegment === 'left',\r\n            hasCorrectParent = (isVertical && this.parent.isColumn) || (isHorizontal && this.parent.isRow),\r\n            type = isVertical ? 'column' : 'row',\r\n            dimension = isVertical ? 'height' : 'width',\r\n            index,\r\n            stack,\r\n            rowOrColumn;\r\n\r\n        /*\r\n         * The content item can be either a component or a stack. If it is a component, wrap it into a stack\r\n         */\r\n        if (contentItem.isComponent) {\r\n            stack = this.layoutManager.createContentItem({\r\n                type: 'stack',\r\n                header: contentItem.config.header || {}\r\n            }, this);\r\n            stack._$init();\r\n            stack.addChild(contentItem);\r\n            contentItem = stack;\r\n        }\r\n\r\n\r\n        /*\r\n         * If the contentItem that's being dropped is not dropped on a Stack (cases which just passed above and \r\n         * which would wrap the contentItem in a Stack) we need to check whether contentItem is a RowOrColumn.\r\n         * If it is, we need to re-wrap it in a Stack like it was when it was dragged by its Tab (it was dragged!).\r\n         */\r\n        if(contentItem.config.type === 'row' || contentItem.config.type === 'column'){\r\n            stack = this.layoutManager.createContentItem({\r\n                type: 'stack'\r\n            }, this)\r\n            stack.addChild(contentItem)\r\n            contentItem = stack\r\n        }\r\n\r\n        /*\r\n         * If the item is dropped on top or bottom of a column or left and right of a row, it's already\r\n         * layd out in the correct way. Just add it as a child\r\n         */\r\n        if (hasCorrectParent) {\r\n            index = indexOf(this, this.parent.contentItems);\r\n            this.parent.addChild(contentItem, insertBefore ? index : index + 1, true);\r\n            this.config[dimension] *= 0.5;\r\n            contentItem.config[dimension] = this.config[dimension];\r\n            this.parent.callDownwards('setSize');\r\n            /*\r\n             * This handles items that are dropped on top or bottom of a row or left / right of a column. We need\r\n             * to create the appropriate contentItem for them to live in\r\n             */\r\n        } else {\r\n            type = isVertical ? 'column' : 'row';\r\n            rowOrColumn = this.layoutManager.createContentItem({\r\n                type: type\r\n            }, this);\r\n            this.parent.replaceChild(this, rowOrColumn);\r\n\r\n            rowOrColumn.addChild(contentItem, insertBefore ? 0 : undefined, true);\r\n            rowOrColumn.addChild(this, insertBefore ? undefined : 0, true);\r\n\r\n            this.config[dimension] = 50;\r\n            contentItem.config[dimension] = 50;\r\n            rowOrColumn.callDownwards('setSize');\r\n        }\r\n        this.parent._validateDocking();\r\n    }\r\n\r\n    /**\r\n     * If the user hovers above the header part of the stack, indicate drop positions for tabs.\r\n     * otherwise indicate which segment of the body the dragged item would be dropped on\r\n     *\r\n     * @param    {Int} x Absolute Screen X\r\n     * @param    {Int} y Absolute Screen Y\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _$highlightDropZone(x, y) {\r\n        var segment, area;\r\n\r\n        for (segment in this._contentAreaDimensions) {\r\n            area = this._contentAreaDimensions[segment].hoverArea;\r\n\r\n            if (area.x1 < x && area.x2 > x && area.y1 < y && area.y2 > y) {\r\n\r\n                if (segment === 'header') {\r\n                    this._dropSegment = 'header';\r\n                    this._highlightHeaderDropZone(this._sided ? y : x);\r\n                } else {\r\n                    this._resetHeaderDropZone();\r\n                    this._highlightBodyDropZone(segment);\r\n                }\r\n\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    _$getArea() {\r\n        if (this.element.css('display') === 'none') {\r\n            return null;\r\n        }\r\n\r\n        var getArea = AbstractContentItem.prototype._$getArea,\r\n            headerArea = getArea.call(this, this.header.element),\r\n            contentArea = getArea.call(this, this.childElementContainer),\r\n            contentWidth = contentArea.x2 - contentArea.x1,\r\n            contentHeight = contentArea.y2 - contentArea.y1;\r\n\r\n        this._contentAreaDimensions = {\r\n            header: {\r\n                hoverArea: {\r\n                    x1: headerArea.x1,\r\n                    y1: headerArea.y1,\r\n                    x2: headerArea.x2,\r\n                    y2: headerArea.y2\r\n                },\r\n                highlightArea: {\r\n                    x1: headerArea.x1,\r\n                    y1: headerArea.y1,\r\n                    x2: headerArea.x2,\r\n                    y2: headerArea.y2\r\n                }\r\n            }\r\n        };\r\n\r\n        /**\r\n         * If this Stack is a parent to rows, columns or other stacks only its\r\n         * header is a valid dropzone.\r\n         */\r\n        if (this._activeContentItem && this._activeContentItem.isComponent === false) {\r\n            return headerArea;\r\n        }\r\n\r\n        /**\r\n         * Highlight the entire body if the stack is empty\r\n         */\r\n        if (this.contentItems.length === 0) {\r\n\r\n            this._contentAreaDimensions.body = {\r\n                hoverArea: {\r\n                    x1: contentArea.x1,\r\n                    y1: contentArea.y1,\r\n                    x2: contentArea.x2,\r\n                    y2: contentArea.y2\r\n                },\r\n                highlightArea: {\r\n                    x1: contentArea.x1,\r\n                    y1: contentArea.y1,\r\n                    x2: contentArea.x2,\r\n                    y2: contentArea.y2\r\n                }\r\n            };\r\n\r\n            return getArea.call(this, this.element);\r\n        }\r\n\r\n        this._contentAreaDimensions.left = {\r\n            hoverArea: {\r\n                x1: contentArea.x1,\r\n                y1: contentArea.y1,\r\n                x2: contentArea.x1 + contentWidth * 0.25,\r\n                y2: contentArea.y2\r\n            },\r\n            highlightArea: {\r\n                x1: contentArea.x1,\r\n                y1: contentArea.y1,\r\n                x2: contentArea.x1 + contentWidth * 0.5,\r\n                y2: contentArea.y2\r\n            }\r\n        };\r\n\r\n        this._contentAreaDimensions.top = {\r\n            hoverArea: {\r\n                x1: contentArea.x1 + contentWidth * 0.25,\r\n                y1: contentArea.y1,\r\n                x2: contentArea.x1 + contentWidth * 0.75,\r\n                y2: contentArea.y1 + contentHeight * 0.5\r\n            },\r\n            highlightArea: {\r\n                x1: contentArea.x1,\r\n                y1: contentArea.y1,\r\n                x2: contentArea.x2,\r\n                y2: contentArea.y1 + contentHeight * 0.5\r\n            }\r\n        };\r\n\r\n        this._contentAreaDimensions.right = {\r\n            hoverArea: {\r\n                x1: contentArea.x1 + contentWidth * 0.75,\r\n                y1: contentArea.y1,\r\n                x2: contentArea.x2,\r\n                y2: contentArea.y2\r\n            },\r\n            highlightArea: {\r\n                x1: contentArea.x1 + contentWidth * 0.5,\r\n                y1: contentArea.y1,\r\n                x2: contentArea.x2,\r\n                y2: contentArea.y2\r\n            }\r\n        };\r\n\r\n        this._contentAreaDimensions.bottom = {\r\n            hoverArea: {\r\n                x1: contentArea.x1 + contentWidth * 0.25,\r\n                y1: contentArea.y1 + contentHeight * 0.5,\r\n                x2: contentArea.x1 + contentWidth * 0.75,\r\n                y2: contentArea.y2\r\n            },\r\n            highlightArea: {\r\n                x1: contentArea.x1,\r\n                y1: contentArea.y1 + contentHeight * 0.5,\r\n                x2: contentArea.x2,\r\n                y2: contentArea.y2\r\n            }\r\n        };\r\n\r\n        return getArea.call(this, this.element);\r\n    }\r\n\r\n    _highlightHeaderDropZone(x) {\r\n        var i,\r\n            tabElement,\r\n            tabsLength = this.header.tabs.length,\r\n            isAboveTab = false,\r\n            tabTop,\r\n            tabLeft,\r\n            offset,\r\n            placeHolderLeft,\r\n            headerOffset,\r\n            tabWidth,\r\n            halfX;\r\n\r\n        // Empty stack\r\n        if (tabsLength === 0) {\r\n            headerOffset = this.header.element.offset();\r\n\r\n            this.layoutManager.dropTargetIndicator.highlightArea({\r\n                x1: headerOffset.left,\r\n                x2: headerOffset.left + 100,\r\n                y1: headerOffset.top + this.header.element.height() - 20,\r\n                y2: headerOffset.top + this.header.element.height()\r\n            });\r\n\r\n            return;\r\n        }\r\n\r\n        for (i = 0; i < tabsLength; i++) {\r\n            tabElement = this.header.tabs[i].element;\r\n            offset = tabElement.offset();\r\n            if (this._sided) {\r\n                tabLeft = offset.top;\r\n                tabTop = offset.left;\r\n                tabWidth = tabElement.height();\r\n            } else {\r\n                tabLeft = offset.left;\r\n                tabTop = offset.top;\r\n                tabWidth = tabElement.width();\r\n            }\r\n\r\n            if (x > tabLeft && x < tabLeft + tabWidth) {\r\n                isAboveTab = true;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if (isAboveTab === false && x < tabLeft) {\r\n            return;\r\n        }\r\n\r\n        halfX = tabLeft + tabWidth / 2;\r\n\r\n        if (x < halfX) {\r\n            this._dropIndex = i;\r\n            tabElement.before(this.layoutManager.tabDropPlaceholder);\r\n        } else {\r\n            this._dropIndex = Math.min(i + 1, tabsLength);\r\n            tabElement.after(this.layoutManager.tabDropPlaceholder);\r\n        }\r\n\r\n\r\n        if (this._sided) {\r\n            var placeHolderTop = this.layoutManager.tabDropPlaceholder.offset().top;\r\n            this.layoutManager.dropTargetIndicator.highlightArea({\r\n                x1: tabTop,\r\n                x2: tabTop + tabElement.innerHeight(),\r\n                y1: placeHolderTop,\r\n                y2: placeHolderTop + this.layoutManager.tabDropPlaceholder.width()\r\n            });\r\n            return;\r\n        }\r\n        placeHolderLeft = this.layoutManager.tabDropPlaceholder.offset().left;\r\n\r\n        this.layoutManager.dropTargetIndicator.highlightArea({\r\n            x1: placeHolderLeft,\r\n            x2: placeHolderLeft + this.layoutManager.tabDropPlaceholder.width(),\r\n            y1: tabTop,\r\n            y2: tabTop + tabElement.innerHeight()\r\n        });\r\n    }\r\n\r\n    _resetHeaderDropZone() {\r\n        this.layoutManager.tabDropPlaceholder.remove();\r\n    }\r\n\r\n    toggleMaximise(e) {\r\n        if (!this.isMaximised)\r\n            this.dock(false);\r\n        AbstractContentItem.prototype.toggleMaximise.call(this, e);\r\n    }\r\n\r\n    _setupHeaderPosition() {\r\n        var side = ['right', 'left', 'bottom'].indexOf(this._header.show) >= 0 && this._header.show;\r\n        this.header.element.toggle(!!this._header.show);\r\n        this._side = side;\r\n        this._sided = ['right', 'left'].indexOf(this._side) >= 0;\r\n        this.element.removeClass('lm_left lm_right lm_bottom');\r\n        if (this._side)\r\n            this.element.addClass('lm_' + this._side);\r\n        if (this.element.find('.lm_header').length && this.childElementContainer) {\r\n            var headerPosition = ['right', 'bottom'].indexOf(this._side) >= 0 ? 'before' : 'after';\r\n            this.header.element[headerPosition](this.childElementContainer);\r\n            this.callDownwards('setSize');\r\n        }\r\n    }\r\n\r\n    _highlightBodyDropZone(segment) {\r\n        var highlightArea = this._contentAreaDimensions[segment].highlightArea;\r\n        this.layoutManager.dropTargetIndicator.highlightArea(highlightArea);\r\n        this._dropSegment = segment;\r\n    }\r\n}\r\n","import DragListener from '../utils/DragListener'\r\nimport $ from 'jquery'\r\n\r\nexport default class Splitter {\r\n    constructor(isVertical, size, grabSize) {\r\n        this._isVertical = isVertical;\r\n        this._size = size;\r\n        this._grabSize = grabSize < size ? size : grabSize;\r\n\r\n        this.element = this._createElement();\r\n        this._dragListener = new DragListener(this.element);\r\n    }\r\n\r\n    on(event, callback, context) {\r\n        this._dragListener.on(event, callback, context);\r\n    }\r\n\r\n    _$destroy() {\r\n        this.element.remove();\r\n    }\r\n\r\n    _createElement() {\r\n        var dragHandle = $('<div class=\"lm_drag_handle\"></div>');\r\n        var element = $('<div class=\"lm_splitter\"></div>');\r\n        element.append(dragHandle);\r\n\r\n        var handleExcessSize = this._grabSize - this._size;\r\n        var handleExcessPos = handleExcessSize / 2;\r\n\r\n        if (this._isVertical) {\r\n            dragHandle.css('top', -handleExcessPos);\r\n            dragHandle.css('height', this._size + handleExcessSize);\r\n            element.addClass('lm_vertical');\r\n            element['height'](this._size);\r\n        } else {\r\n            dragHandle.css('left', -handleExcessPos);\r\n            dragHandle.css('width', this._size + handleExcessSize);\r\n            element.addClass('lm_horizontal');\r\n            element['width'](this._size);\r\n        }\r\n\r\n        return element;\r\n    }\r\n}\r\n","import AbstractContentItem from '../items/AbstractContentItem'\r\nimport Stack from '../items/Stack'\r\nimport Splitter from '../controls/Splitter'\r\nimport {\r\n    fnBind,\r\n    animFrame,\r\n    indexOf\r\n} from '../utils/utils'\r\nimport $ from 'jquery'\r\n\r\n\r\n\r\nexport default class RowOrColumn extends AbstractContentItem {\r\n    constructor(isColumn, layoutManager, config, parent) {\r\n      \r\n        super(layoutManager, config, parent);\r\n\r\n        this.isRow = !isColumn;\r\n        this.isColumn = isColumn;\r\n\r\n        this.element = $('<div class=\"lm_item lm_' + (isColumn ? 'column' : 'row') + '\"></div>');\r\n        this.childElementContainer = this.element;\r\n        this._splitterSize = layoutManager.config.dimensions.borderWidth;\r\n        this._splitterGrabSize = layoutManager.config.dimensions.borderGrabWidth;\r\n        this._isColumn = isColumn;\r\n        this._dimension = isColumn ? 'height' : 'width';\r\n        this._splitter = [];\r\n        this._splitterPosition = null;\r\n        this._splitterMinPosition = null;\r\n        this._splitterMaxPosition = null;\r\n    }\r\n\r\n\r\n    /**\r\n     * Add a new contentItem to the Row or Column\r\n     *\r\n     * @param {AbstractContentItem} contentItem\r\n     * @param {[int]} index The position of the new item within the Row or Column.\r\n     *                      If no index is provided the item will be added to the end\r\n     * @param {[bool]} _$suspendResize If true the items won't be resized. This will leave the item in\r\n     *                                 an inconsistent state and is only intended to be used if multiple\r\n     *                                 children need to be added in one go and resize is called afterwards\r\n     *\r\n     * @returns {void}\r\n     */\r\n    addChild(contentItem, index, _$suspendResize) {\r\n\r\n        var newItemSize, itemSize, i, splitterElement;\r\n\r\n        contentItem = this.layoutManager._$normalizeContentItem(contentItem, this);\r\n\r\n        if (index === undefined) {\r\n            index = this.contentItems.length;\r\n        }\r\n\r\n        if (this.contentItems.length > 0) {\r\n            splitterElement = this._createSplitter(Math.max(0, index - 1)).element;\r\n\r\n            if (index > 0) {\r\n                this.contentItems[index - 1].element.after(splitterElement);\r\n                splitterElement.after(contentItem.element);\r\n                if (this._isDocked(index - 1)) {\r\n                    this._splitter[index - 1].element.hide();\r\n                    this._splitter[index].element.show();\r\n                }\r\n            } else {\r\n                this.contentItems[0].element.before(splitterElement);\r\n                splitterElement.before(contentItem.element);\r\n            }\r\n        } else {\r\n            this.childElementContainer.append(contentItem.element);\r\n        }\r\n\r\n        AbstractContentItem.prototype.addChild.call(this, contentItem, index);\r\n\r\n        newItemSize = (1 / this.contentItems.length) * 100;\r\n\r\n        if (_$suspendResize === true) {\r\n            this.emitBubblingEvent('stateChanged');\r\n            return;\r\n        }\r\n\r\n        for (i = 0; i < this.contentItems.length; i++) {\r\n            if (this.contentItems[i] === contentItem) {\r\n                contentItem.config[this._dimension] = newItemSize;\r\n            } else {\r\n                itemSize = this.contentItems[i].config[this._dimension] *= (100 - newItemSize) / 100;\r\n                this.contentItems[i].config[this._dimension] = itemSize;\r\n            }\r\n        }\r\n\r\n        this.callDownwards('setSize');\r\n        this.emitBubblingEvent('stateChanged');\r\n        this._validateDocking();\r\n    }\r\n\r\n\r\n    /**\r\n     * Undisplays a child of this element\r\n     *\r\n     * @param   {AbstractContentItem} contentItem\r\n     *\r\n     * @returns {void}\r\n     */\r\n    undisplayChild(contentItem) {\r\n        var undisplayedItemSize = contentItem.config[this._dimension],\r\n            index = indexOf(contentItem, this.contentItems),\r\n            splitterIndex = Math.max(index - 1, 0),\r\n            i,\r\n            childItem;\r\n\r\n        if (index === -1) {\r\n            throw new Error('Can\\'t undisplay child. ContentItem is not child of this Row or Column');\r\n        }\r\n\r\n        /**\r\n         * Hide the splitter before the item or after if the item happens\r\n         * to be the first in the row/column\r\n         */\r\n        if (this._splitter[splitterIndex]) {\r\n            this._splitter[splitterIndex].element.hide();\r\n        }\r\n\r\n        if (splitterIndex < this._splitter.length) {\r\n            if (this._isDocked(splitterIndex))\r\n                this._splitter[splitterIndex].element.hide();\r\n        }\r\n\r\n        /**\r\n         * Allocate the space that the hidden item occupied to the remaining items\r\n         */\r\n        var docked = this._isDocked();\r\n        for (i = 0; i < this.contentItems.length; i++) {\r\n            if (this.contentItems[i] !== contentItem) {\r\n                if (!this._isDocked(i))\r\n                    this.contentItems[i].config[this._dimension] += undisplayedItemSize / (this.contentItems.length - 1 - docked);                \r\n            } else {\r\n              this.contentItems[i].config[this._dimension] = 0\r\n            }\r\n        }\r\n\r\n        if(this.contentItems.length === 1){\r\n            AbstractContentItem.prototype.undisplayChild.call(this, contentItem);\r\n        }\r\n\r\n        this.callDownwards('setSize');\r\n        this.emitBubblingEvent('stateChanged');\r\n    }\r\n\r\n\r\n    /**\r\n     * Removes a child of this element\r\n     *\r\n     * @param   {AbstractContentItem} contentItem\r\n     * @param   {boolean} keepChild   If true the child will be removed, but not destroyed\r\n     *\r\n     * @returns {void}\r\n     */\r\n    removeChild(contentItem, keepChild) {\r\n        var removedItemSize = contentItem.config[this._dimension],\r\n            index = indexOf(contentItem, this.contentItems),\r\n            splitterIndex = Math.max(index - 1, 0),\r\n            i,\r\n            childItem;\r\n        if (index === -1) {\r\n            throw new Error('Can\\'t remove child. ContentItem is not child of this Row or Column');\r\n        }\r\n\r\n        /**\r\n         * Remove the splitter before the item or after if the item happens\r\n         * to be the first in the row/column\r\n         */\r\n        if (this._splitter[splitterIndex]) {\r\n            this._splitter[splitterIndex]._$destroy();\r\n            this._splitter.splice(splitterIndex, 1);\r\n        }\r\n\r\n        if (splitterIndex < this._splitter.length) {\r\n            if (this._isDocked(splitterIndex))\r\n                this._splitter[splitterIndex].element.hide();\r\n        }\r\n        /**\r\n         * Allocate the space that the removed item occupied to the remaining items\r\n         */\r\n        var docked = this._isDocked();\r\n        for (i = 0; i < this.contentItems.length; i++) {\r\n            if (this.contentItems[i] !== contentItem) {\r\n                if (!this._isDocked(i))\r\n                    this.contentItems[i].config[this._dimension] += removedItemSize / (this.contentItems.length - 1 - docked);\r\n\r\n            }\r\n        }\r\n\r\n        AbstractContentItem.prototype.removeChild.call(this, contentItem, keepChild);\r\n\r\n        if (this.contentItems.length === 1 && this.config.isClosable === true) {\r\n            childItem = this.contentItems[0];\r\n            this.contentItems = [];\r\n            this.parent.replaceChild(this, childItem, true);\r\n            this._validateDocking(this.parent);\r\n        } else {\r\n            this.callDownwards('setSize');\r\n            this.emitBubblingEvent('stateChanged');\r\n            this._validateDocking();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Replaces a child of this Row or Column with another contentItem\r\n     *\r\n     * @param   {AbstractContentItem} oldChild\r\n     * @param   {AbstractContentItem} newChild\r\n     *\r\n     * @returns {void}\r\n     */\r\n    replaceChild(oldChild, newChild) {\r\n        var size = oldChild.config[this._dimension];\r\n        AbstractContentItem.prototype.replaceChild.call(this, oldChild, newChild);\r\n        newChild.config[this._dimension] = size;\r\n        this.callDownwards('setSize');\r\n        this.emitBubblingEvent('stateChanged');\r\n    }\r\n\r\n    /**\r\n     * Called whenever the dimensions of this item or one of its parents change\r\n     *\r\n     * @returns {void}\r\n     */\r\n    setSize() {\r\n        if (this.contentItems.length > 0) {\r\n            this._calculateRelativeSizes();\r\n            this._setAbsoluteSizes();\r\n        }\r\n        this.emitBubblingEvent('stateChanged');\r\n        this.emit('resize');\r\n    }\r\n\r\n    /**\r\n     * Dock or undock a child if it posiible\r\n     *\r\n     * @param   {AbstractContentItem} contentItem\r\n     * @param   {Boolean} mode or toggle if undefined\r\n     * @param   {Boolean} collapsed after docking\r\n     *\r\n     * @returns {void}\r\n     */\r\n    dock(contentItem, mode, collapsed) {\r\n        if (this.contentItems.length === 1)\r\n            throw new Error('Can\\'t dock child when it single');\r\n\r\n        var removedItemSize = contentItem.config[this._dimension],\r\n            headerSize = this.layoutManager.config.dimensions.headerHeight,\r\n            index = indexOf(contentItem, this.contentItems),\r\n            splitterIndex = Math.max(index - 1, 0);\r\n\r\n        if (index === -1) {\r\n            throw new Error('Can\\'t dock child. ContentItem is not child of this Row or Column');\r\n        }\r\n        var isDocked = contentItem._docker && contentItem._docker.docked;\r\n        var i\r\n        if (typeof mode != 'undefined')\r\n            if (mode == isDocked)\r\n                return;\r\n        if (isDocked) { // undock it\r\n            this._splitter[splitterIndex].element.show();\r\n            for (i = 0; i < this.contentItems.length; i++) {\r\n                var newItemSize = contentItem._docker.size;\r\n                if (this.contentItems[i] === contentItem) {\r\n                    contentItem.config[this._dimension] = newItemSize;\r\n                } else {\r\n                    itemSize = this.contentItems[i].config[this._dimension] *= (100 - newItemSize) / 100;\r\n                    this.contentItems[i].config[this._dimension] = itemSize;\r\n                }\r\n            }\r\n            contentItem._docker = {\r\n                docked: false\r\n            };\r\n        } else { // dock\r\n            if (this.contentItems.length - this._isDocked() < 2)\r\n                throw new Error('Can\\'t dock child when it is last in ' + this.config.type);\r\n            var autoside = {\r\n                column: {\r\n                    first: 'top',\r\n                    last: 'bottom'\r\n                },\r\n                row: {\r\n                    first: 'left',\r\n                    last: 'right'\r\n                }\r\n            };\r\n            var required = autoside[this.config.type][index ? 'last' : 'first'];\r\n            if (contentItem.header.position() != required)\r\n                contentItem.header.position(required);\r\n\r\n            if (this._splitter[splitterIndex]) {\r\n                this._splitter[splitterIndex].element.hide();\r\n            }\r\n            var docked = this._isDocked();\r\n            for (i = 0; i < this.contentItems.length; i++) {\r\n                if (this.contentItems[i] !== contentItem) {\r\n                    if (!this._isDocked(i))\r\n                        this.contentItems[i].config[this._dimension] += removedItemSize / (this.contentItems.length - 1 - docked);\r\n                } else\r\n                    this.contentItems[i].config[this._dimension] = 0;\r\n            }\r\n            contentItem._docker = {\r\n                dimension: this._dimension,\r\n                size: removedItemSize,\r\n                realSize: contentItem.element[this._dimension]() - headerSize,\r\n                docked: true,\r\n            };\r\n            if (collapsed)\r\n                contentItem.childElementContainer[this._dimension](0);\r\n        }\r\n        contentItem.element.toggleClass('lm_docked', contentItem._docker.docked);\r\n        this.callDownwards('setSize');\r\n        this.emitBubblingEvent('stateChanged');\r\n        this._validateDocking();\r\n    }\r\n\r\n    /**\r\n     * Invoked recursively by the layout manager. AbstractContentItem.init appends\r\n     * the contentItem's DOM elements to the container, RowOrColumn init adds splitters\r\n     * in between them\r\n     *\r\n     * @package private\r\n     * @override AbstractContentItem._$init\r\n     * @returns {void}\r\n     */\r\n    _$init() {\r\n        if (this.isInitialised === true) return;\r\n\r\n        var i;\r\n\r\n        AbstractContentItem.prototype._$init.call(this);\r\n\r\n        for (i = 0; i < this.contentItems.length - 1; i++) {\r\n            this.contentItems[i].element.after(this._createSplitter(i).element);\r\n        }\r\n        for (i = 0; i < this.contentItems.length; i++) {\r\n            if (this.contentItems[i]._header && this.contentItems[i]._header.docked)\r\n                this.dock(this.contentItems[i], true, true);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Turns the relative sizes calculated by _calculateRelativeSizes into\r\n     * absolute pixel values and applies them to the children's DOM elements\r\n     *\r\n     * Assigns additional pixels to counteract Math.floor\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _setAbsoluteSizes() {\r\n        var i,\r\n            sizeData = this._calculateAbsoluteSizes();\r\n\r\n        for (i = 0; i < this.contentItems.length; i++) {\r\n            if (sizeData.additionalPixel - i > 0) {\r\n                sizeData.itemSizes[i]++;\r\n            }\r\n\r\n            if (this._isColumn) {\r\n                this.contentItems[i].element.width(sizeData.totalWidth);\r\n                this.contentItems[i].element.height(sizeData.itemSizes[i]);\r\n            } else {\r\n                this.contentItems[i].element.width(sizeData.itemSizes[i]);\r\n                this.contentItems[i].element.height(sizeData.totalHeight);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Calculates the absolute sizes of all of the children of this Item.\r\n     * @returns {object} - Set with absolute sizes and additional pixels.\r\n     */\r\n    _calculateAbsoluteSizes() {\r\n        var i,\r\n            totalSplitterSize = (this.contentItems.length - 1) * this._splitterSize,\r\n            headerSize = this.layoutManager.config.dimensions.headerHeight,\r\n            totalWidth = this.element.width(),\r\n            totalHeight = this.element.height(),\r\n            totalAssigned = 0,\r\n            additionalPixel,\r\n            itemSize,\r\n            itemSizes = [];\r\n\r\n        if (this._isColumn) {\r\n            totalHeight -= totalSplitterSize;\r\n        } else {\r\n            totalWidth -= totalSplitterSize;\r\n        }\r\n        for (i = 0; i < this.contentItems.length; i++) {\r\n            if (this._isDocked(i))\r\n                if (this._isColumn) {\r\n                    totalHeight -= headerSize - this._splitterSize;\r\n                } else {\r\n                    totalWidth -= headerSize - this._splitterSize;\r\n                }\r\n        }\r\n\r\n        for (i = 0; i < this.contentItems.length; i++) {\r\n            if (this._isColumn) {\r\n                itemSize = Math.floor(totalHeight * (this.contentItems[i].config.height / 100));\r\n            } else {\r\n                itemSize = Math.floor(totalWidth * (this.contentItems[i].config.width / 100));\r\n            }\r\n            if (this._isDocked(i))\r\n                itemSize = headerSize;\r\n\r\n            totalAssigned += itemSize;\r\n            itemSizes.push(itemSize);\r\n        }\r\n\r\n        additionalPixel = Math.floor((this._isColumn ? totalHeight : totalWidth) - totalAssigned);\r\n\r\n        return {\r\n            itemSizes: itemSizes,\r\n            additionalPixel: additionalPixel,\r\n            totalWidth: totalWidth,\r\n            totalHeight: totalHeight\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Calculates the relative sizes of all children of this Item. The logic\r\n     * is as follows:\r\n     *\r\n     * - Add up the total size of all items that have a configured size\r\n     *\r\n     * - If the total == 100 (check for floating point errors)\r\n     *        Excellent, job done\r\n     *\r\n     * - If the total is > 100,\r\n     *        set the size of items without set dimensions to 1/3 and add this to the total\r\n     *        set the size off all items so that the total is hundred relative to their original size\r\n     *\r\n     * - If the total is < 100\r\n     *        If there are items without set dimensions, distribute the remainder to 100 evenly between them\r\n     *        If there are no items without set dimensions, increase all items sizes relative to\r\n     *        their original size so that they add up to 100\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _calculateRelativeSizes() {\r\n\r\n        var i,\r\n            total = 0,\r\n            itemsWithoutSetDimension = [],\r\n            dimension = this._isColumn ? 'height' : 'width';\r\n\r\n        for (i = 0; i < this.contentItems.length; i++) {\r\n            if (this.contentItems[i].config[dimension] !== undefined) {\r\n                total += this.contentItems[i].config[dimension];\r\n            } else {\r\n                itemsWithoutSetDimension.push(this.contentItems[i]);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Everything adds up to hundred, all good :-)\r\n         */\r\n        if (Math.round(total) === 100) {\r\n            this._respectMinItemWidth();\r\n            return;\r\n        }\r\n\r\n        /**\r\n         * Allocate the remaining size to the items without a set dimension\r\n         */\r\n        if (Math.round(total) < 100 && itemsWithoutSetDimension.length > 0) {\r\n            for (i = 0; i < itemsWithoutSetDimension.length; i++) {\r\n                itemsWithoutSetDimension[i].config[dimension] = (100 - total) / itemsWithoutSetDimension.length;\r\n            }\r\n            this._respectMinItemWidth();\r\n            return;\r\n        }\r\n\r\n        /**\r\n         * If the total is > 100, but there are also items without a set dimension left, assing 50\r\n         * as their dimension and add it to the total\r\n         *\r\n         * This will be reset in the next step\r\n         */\r\n        if (Math.round(total) > 100) {\r\n            for (i = 0; i < itemsWithoutSetDimension.length; i++) {\r\n                itemsWithoutSetDimension[i].config[dimension] = 50;\r\n                total += 50;\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Set every items size relative to 100 relative to its size to total\r\n         */\r\n        for (i = 0; i < this.contentItems.length; i++) {\r\n            this.contentItems[i].config[dimension] = (this.contentItems[i].config[dimension] / total) * 100;\r\n        }\r\n\r\n        this._respectMinItemWidth();\r\n    }\r\n\r\n    /**\r\n     * Adjusts the column widths to respect the dimensions minItemWidth if set.\r\n     * @returns {}\r\n     */\r\n    _respectMinItemWidth() {\r\n        var minItemWidth = this.layoutManager.config.dimensions ? (this.layoutManager.config.dimensions.minItemWidth || 0) : 0,\r\n            sizeData = null,\r\n            entriesOverMin = [],\r\n            totalOverMin = 0,\r\n            totalUnderMin = 0,\r\n            remainingWidth = 0,\r\n            itemSize = 0,\r\n            contentItem = null,\r\n            reducePercent,\r\n            reducedWidth,\r\n            allEntries = [],\r\n            entry;\r\n\r\n        if (this._isColumn || !minItemWidth || this.contentItems.length <= 1) {\r\n            return;\r\n        }\r\n\r\n        sizeData = this._calculateAbsoluteSizes();\r\n\r\n        /**\r\n         * Figure out how much we are under the min item size total and how much room we have to use.\r\n         */\r\n        for (var i = 0; i < this.contentItems.length; i++) {\r\n\r\n            contentItem = this.contentItems[i];\r\n            itemSize = sizeData.itemSizes[i];\r\n\r\n            if (itemSize < minItemWidth) {\r\n                totalUnderMin += minItemWidth - itemSize;\r\n                entry = {\r\n                    width: minItemWidth\r\n                };\r\n\r\n            } else {\r\n                totalOverMin += itemSize - minItemWidth;\r\n                entry = {\r\n                    width: itemSize\r\n                };\r\n                entriesOverMin.push(entry);\r\n            }\r\n\r\n            allEntries.push(entry);\r\n        }\r\n\r\n        /**\r\n         * If there is nothing under min, or there is not enough over to make up the difference, do nothing.\r\n         */\r\n        if (totalUnderMin === 0 || totalUnderMin > totalOverMin) {\r\n            return;\r\n        }\r\n\r\n        /**\r\n         * Evenly reduce all columns that are over the min item width to make up the difference.\r\n         */\r\n        reducePercent = totalUnderMin / totalOverMin;\r\n        remainingWidth = totalUnderMin;\r\n        for (i = 0; i < entriesOverMin.length; i++) {\r\n            entry = entriesOverMin[i];\r\n            reducedWidth = Math.round((entry.width - minItemWidth) * reducePercent);\r\n            remainingWidth -= reducedWidth;\r\n            entry.width -= reducedWidth;\r\n        }\r\n\r\n        /**\r\n         * Take anything remaining from the last item.\r\n         */\r\n        if (remainingWidth !== 0) {\r\n            allEntries[allEntries.length - 1].width -= remainingWidth;\r\n        }\r\n\r\n        /**\r\n         * Set every items size relative to 100 relative to its size to total\r\n         */\r\n        for (i = 0; i < this.contentItems.length; i++) {\r\n            this.contentItems[i].config.width = (allEntries[i].width / sizeData.totalWidth) * 100;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Instantiates a new Splitter, binds events to it and adds\r\n     * it to the array of splitters at the position specified as the index argument\r\n     *\r\n     * What it doesn't do though is append the splitter to the DOM\r\n     *\r\n     * @param   {Int} index The position of the splitter\r\n     *\r\n     * @returns {Splitter}\r\n     */\r\n    _createSplitter(index) {\r\n        var splitter;\r\n        splitter = new Splitter(this._isColumn, this._splitterSize, this._splitterGrabSize);\r\n        splitter.on('drag', fnBind(this._onSplitterDrag, this, [splitter]), this);\r\n        splitter.on('dragStop', fnBind(this._onSplitterDragStop, this, [splitter]), this);\r\n        splitter.on('dragStart', fnBind(this._onSplitterDragStart, this, [splitter]), this);\r\n        this._splitter.splice(index, 0, splitter);\r\n        return splitter;\r\n    }\r\n\r\n    /**\r\n     * Locates the instance of Splitter in the array of\r\n     * registered splitters and returns a map containing the contentItem\r\n     * before and after the splitters, both of which are affected if the\r\n     * splitter is moved\r\n     *\r\n     * @param   {Splitter} splitter\r\n     *\r\n     * @returns {Object} A map of contentItems that the splitter affects\r\n     */\r\n    _getItemsForSplitter(splitter) {\r\n        var index = indexOf(splitter, this._splitter);\r\n\r\n        return {\r\n            before: this.contentItems[index],\r\n            after: this.contentItems[index + 1]\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Gets docking information\r\n     * @private\r\n     */\r\n    _isDocked(index) {\r\n        if (typeof index == 'undefined') {\r\n            var count = 0;\r\n            for (var i = 0; i < this.contentItems.length; ++i)\r\n                if (this._isDocked(i))\r\n                    count++;\r\n            return count;\r\n        }\r\n        if (index < this.contentItems.length)\r\n            return this.contentItems[index]._docker && this.contentItems[index]._docker.docked;\r\n    }\r\n\r\n    /**\r\n     * Validate if row or column has ability to dock\r\n     * @private\r\n     */\r\n    _validateDocking(that) {\r\n        that = that || this;\r\n        var can = that.contentItems.length - that._isDocked() > 1;\r\n        for (var i = 0; i < that.contentItems.length; ++i)\r\n            if (that.contentItems[i] instanceof Stack) {\r\n                that.contentItems[i].header._setDockable(that._isDocked(i) || can);\r\n                that.contentItems[i].header._$setClosable(can);\r\n            }\r\n    }\r\n\r\n    /**\r\n     * Gets the minimum dimensions for the given item configuration array\r\n     * @param item\r\n     * @private\r\n     */\r\n    _getMinimumDimensions(arr) {\r\n        var minWidth = 0,\r\n            minHeight = 0;\r\n\r\n        for (var i = 0; i < arr.length; ++i) {\r\n            minWidth = Math.max(arr[i].minWidth || 0, minWidth);\r\n            minHeight = Math.max(arr[i].minHeight || 0, minHeight);\r\n        }\r\n\r\n        return {\r\n            horizontal: minWidth,\r\n            vertical: minHeight\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Invoked when a splitter's dragListener fires dragStart. Calculates the splitters\r\n     * movement area once (so that it doesn't need calculating on every mousemove event)\r\n     *\r\n     * @param   {Splitter} splitter\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _onSplitterDragStart(splitter) {\r\n        var items = this._getItemsForSplitter(splitter),\r\n            minSize = this.layoutManager.config.dimensions[this._isColumn ? 'minItemHeight' : 'minItemWidth'];\r\n\r\n        var beforeMinDim = this._getMinimumDimensions(items.before.config.content);\r\n        var beforeMinSize = this._isColumn ? beforeMinDim.vertical : beforeMinDim.horizontal;\r\n\r\n        var afterMinDim = this._getMinimumDimensions(items.after.config.content);\r\n        var afterMinSize = this._isColumn ? afterMinDim.vertical : afterMinDim.horizontal;\r\n\r\n        this._splitterPosition = 0;\r\n        this._splitterMinPosition = -1 * (items.before.element[this._dimension]() - (beforeMinSize || minSize));\r\n        this._splitterMaxPosition = items.after.element[this._dimension]() - (afterMinSize || minSize);\r\n    }\r\n\r\n    /**\r\n     * Invoked when a splitter's DragListener fires drag. Updates the splitters DOM position,\r\n     * but not the sizes of the elements the splitter controls in order to minimize resize events\r\n     *\r\n     * @param   {Splitter} splitter\r\n     * @param   {Int} offsetX  Relative pixel values to the splitters original position. Can be negative\r\n     * @param   {Int} offsetY  Relative pixel values to the splitters original position. Can be negative\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _onSplitterDrag(splitter, offsetX, offsetY) {\r\n        var offset = this._isColumn ? offsetY : offsetX;\r\n\r\n        if (offset > this._splitterMinPosition && offset < this._splitterMaxPosition) {\r\n            this._splitterPosition = offset;\r\n            splitter.element.css(this._isColumn ? 'top' : 'left', offset);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Invoked when a splitter's DragListener fires dragStop. Resets the splitters DOM position,\r\n     * and applies the new sizes to the elements before and after the splitter and their children\r\n     * on the next animation frame\r\n     *\r\n     * @param   {Splitter} splitter\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _onSplitterDragStop(splitter) {\r\n\r\n        var items = this._getItemsForSplitter(splitter),\r\n            sizeBefore = items.before.element[this._dimension](),\r\n            sizeAfter = items.after.element[this._dimension](),\r\n            splitterPositionInRange = (this._splitterPosition + sizeBefore) / (sizeBefore + sizeAfter),\r\n            totalRelativeSize = items.before.config[this._dimension] + items.after.config[this._dimension];\r\n\r\n        items.before.config[this._dimension] = splitterPositionInRange * totalRelativeSize;\r\n        items.after.config[this._dimension] = (1 - splitterPositionInRange) * totalRelativeSize;\r\n\r\n        splitter.element.css({\r\n            'top': 0,\r\n            'left': 0\r\n        });\r\n\r\n        animFrame(fnBind(this.callDownwards, this, ['setSize']));\r\n    }\r\n}\r\n","import AbstractContentItem from '../items/AbstractContentItem'\r\nimport RowOrColumn from '../items/RowOrColumn'\r\nimport $ from 'jquery'\r\n\r\n\r\nexport default class Root extends AbstractContentItem {\r\n    constructor(layoutManager, config, containerElement) {\r\n      \r\n        super(layoutManager, config, null);\r\n\r\n        this.isRoot = true;\r\n        this.type = 'root';\r\n        this.element = $('<div class=\"lm_goldenlayout lm_item lm_root\"></div>');\r\n        this.childElementContainer = this.element;\r\n        this._containerElement = containerElement;\r\n        this._containerElement.append(this.element);\r\n    }\r\n\r\n    addChild(contentItem) {\r\n        if (this.contentItems.length > 0) {\r\n            throw new Error('Root node can only have a single child');\r\n        }\r\n\r\n        contentItem = this.layoutManager._$normalizeContentItem(contentItem, this);\r\n        this.childElementContainer.append(contentItem.element);\r\n        AbstractContentItem.prototype.addChild.call(this, contentItem);\r\n\r\n        this.callDownwards('setSize');\r\n        this.emitBubblingEvent('stateChanged');\r\n    }\r\n\r\n    setSize(width, height) {\r\n        width = (typeof width === 'undefined') ? this._containerElement.width() : width;\r\n        height = (typeof height === 'undefined') ? this._containerElement.height() : height;\r\n\r\n        this.element.width(width);\r\n        this.element.height(height);\r\n\r\n        /*\r\n         * Root can be empty\r\n         */\r\n        if (this.contentItems[0]) {\r\n            this.contentItems[0].element.width(width);\r\n            this.contentItems[0].element.height(height);\r\n        }\r\n    }\r\n\r\n    _$highlightDropZone(x, y, area) {\r\n        this.layoutManager.tabDropPlaceholder.remove();\r\n        AbstractContentItem.prototype._$highlightDropZone.apply(this, arguments);\r\n    }\r\n\r\n    _$onDrop(contentItem, area) {\r\n        var stack;\r\n\r\n        if (contentItem.isComponent) {\r\n            stack = this.layoutManager.createContentItem({\r\n                type: 'stack',\r\n                header: contentItem.config.header || {}\r\n            }, this);\r\n            stack._$init();\r\n            stack.addChild(contentItem);\r\n            contentItem = stack;\r\n        }\r\n\r\n        if (!this.contentItems.length) {\r\n            this.addChild(contentItem);\r\n        } else {\r\n            /*\r\n             * If the contentItem that's being dropped is not dropped on a Stack (cases which just passed above and \r\n             * which would wrap the contentItem in a Stack) we need to check whether contentItem is a RowOrColumn.\r\n             * If it is, we need to re-wrap it in a Stack like it was when it was dragged by its Tab (it was dragged!).\r\n             */\r\n            if(contentItem.config.type === 'row' || contentItem.config.type === 'column'){\r\n                stack = this.layoutManager.createContentItem({\r\n                    type: 'stack'\r\n                }, this)\r\n                stack.addChild(contentItem)\r\n                contentItem = stack\r\n            }\r\n\r\n            var type = area.side[0] == 'x' ? 'row' : 'column';\r\n            var dimension = area.side[0] == 'x' ? 'width' : 'height';\r\n            var insertBefore = area.side[1] == '2';\r\n            var column = this.contentItems[0];\r\n            if (!(column instanceof RowOrColumn) || column.type != type) {\r\n                var rowOrColumn = this.layoutManager.createContentItem({\r\n                    type: type\r\n                }, this);\r\n                this.replaceChild(column, rowOrColumn);\r\n                rowOrColumn.addChild(contentItem, insertBefore ? 0 : undefined, true);\r\n                rowOrColumn.addChild(column, insertBefore ? undefined : 0, true);\r\n                column.config[dimension] = 50;\r\n                contentItem.config[dimension] = 50;\r\n                rowOrColumn.callDownwards('setSize');\r\n            } else {\r\n                var sibbling = column.contentItems[insertBefore ? 0 : column.contentItems.length - 1]\r\n                column.addChild(contentItem, insertBefore ? 0 : undefined, true);\r\n                sibbling.config[dimension] *= 0.5;\r\n                contentItem.config[dimension] = sibbling.config[dimension];\r\n                column.callDownwards('setSize');\r\n            }\r\n        }\r\n    }\r\n}\r\n","import EventEmitter from '../utils/EventEmitter'\r\nimport $ from 'jquery'\r\n\r\nexport default class ItemContainer extends EventEmitter {\r\n    constructor(config, parent, layoutManager) {\r\n\r\n        super();\r\n\r\n        this.width = null;\r\n        this.height = null;\r\n        this.title = config.componentName;\r\n        this.parent = parent;\r\n        this.layoutManager = layoutManager;\r\n        this.isHidden = false;\r\n\r\n        this._config = config;\r\n        this._element = $([\r\n            '<div class=\"lm_item_container\">',\r\n            '<div class=\"lm_content\"></div>',\r\n            '</div>'\r\n        ].join(''));\r\n\r\n        this._contentElement = this._element.find('.lm_content');\r\n    }\r\n\r\n\r\n    /**\r\n     * Get the inner DOM element the container's content\r\n     * is intended to live in\r\n     *\r\n     * @returns {DOM element}\r\n     */\r\n    getElement() {\r\n        return this._contentElement;\r\n    }\r\n\r\n\r\n    /**\r\n     * Hide the container. Notifies the containers content first\r\n     * and then hides the DOM node. If the container is already hidden\r\n     * this should have no effect\r\n     *\r\n     * @returns {void}\r\n     */\r\n    hide() {\r\n        this.emit('hide');\r\n        this.isHidden = true;\r\n        this._element.hide();\r\n    }\r\n\r\n\r\n    /**\r\n     * Shows a previously hidden container. Notifies the\r\n     * containers content first and then shows the DOM element.\r\n     * If the container is already visible this has no effect.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    show() {\r\n        this.emit('show');\r\n        this.isHidden = false;\r\n        this._element.show();\r\n        // call shown only if the container has a valid size\r\n        if (this.height != 0 || this.width != 0) {\r\n            this.emit('shown');\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Set the size from within the container. Traverses up\r\n     * the item tree until it finds a row or column element\r\n     * and resizes its items accordingly.\r\n     *\r\n     * If this container isn't a descendant of a row or column\r\n     * it returns false\r\n     * @todo  Rework!!!\r\n     * @param {Number} width  The new width in pixel\r\n     * @param {Number} height The new height in pixel\r\n     *\r\n     * @returns {Boolean} resizeSuccesful\r\n     */\r\n    setSize(width, height) {\r\n        var rowOrColumn = this.parent,\r\n            rowOrColumnChild = this,\r\n            totalPixel,\r\n            percentage,\r\n            direction,\r\n            newSize,\r\n            delta,\r\n            i;\r\n\r\n        while (!rowOrColumn.isColumn && !rowOrColumn.isRow) {\r\n            rowOrColumnChild = rowOrColumn;\r\n            rowOrColumn = rowOrColumn.parent;\r\n\r\n\r\n            /**\r\n             * No row or column has been found\r\n             */\r\n            if (rowOrColumn.isRoot) {\r\n                return false;\r\n            }\r\n        }\r\n\r\n        direction = rowOrColumn.isColumn ? \"height\" : \"width\";\r\n        newSize = direction === \"height\" ? height : width;\r\n\r\n        totalPixel = this[direction] * (1 / (rowOrColumnChild.config[direction] / 100));\r\n        percentage = (newSize / totalPixel) * 100;\r\n        delta = (rowOrColumnChild.config[direction] - percentage) / (rowOrColumn.contentItems.length - 1);\r\n\r\n        for (i = 0; i < rowOrColumn.contentItems.length; i++) {\r\n            if (rowOrColumn.contentItems[i] === rowOrColumnChild) {\r\n                rowOrColumn.contentItems[i].config[direction] = percentage;\r\n            } else {\r\n                rowOrColumn.contentItems[i].config[direction] += delta;\r\n            }\r\n        }\r\n\r\n        rowOrColumn.callDownwards('setSize');\r\n\r\n        return true;\r\n    }\r\n\r\n\r\n    /**\r\n     * Closes the container if it is closable. Can be called by\r\n     * both the component within at as well as the contentItem containing\r\n     * it. Emits a close event before the container itself is closed.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    close() {\r\n        if (this._config.isClosable) {\r\n            this.emit('close');\r\n            this.parent.close();\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Returns the current state object\r\n     *\r\n     * @returns {Object} state\r\n     */\r\n    getState() {\r\n        return this._config.componentState;\r\n    }\r\n\r\n\r\n    /**\r\n     * Merges the provided state into the current one\r\n     *\r\n     * @param   {Object} state\r\n     *\r\n     * @returns {void}\r\n     */\r\n    extendState(state) {\r\n        this.setState($.extend(true, this.getState(), state));\r\n    }\r\n\r\n\r\n    /**\r\n     * Notifies the layout manager of a stateupdate\r\n     *\r\n     * @param {serialisable} state\r\n     */\r\n    setState(state) {\r\n        this._config.componentState = state;\r\n        this.parent.emitBubblingEvent('stateChanged');\r\n    }\r\n\r\n\r\n    /**\r\n     * Set's the components title\r\n     *\r\n     * @param {String} title\r\n     */\r\n    setTitle(title) {\r\n        this.parent.setTitle(title);\r\n    }\r\n\r\n\r\n    /**\r\n     * Set's the containers size. Called by the container's component.\r\n     * To set the size programmatically from within the container please\r\n     * use the public setSize method\r\n     *\r\n     * @param {[Int]} width  in px\r\n     * @param {[Int]} height in px\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _$setSize(width, height) {\r\n        if (width !== this.width || height !== this.height) {\r\n            this.width = width;\r\n            this.height = height;\r\n            $.zepto ? this._contentElement.width(width) : this._contentElement.outerWidth(width);\r\n            $.zepto ? this._contentElement.height(height) : this._contentElement.outerHeight(height);\r\n            this.emit('resize');\r\n        }\r\n    }\r\n}\r\n","import $ from 'jquery'\r\n/**\r\n * A specialised GoldenLayout component that binds GoldenLayout container\r\n * lifecycle events to react components\r\n *\r\n * @constructor\r\n *\r\n * @param {ItemContainer} container\r\n * @param {Object} state state is not required for react components\r\n */\r\n\r\n\r\nexport default class ReactComponentHandler {\r\n    constructor(container, state) {\r\n        this._reactComponent = null;\r\n        this._originalComponentWillUpdate = null;\r\n        this._container = container;\r\n        this._initialState = state;\r\n        this._reactClass = this._getReactClass();\r\n        this._container.on('open', this._render, this);\r\n        this._container.on('destroy', this._destroy, this);\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * Creates the react class and component and hydrates it with\r\n     * the initial state - if one is present\r\n     *\r\n     * By default, react's getInitialState will be used\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _render() {\r\n        ReactDOM.render(this._getReactComponent(), this._container.getElement()[0]);\r\n    }\r\n\r\n    /**\r\n     * Fired by react when the component is created.  Also fired upon destruction (where component is null).\r\n     * <p>\r\n     * Note: This callback is used instead of the return from `ReactDOM.render` because\r\n     *\t   of https://github.com/facebook/react/issues/10309.\r\n     * </p>\r\n     *\r\n     * @private\r\n     * @arg {React.Ref} component The component instance created by the `ReactDOM.render` call in the `_render` method.\r\n     * @returns {void}\r\n     */\r\n    _gotReactComponent(component) {\r\n        if (component !== null) {\r\n            this._reactComponent = component;\r\n            this._originalComponentWillUpdate = this._reactComponent.componentWillUpdate || function() {};\r\n            this._reactComponent.componentWillUpdate = this._onUpdate.bind( this );\r\n            if( this._container.getState() ) {\r\n                this._reactComponent.setState( this._container.getState() );\r\n            }\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Removes the component from the DOM and thus invokes React's unmount lifecycle\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _destroy() {\r\n        ReactDOM.unmountComponentAtNode(this._container.getElement()[0]);\r\n        this._container.off('open', this._render, this);\r\n        this._container.off('destroy', this._destroy, this);\r\n    }\r\n\r\n    /**\r\n     * Hooks into React's state management and applies the componentstate\r\n     * to GoldenLayout\r\n     *\r\n     * @private\r\n     * @returns {void}\r\n     */\r\n    _onUpdate(nextProps, nextState) {\r\n        this._container.setState(nextState);\r\n        this._originalComponentWillUpdate.call(this._reactComponent, nextProps, nextState);\r\n    }\r\n\r\n    /**\r\n     * Retrieves the react class from GoldenLayout's registry\r\n     *\r\n     * @private\r\n     * @returns {React.Class}\r\n     */\r\n    _getReactClass() {\r\n        var componentName = this._container._config.component;\r\n        var reactClass;\r\n\r\n        if (!componentName) {\r\n            throw new Error('No react component name. type: react-component needs a field `component`');\r\n        }\r\n\r\n        reactClass = this._container.layoutManager.getComponent(this._container._config);\r\n\r\n        if (!reactClass) {\r\n            throw new Error('React component \"' + componentName + '\" not found. ' +\r\n                'Please register all components with GoldenLayout using `registerComponent(name, component)`');\r\n        }\r\n\r\n        return reactClass;\r\n    }\r\n\r\n    /**\r\n     * Copies and extends the properties array and returns the React element\r\n     *\r\n     * @private\r\n     * @returns {React.Element}\r\n     */\r\n    _getReactComponent() {\r\n        var defaultProps = {\r\n            glEventHub: this._container.layoutManager.eventHub,\r\n            glContainer: this._container,\r\n            ref: this._gotReactComponent.bind(this),\r\n        };\r\n        var props = $.extend(defaultProps, this._container._config.props);\r\n        return React.createElement(this._reactClass, props);\r\n    }\r\n}\r\n","import AbstractContentItem from '../items/AbstractContentItem'\r\nimport ItemContainer from '../container/ItemContainer'\r\nimport ReactComponentHandler from '../utils/ReactComponentHandler'\r\nimport $ from 'jquery'\r\n/**\r\n * @param {[type]} layoutManager [description]\r\n * @param {[type]} config      [description]\r\n * @param {[type]} parent        [description]\r\n */\r\n\r\n\r\nexport default class Component extends AbstractContentItem {\r\n    constructor(layoutManager, config, parent) {\r\n\r\n        super(layoutManager, config, parent);\r\n\r\n        var ComponentConstructor = layoutManager.isReactConfig(config) ? ReactComponentHandler : layoutManager.getComponent(config),\r\n            componentConfig = $.extend(true, {}, this.config.componentState || {});\r\n\r\n        componentConfig.componentName = this.config.componentName;\r\n        this.componentName = this.config.componentName;\r\n\r\n        if (this.config.title === '') {\r\n            this.config.title = this.config.componentName;\r\n        }\r\n\r\n        this.isComponent = true;\r\n        this.container = new ItemContainer(this.config, this, layoutManager);\r\n        this.instance = new ComponentConstructor(this.container, componentConfig);\r\n        this.element = this.container._element;\r\n    }\r\n\r\n    close() {\r\n        this.parent.removeChild(this);\r\n    }\r\n\r\n    setSize() {\r\n        if (this.element.css('display') !== 'none') {\r\n            // Do not update size of hidden components to prevent unwanted reflows\r\n            this.container._$setSize(this.element.width(), this.element.height());\r\n        }\r\n    }\r\n\r\n    _$init() {\r\n        AbstractContentItem.prototype._$init.call(this);\r\n        this.container.emit('open');\r\n    }\r\n\r\n    _$hide() {\r\n        this.container.hide();\r\n        AbstractContentItem.prototype._$hide.call(this);\r\n    }\r\n\r\n    _$show() {\r\n        this.container.show();\r\n        AbstractContentItem.prototype._$show.call(this);\r\n    }\r\n\r\n    _$shown() {\r\n        this.container.shown();\r\n        AbstractContentItem.prototype._$shown.call(this);\r\n    }\r\n\r\n    _$destroy() {\r\n        this.container.emit('destroy', this);\r\n        AbstractContentItem.prototype._$destroy.call(this);\r\n    }\r\n\r\n    /**\r\n     * Dragging onto a component directly is not an option\r\n     *\r\n     * @returns null\r\n     */\r\n    _$getArea() {\r\n        return null;\r\n    }\r\n}\r\n","import EventEmitter from '../utils/EventEmitter'\r\nimport ConfigMinifier from '../utils/ConfigMinifier'\r\nimport {\r\n    fnBind,\r\n    getUniqueId,\r\n} from '../utils/utils'\r\nimport $ from 'jquery'\r\n\r\n/**\r\n * Pops a content item out into a new browser window.\r\n * This is achieved by\r\n *\r\n *    - Creating a new configuration with the content item as root element\r\n *    - Serializing and minifying the configuration\r\n *    - Opening the current window's URL with the configuration as a GET parameter\r\n *    - GoldenLayout when opened in the new window will look for the GET parameter\r\n *      and use it instead of the provided configuration\r\n *\r\n * @param {Object} config GoldenLayout item config\r\n * @param {Object} dimensions A map with width, height, top and left\r\n * @param {String} parentId The id of the element the item will be appended to on popIn\r\n * @param {Number} indexInParent The position of this element within its parent\r\n * @param {lm.LayoutManager} layoutManager\r\n */\r\n\r\n\r\nexport default class BrowserPopout extends EventEmitter {\r\n    constructor(config, dimensions, parentId, indexInParent, layoutManager) {\r\n\r\n        super();\r\n        \r\n        this.isInitialised = false;\r\n\r\n        this._config = config;\r\n        this._dimensions = dimensions;\r\n        this._parentId = parentId;\r\n        this._indexInParent = indexInParent;\r\n        this._layoutManager = layoutManager;\r\n        this._popoutWindow = null;\r\n        this._id = null;\r\n        this._createWindow();\r\n    }\r\n\r\n    toConfig() {\r\n        if (this.isInitialised === false) {\r\n            throw new Error('Can\\'t create config, layout not yet initialised');\r\n        }\r\n        return {\r\n            dimensions: {\r\n                width: this.getGlInstance().width,\r\n                height: this.getGlInstance().height,\r\n                left: this._popoutWindow.screenX || this._popoutWindow.screenLeft,\r\n                top: this._popoutWindow.screenY || this._popoutWindow.screenTop\r\n            },\r\n            content: this.getGlInstance().toConfig().content,\r\n            parentId: this._parentId,\r\n            indexInParent: this._indexInParent\r\n        };\r\n    }\r\n\r\n    getGlInstance() {\r\n        return this._popoutWindow.__glInstance;\r\n    }\r\n\r\n    getWindow() {\r\n        return this._popoutWindow;\r\n    }\r\n\r\n    close() {\r\n        if (this.getGlInstance()) {\r\n            this.getGlInstance()._$closeWindow();\r\n        } else {\r\n            try {\r\n                this.getWindow().close();\r\n            } catch (e) {\r\n                //\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the popped out item to its original position. If the original\r\n     * parent isn't available anymore it falls back to the layout's topmost element\r\n     */\r\n    popIn() {\r\n        var childConfig,\r\n            parentItem,\r\n            index = this._indexInParent;\r\n\r\n        if (this._parentId) {\r\n\r\n            /*\r\n             * The $.extend call seems a bit pointless, but it's crucial to\r\n             * copy the config returned by this.getGlInstance().toConfig()\r\n             * onto a new object. Internet Explorer keeps the references\r\n             * to objects on the child window, resulting in the following error\r\n             * once the child window is closed:\r\n             *\r\n             * The callee (server [not server application]) is not available and disappeared\r\n             */\r\n            childConfig = $.extend(true, {}, this.getGlInstance().toConfig()).content[0];\r\n            parentItem = this._layoutManager.root.getItemsById(this._parentId)[0];\r\n\r\n            /*\r\n             * Fallback if parentItem is not available. Either add it to the topmost\r\n             * item or make it the topmost item if the layout is empty\r\n             */\r\n            if (!parentItem) {\r\n                if (this._layoutManager.root.contentItems.length > 0) {\r\n                    parentItem = this._layoutManager.root.contentItems[0];\r\n                } else {\r\n                    parentItem = this._layoutManager.root;\r\n                }\r\n                index = 0;\r\n            }\r\n        }\r\n\r\n        parentItem.addChild(childConfig, this._indexInParent);\r\n        this.close();\r\n    }\r\n\r\n    /**\r\n     * Creates the URL and window parameter\r\n     * and opens a new window\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _createWindow() {\r\n        var checkReadyInterval,\r\n            url = this._createUrl(),\r\n\r\n            /**\r\n             * Bogus title to prevent re-usage of existing window with the\r\n             * same title. The actual title will be set by the new window's\r\n             * GoldenLayout instance if it detects that it is in subWindowMode\r\n             */\r\n            title = Math.floor(Math.random() * 1000000).toString(36),\r\n\r\n            /**\r\n             * The options as used in the window.open string\r\n             */\r\n            options = this._serializeWindowOptions({\r\n                width: this._dimensions.width,\r\n                height: this._dimensions.height,\r\n                innerWidth: this._dimensions.width,\r\n                innerHeight: this._dimensions.height,\r\n                menubar: 'no',\r\n                toolbar: 'no',\r\n                location: 'no',\r\n                personalbar: 'no',\r\n                resizable: 'yes',\r\n                scrollbars: 'no',\r\n                status: 'no'\r\n            });\r\n\r\n        this._popoutWindow = window.open(url, title, options);\r\n\r\n        if (!this._popoutWindow) {\r\n            if (this._layoutManager.config.settings.blockedPopoutsThrowError === true) {\r\n                var error = new Error('Popout blocked');\r\n                error.type = 'popoutBlocked';\r\n                throw error;\r\n            } else {\r\n                return;\r\n            }\r\n        }\r\n\r\n        $(this._popoutWindow)\r\n            .on('load', fnBind(this._positionWindow, this))\r\n            .on('unload beforeunload', fnBind(this._onClose, this));\r\n\r\n        /**\r\n         * Polling the childwindow to find out if GoldenLayout has been initialised\r\n         * doesn't seem optimal, but the alternatives - adding a callback to the parent\r\n         * window or raising an event on the window object - both would introduce knowledge\r\n         * about the parent to the child window which we'd rather avoid\r\n         */\r\n        checkReadyInterval = setInterval(fnBind(function() {\r\n            if (this._popoutWindow.__glInstance && this._popoutWindow.__glInstance.isInitialised) {\r\n                this._onInitialised();\r\n                clearInterval(checkReadyInterval);\r\n            }\r\n        }, this), 10);\r\n    }\r\n\r\n    /**\r\n     * Serialises a map of key:values to a window options string\r\n     *\r\n     * @param   {Object} windowOptions\r\n     *\r\n     * @returns {String} serialised window options\r\n     */\r\n    _serializeWindowOptions(windowOptions) {\r\n        var windowOptionsString = [],\r\n            key;\r\n\r\n        for (key in windowOptions) {\r\n            windowOptionsString.push(key + '=' + windowOptions[key]);\r\n        }\r\n\r\n        return windowOptionsString.join(',');\r\n    }\r\n\r\n    /**\r\n     * Creates the URL for the new window, including the\r\n     * config GET parameter\r\n     *\r\n     * @returns {String} URL\r\n     */\r\n    _createUrl() {\r\n        var config = {\r\n                content: this._config\r\n            },\r\n            storageKey = 'gl-window-config-' + getUniqueId(),\r\n            urlParts;\r\n\r\n        config = (new ConfigMinifier()).minifyConfig(config);\r\n\r\n        try {\r\n            localStorage.setItem(storageKey, JSON.stringify(config));\r\n        } catch (e) {\r\n            throw new Error('Error while writing to localStorage ' + e.toString());\r\n        }\r\n\r\n        urlParts = document.location.href.split('?');\r\n\r\n        // URL doesn't contain GET-parameters\r\n        if (urlParts.length === 1) {\r\n            return urlParts[0] + '?gl-window=' + storageKey;\r\n\r\n            // URL contains GET-parameters\r\n        } else {\r\n            return document.location.href + '&gl-window=' + storageKey;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Move the newly created window roughly to\r\n     * where the component used to be.\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _positionWindow() {\r\n        this._popoutWindow.moveTo(this._dimensions.left, this._dimensions.top);\r\n        this._popoutWindow.focus();\r\n    }\r\n\r\n    /**\r\n     * Callback when the new window is opened and the GoldenLayout instance\r\n     * within it is initialised\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _onInitialised() {\r\n        this.isInitialised = true;\r\n        this.getGlInstance().on('popIn', this.popIn, this);\r\n        this.emit('initialised');\r\n    }\r\n\r\n    /**\r\n     * Invoked 50ms after the window unload event\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _onClose() {\r\n        setTimeout(fnBind(this.emit, this, ['closed']), 50);\r\n    }\r\n}\r\n","import DragListener from '../utils/DragListener'\r\nimport DragProxy from '../controls/DragProxy'\r\nimport {\r\n    isFunction\r\n} from '../utils/utils'\r\nimport $ from 'jquery'\r\n\r\n/**\r\n * Allows for any DOM item to create a component on drag\r\n * start tobe dragged into the Layout\r\n *\r\n * @param {jQuery element} element\r\n * @param {Object} itemConfig the configuration for the contentItem that will be created\r\n * @param {LayoutManager} layoutManager\r\n *\r\n * @constructor\r\n */\r\nexport default class DragSource {\r\n    constructor(element, itemConfig, layoutManager) {\r\n        this._element = element;\r\n        this._itemConfig = itemConfig;\r\n        this._layoutManager = layoutManager;\r\n        this._dragListener = null;\r\n\r\n        this._createDragListener();\r\n    }\r\n\r\n\t/**\r\n\t * Disposes of the drag listeners so the drag source is not usable any more.\r\n\t *\r\n\t * @returns {void}\r\n\t */\r\n\tdestroy() {\r\n\t\tthis._removeDragListener();\r\n    }\r\n    \r\n    /**\r\n     * Called initially and after every drag\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _createDragListener() {\r\n        this._removeDragListener();\r\n\r\n        this._dragListener = new DragListener(this._element);\r\n        this._dragListener.on('dragStart', this._onDragStart, this);\r\n        this._dragListener.on('dragStop', this._createDragListener, this);\r\n    }\r\n\r\n    /**\r\n     * Callback for the DragListener's dragStart event\r\n     *\r\n     * @param   {int} x the x position of the mouse on dragStart\r\n     * @param   {int} y the x position of the mouse on dragStart\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _onDragStart(x, y) {\r\n        var itemConfig = this._itemConfig;\r\n        if (isFunction(itemConfig)) {\r\n            itemConfig = itemConfig();\r\n        }\r\n        var contentItem = this._layoutManager._$normalizeContentItem($.extend(true, {}, itemConfig)),\r\n            dragProxy = new DragProxy(x, y, this._dragListener, this._layoutManager, contentItem, null);\r\n\r\n        this._layoutManager.transitionIndicator.transitionElements(this._element, dragProxy.element);\r\n    }\r\n\r\n    /**\r\n\t * Called after every drag and when the drag source is being disposed of.\r\n\t *\r\n\t * @returns {void}\r\n\t */\r\n\t_removeDragListener() {\r\n\t\tif( this._dragListener !== null ) {\r\n\t\t\tthis._dragListener.destroy();\r\n\t\t}\r\n\t}\r\n}\r\n","import $ from 'jquery'\r\n\r\nconst _template = '<div class=\"lm_dropTargetIndicator\"><div class=\"lm_inner\"></div></div>'\r\n\r\n\r\nexport default class DropTargetIndicator {\r\n\r\n    constructor() {\r\n        this.element = $(_template);\r\n        $(document.body).append(this.element);\r\n    }\r\n\r\n    destroy() {\r\n        this.element.remove();\r\n    }\r\n\r\n    highlight(x1, y1, x2, y2) {\r\n        this.highlightArea({\r\n            x1: x1,\r\n            y1: y1,\r\n            x2: x2,\r\n            y2: y2\r\n        });\r\n    }\r\n\r\n    highlightArea(area) {\r\n        this.element.css({\r\n            left: area.x1,\r\n            top: area.y1,\r\n            width: area.x2 - area.x1,\r\n            height: area.y2 - area.y1\r\n        }).show();\r\n    }\r\n\r\n    hide() {\r\n        this.element.hide();\r\n    }\r\n}\r\n","import {\r\n    now,\r\n    animFrame,\r\n    fnBind\r\n} from '../utils/utils'\r\nimport $ from 'jquery'\r\n\r\n\r\nexport default class TransitionIndicator {\r\n    constructor() {\r\n        this._element = $('<div class=\"lm_transition_indicator\"></div>');\r\n        $(document.body).append(this._element);\r\n\r\n        this._toElement = null;\r\n        this._fromDimensions = null;\r\n        this._totalAnimationDuration = 200;\r\n        this._animationStartTime = null;\r\n    }\r\n\r\n    destroy() {\r\n        this._element.remove();\r\n    }\r\n\r\n    transitionElements(fromElement, toElement) {\r\n        /**\r\n         * TODO - This is not quite as cool as expected. Review.\r\n         */\r\n        return;\r\n        // this._toElement = toElement;\r\n        // this._animationStartTime = now();\r\n        // this._fromDimensions = this._measure(fromElement);\r\n        // this._fromDimensions.opacity = 0.8;\r\n        // this._element.show().css(this._fromDimensions);\r\n        // animFrame(fnBind(this._nextAnimationFrame, this));\r\n    }\r\n\r\n    _nextAnimationFrame() {\r\n        var toDimensions = this._measure(this._toElement),\r\n            animationProgress = (now() - this._animationStartTime) / this._totalAnimationDuration,\r\n            currentFrameStyles = {},\r\n            cssProperty;\r\n\r\n        if (animationProgress >= 1) {\r\n            this._element.hide();\r\n            return;\r\n        }\r\n\r\n        toDimensions.opacity = 0;\r\n\r\n        for (cssProperty in this._fromDimensions) {\r\n            currentFrameStyles[cssProperty] = this._fromDimensions[cssProperty] +\r\n                (toDimensions[cssProperty] - this._fromDimensions[cssProperty]) *\r\n                animationProgress;\r\n        }\r\n\r\n        this._element.css(currentFrameStyles);\r\n        animFrame(fnBind(this._nextAnimationFrame, this));\r\n    }\r\n\r\n    _measure(element) {\r\n        var offset = element.offset();\r\n\r\n        return {\r\n            left: offset.left,\r\n            top: offset.top,\r\n            width: element.outerWidth(),\r\n            height: element.outerHeight()\r\n        };\r\n    }\r\n}\r\n","const defaultConfig = {\r\n    openPopouts: [],\r\n    settings: {\r\n        hasHeaders: true,\r\n        constrainDragToContainer: true,\r\n        reorderEnabled: true,\r\n        selectionEnabled: false,\r\n        popoutWholeStack: false,\r\n        blockedPopoutsThrowError: true,\r\n        closePopoutsOnUnload: true,\r\n        showPopoutIcon: true,\r\n        showMaximiseIcon: true,\r\n        showCloseIcon: true,\r\n        responsiveMode: 'onload', // Can be onload, always, or none.\r\n        tabOverlapAllowance: 0, // maximum pixel overlap per tab\r\n        reorderOnTabMenuClick: true,\r\n        tabControlOffset: 10\r\n    },\r\n    dimensions: {\r\n        borderWidth: 5,\r\n        borderGrabWidth: 15,\r\n        minItemHeight: 10,\r\n        minItemWidth: 10,\r\n        headerHeight: 20,\r\n        dragProxyWidth: 300,\r\n        dragProxyHeight: 200\r\n    },\r\n    labels: {\r\n        close: 'close',\r\n        maximise: 'maximise',\r\n        minimise: 'minimise',\r\n        popout: 'open in new window',\r\n        popin: 'pop in',\r\n        tabDropdown: 'additional tabs'\r\n    }\r\n}\r\n\r\nexport default defaultConfig\r\n","import EventEmitter from './utils/EventEmitter'\r\nimport ConfigMinifier from './utils/ConfigMinifier'\r\nimport EventHub from './utils/EventHub'\r\n\r\nimport Root from './items/Root'\r\nimport RowOrColumn from './items/RowOrColumn'\r\nimport Stack from './items/Stack'\r\nimport Component from './items/Component'\r\nimport AbstractContentItem from './items/AbstractContentItem'\r\n\r\nimport BrowserPopout from './controls/BrowserPopout'\r\nimport DragSource from './controls/DragSource'\r\nimport DropTargetIndicator from './controls/DropTargetIndicator'\r\nimport TransitionIndicator from './controls/TransitionIndicator'\r\n\r\nimport ConfigurationError from './errors/ConfigurationError'\r\nimport defaultConfig from './config/defaultConfig'\r\n\r\nimport {\r\n    fnBind,\r\n    objectKeys,\r\n    copy,\r\n    getUniqueId,\r\n    indexOf,\r\n    isFunction,\r\n    stripTags,\r\n    getQueryStringParam\r\n} from './utils/utils'\r\n\r\nimport $ from 'jquery'\r\n\r\nexport const REACT_COMPONENT_ID = 'lm-react-component'\r\n\r\n/**\r\n * The main class that will be exposed as GoldenLayout.\r\n *\r\n * @public\r\n * @constructor\r\n * @param {GoldenLayout config} config\r\n * @param {[DOM element container]} container Can be a jQuery selector string or a Dom element. Defaults to body\r\n *\r\n * @returns {VOID}\r\n */\r\n\r\n\r\nexport default class LayoutManager extends EventEmitter {\r\n    constructor(config, container) {        \r\n        super();\r\n\r\n        this.isInitialised = false;\r\n        this._isFullPage = false;\r\n        this._resizeTimeoutId = null;\r\n        this._components = {};\r\n        this._itemAreas = [];\r\n        this._resizeFunction = fnBind(this._onResize, this);\r\n        this._unloadFunction = fnBind(this._onUnload, this);\r\n        this._maximisedItem = null;\r\n        this._maximisePlaceholder = $('<div class=\"lm_maximise_place\"></div>');\r\n        this._creationTimeoutPassed = false;\r\n        this._subWindowsCreated = false;\r\n        this._dragSources = [];\r\n        this._updatingColumnsResponsive = false;\r\n        this._firstLoad = true;\r\n\r\n        this.width = null;\r\n        this.height = null;\r\n        this.root = null;\r\n        this.openPopouts = [];\r\n        this.selectedItem = null;\r\n        this.isSubWindow = false;\r\n        this.eventHub = new EventHub(this);\r\n        this.config = this._createConfig(config);\r\n        this.container = container;\r\n        this.dropTargetIndicator = null;\r\n        this.transitionIndicator = null;\r\n        this.tabDropPlaceholder = $('<div class=\"lm_drop_tab_placeholder\"></div>');\r\n\r\n        if (this.isSubWindow === true) {\r\n            $('body').css('visibility', 'hidden');\r\n        }\r\n\r\n        this._typeToItem = {\r\n            'column': fnBind(RowOrColumn, this, [true]),\r\n            'row': fnBind(RowOrColumn, this, [false]),\r\n            'stack': Stack,\r\n            'component': Component\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Takes a GoldenLayout configuration object and\r\n     * replaces its keys and values recursively with\r\n     * one letter codes\r\n     *\r\n     * @static\r\n     * @public\r\n     * @param   {Object} config A GoldenLayout config object\r\n     *\r\n     * @returns {Object} minified config\r\n     */\r\n    minifyConfig(config) {\r\n        return (new ConfigMinifier()).minifyConfig(config);\r\n    }\r\n\r\n    /**\r\n     * Takes a configuration Object that was previously minified\r\n     * using minifyConfig and returns its original version\r\n     *\r\n     * @static\r\n     * @public\r\n     * @param   {Object} minifiedConfig\r\n     *\r\n     * @returns {Object} the original configuration\r\n     */\r\n    unminifyConfig(config) {\r\n        return (new ConfigMinifier()).unminifyConfig(config);\r\n    }\r\n\r\n\r\n    /**\r\n     * Register a component with the layout manager. If a configuration node\r\n     * of type component is reached it will look up componentName and create the\r\n     * associated component\r\n     *\r\n     *  {\r\n     *    type: \"component\",\r\n     *    componentName: \"EquityNewsFeed\",\r\n     *    componentState: { \"feedTopic\": \"us-bluechips\" }\r\n     *  }\r\n     *\r\n     * @public\r\n     * @param   {String} name\r\n     * @param   {Function} constructor\r\n     *\r\n     * @returns {void}\r\n     */\r\n    registerComponent(name, constructor) {\r\n        if (typeof constructor !== 'function') {\r\n            throw new Error('Please register a constructor function');\r\n        }\r\n\r\n        if (this._components[name] !== undefined) {\r\n            throw new Error('Component ' + name + ' is already registered');\r\n        }\r\n\r\n        this._components[name] = constructor;\r\n    }\r\n\r\n    /**\r\n     * Register a component function with the layout manager. This function should\r\n     * return a constructor for a component based on a config.  If undefined is returned, \r\n     * and no component has been registered under that name using registerComponent, an \r\n     * error will be thrown.\r\n     *\r\n     * @public\r\n     * @param   {Function} callback\r\n     *\r\n     * @returns {void}\r\n     */\r\n    registerComponentFunction(callback) {\r\n        if (typeof callback !== 'function') {\r\n            throw new Error('Please register a callback function');\r\n        }\r\n\r\n        if (this._componentFunction !== undefined) {\r\n            console.warn('Multiple component functions are being registered.  Only the final registered function will be used.')\r\n        }\r\n\r\n        this._componentFunction = callback;\r\n    }\r\n\r\n    /**\r\n     * Creates a layout configuration object based on the the current state\r\n     *\r\n     * @public\r\n     * @returns {Object} GoldenLayout configuration\r\n     */\r\n    toConfig(root) {\r\n        var config, next, i;\r\n\r\n        if (this.isInitialised === false) {\r\n            throw new Error('Can\\'t create config, layout not yet initialised');\r\n        }\r\n\r\n        if (root && !(root instanceof AbstractContentItem)) {\r\n            throw new Error('Root must be a ContentItem');\r\n        }\r\n\r\n        /*\r\n         * settings & labels\r\n         */\r\n        config = {\r\n            settings: copy({}, this.config.settings),\r\n            dimensions: copy({}, this.config.dimensions),\r\n            labels: copy({}, this.config.labels)\r\n        };\r\n\r\n        /*\r\n         * Content\r\n         */\r\n        config.content = [];\r\n        next = function(configNode, item) {\r\n            var key, i;\r\n\r\n            for (key in item.config) {\r\n                if (key !== 'content') {\r\n                    configNode[key] = item.config[key];\r\n                }\r\n            }\r\n\r\n            if (item.contentItems.length) {\r\n                configNode.content = [];\r\n\r\n                for (i = 0; i < item.contentItems.length; i++) {\r\n                    configNode.content[i] = {};\r\n                    next(configNode.content[i], item.contentItems[i]);\r\n                }\r\n            }\r\n        };\r\n\r\n        if (root) {\r\n            next(config, {\r\n                contentItems: [root]\r\n            });\r\n        } else {\r\n            next(config, this.root);\r\n        }\r\n\r\n        /*\r\n         * Retrieve config for subwindows\r\n         */\r\n        this._$reconcilePopoutWindows();\r\n        config.openPopouts = [];\r\n        for (i = 0; i < this.openPopouts.length; i++) {\r\n            config.openPopouts.push(this.openPopouts[i].toConfig());\r\n        }\r\n\r\n        /*\r\n         * Add maximised item\r\n         */\r\n        config.maximisedItemId = this._maximisedItem ? '__glMaximised' : null;\r\n        return config;\r\n    }\r\n\r\n    /**\r\n     * Returns a previously registered component.  Attempts to utilize registered \r\n     * component by name first, then falls back to the component function.  If either\r\n     * lack a response for what the component should be, it throws an error.\r\n     *\r\n     * @public\r\n     * @param {Object} config - The item config\r\n     * \r\n     * @returns {Function}\r\n     */\r\n    getComponent(config) {\r\n        const name = this.getComponentNameFromConfig(config)\r\n        let componentToUse = this._components[name]\r\n        if (this._componentFunction !== undefined) {\r\n            componentToUse = componentToUse || this._componentFunction({config})\r\n        }\r\n        if (componentToUse === undefined) {\r\n            throw new ConfigurationError('Unknown component \"' + name + '\"');\r\n        }\r\n\r\n        return componentToUse;\r\n    }\r\n\r\n    /**\r\n     * Creates the actual layout. Must be called after all initial components\r\n     * are registered. Recurses through the configuration and sets up\r\n     * the item tree.\r\n     *\r\n     * If called before the document is ready it adds itself as a listener\r\n     * to the document.ready event\r\n     *\r\n     * @public\r\n     *\r\n     * @returns {void}\r\n     */\r\n    init() {\r\n\r\n        /**\r\n         * Create the popout windows straight away. If popouts are blocked\r\n         * an error is thrown on the same 'thread' rather than a timeout and can\r\n         * be caught. This also prevents any further initilisation from taking place.\r\n         */\r\n        if (this._subWindowsCreated === false) {\r\n            this._createSubWindows();\r\n            this._subWindowsCreated = true;\r\n        }\r\n\r\n\r\n        /**\r\n         * If the document isn't ready yet, wait for it.\r\n         */\r\n        if (document.readyState === 'loading' || document.body === null) {\r\n            $(document).ready(fnBind(this.init, this));\r\n            return;\r\n        }\r\n\r\n        /**\r\n         * If this is a subwindow, wait a few milliseconds for the original\r\n         * page's js calls to be executed, then replace the bodies content\r\n         * with GoldenLayout\r\n         */\r\n        if (this.isSubWindow === true && this._creationTimeoutPassed === false) {\r\n            setTimeout(fnBind(this.init, this), 7);\r\n            this._creationTimeoutPassed = true;\r\n            return;\r\n        }\r\n\r\n        if (this.isSubWindow === true) {\r\n            this._adjustToWindowMode();\r\n        }\r\n\r\n        this._setContainer();\r\n        this.dropTargetIndicator = new DropTargetIndicator(this.container);\r\n        this.transitionIndicator = new TransitionIndicator();\r\n        this.updateSize();\r\n        this._create(this.config);\r\n        this._bindEvents();\r\n        this.isInitialised = true;\r\n        this._adjustColumnsResponsive();\r\n        this.emit('initialised');\r\n    }\r\n\r\n    /**\r\n     * Updates the layout managers size\r\n     *\r\n     * @public\r\n     * @param   {[int]} width  height in pixels\r\n     * @param   {[int]} height width in pixels\r\n     *\r\n     * @returns {void}\r\n     */\r\n    updateSize(width, height) {\r\n        if (arguments.length === 2) {\r\n            this.width = width;\r\n            this.height = height;\r\n        } else {\r\n            this.width = this.container.width();\r\n            this.height = this.container.height();\r\n        }\r\n\r\n        if (this.isInitialised === true) {\r\n            this.root.callDownwards('setSize', [this.width, this.height]);\r\n\r\n            if (this._maximisedItem) {\r\n                this._maximisedItem.element.width(this.container.width());\r\n                this._maximisedItem.element.height(this.container.height());\r\n                this._maximisedItem.callDownwards('setSize');\r\n            }\r\n\r\n            this._adjustColumnsResponsive();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Destroys the LayoutManager instance itself as well as every ContentItem\r\n     * within it. After this is called nothing should be left of the LayoutManager.\r\n     *\r\n     * @public\r\n     * @returns {void}\r\n     */\r\n    destroy() {\r\n        if (this.isInitialised === false) {\r\n            return;\r\n        }\r\n        this._onUnload();\r\n        $(window).off('resize', this._resizeFunction);\r\n        $(window).off('unload beforeunload', this._unloadFunction);\r\n        this.root.callDownwards('_$destroy', [], true);\r\n        this.root.contentItems = [];\r\n        this.tabDropPlaceholder.remove();\r\n        this.dropTargetIndicator.destroy();\r\n        this.transitionIndicator.destroy();\r\n        this.eventHub.destroy();\r\n\r\n        this._dragSources.forEach(function(dragSource) {\r\n            dragSource._dragListener.destroy();\r\n            dragSource._element = null;\r\n            dragSource._itemConfig = null;\r\n            dragSource._dragListener = null;\r\n        });\r\n        this._dragSources = [];\r\n    }\r\n\r\n    /**\r\n     * Returns whether or not the config corresponds to a react component or a normal component.\r\n     * \r\n     * At some point the type is mutated, but the componentName should then correspond to the\r\n     * REACT_COMPONENT_ID.\r\n     * \r\n     * @param {Object} config ItemConfig\r\n     * \r\n     * @returns {Boolean}\r\n     */\r\n\r\n    isReactConfig(config) {\r\n        return config.type === 'react-component' || config.componentName === REACT_COMPONENT_ID\r\n    }\r\n\r\n    /**\r\n     * Returns the name of the component for the config, taking into account whether it's a react component or not.\r\n     * \r\n     * @param {Object} config ItemConfig\r\n     * \r\n     * @returns {String}\r\n     */\r\n\r\n    getComponentNameFromConfig(config) {\r\n        if (this.isReactConfig(config)) {\r\n            return config.component\r\n        }\r\n        return config.componentName\r\n    }\r\n\r\n    /**\r\n     * Recursively creates new item tree structures based on a provided\r\n     * ItemConfiguration object\r\n     *\r\n     * @public\r\n     * @param   {Object} config ItemConfig\r\n     * @param   {[ContentItem]} parent The item the newly created item should be a child of\r\n     *\r\n     * @returns {ContentItem}\r\n     */\r\n    createContentItem(config, parent) {\r\n        var typeErrorMsg, contentItem;\r\n\r\n        if (typeof config.type !== 'string') {\r\n            throw new ConfigurationError('Missing parameter \\'type\\'', config);\r\n        }\r\n\r\n        if (this.isReactConfig(config)) {\r\n            config.type = 'component';\r\n            config.componentName = REACT_COMPONENT_ID;\r\n        }\r\n\r\n        if (!this._typeToItem[config.type]) {\r\n            typeErrorMsg = 'Unknown type \\'' + config.type + '\\'. ' +\r\n                'Valid types are ' + objectKeys(this._typeToItem).join(',');\r\n\r\n            throw new ConfigurationError(typeErrorMsg);\r\n        }\r\n\r\n\r\n        /**\r\n         * We add an additional stack around every component that's not within a stack anyways.\r\n         */\r\n        if (\r\n            // If this is a component\r\n            config.type === 'component' &&\r\n\r\n            // and it's not already within a stack\r\n            !(parent instanceof Stack) &&\r\n\r\n            // and we have a parent\r\n            !!parent &&\r\n\r\n            // and it's not the topmost item in a new window\r\n            !(this.isSubWindow === true && parent instanceof Root)\r\n        ) {\r\n            config = {\r\n                type: 'stack',\r\n                width: config.width,\r\n                height: config.height,\r\n                content: [config]\r\n            };\r\n        }\r\n\r\n        contentItem = new this._typeToItem[config.type](this, config, parent);\r\n        return contentItem;\r\n    }\r\n\r\n    /**\r\n     * Creates a popout window with the specified content and dimensions\r\n     *\r\n     * @param   {Object|lm.itemsAbstractContentItem} configOrContentItem\r\n     * @param   {[Object]} dimensions A map with width, height, left and top\r\n     * @param    {[String]} parentId the id of the element this item will be appended to\r\n     *                             when popIn is called\r\n     * @param    {[Number]} indexInParent The position of this item within its parent element\r\n     \r\n     * @returns {BrowserPopout}\r\n     */\r\n    createPopout(configOrContentItem, dimensions, parentId, indexInParent) {\r\n        var config = configOrContentItem,\r\n            isItem = configOrContentItem instanceof AbstractContentItem,\r\n            self = this,\r\n            windowLeft,\r\n            windowTop,\r\n            offset,\r\n            parent,\r\n            child,\r\n            browserPopout;\r\n\r\n        parentId = parentId || null;\r\n\r\n        if (isItem) {\r\n            config = this.toConfig(configOrContentItem).content;\r\n            parentId = getUniqueId();\r\n\r\n            /**\r\n             * If the item is the only component within a stack or for some\r\n             * other reason the only child of its parent the parent will be destroyed\r\n             * when the child is removed.\r\n             *\r\n             * In order to support this we move up the tree until we find something\r\n             * that will remain after the item is being popped out\r\n             */\r\n            parent = configOrContentItem.parent;\r\n            child = configOrContentItem;\r\n            while (parent.contentItems.length === 1 && !parent.isRoot) {\r\n                parent = parent.parent;\r\n                child = child.parent;\r\n            }\r\n\r\n            parent.addId(parentId);\r\n            if (isNaN(indexInParent)) {\r\n                indexInParent = indexOf(child, parent.contentItems);\r\n            }\r\n        } else {\r\n            if (!(config instanceof Array)) {\r\n                config = [config];\r\n            }\r\n        }\r\n\r\n\r\n        if (!dimensions && isItem) {\r\n            windowLeft = window.screenX || window.screenLeft;\r\n            windowTop = window.screenY || window.screenTop;\r\n            offset = configOrContentItem.element.offset();\r\n\r\n            dimensions = {\r\n                left: windowLeft + offset.left,\r\n                top: windowTop + offset.top,\r\n                width: configOrContentItem.element.width(),\r\n                height: configOrContentItem.element.height()\r\n            };\r\n        }\r\n\r\n        if (!dimensions && !isItem) {\r\n            dimensions = {\r\n                left: window.screenX || window.screenLeft + 20,\r\n                top: window.screenY || window.screenTop + 20,\r\n                width: 500,\r\n                height: 309\r\n            };\r\n        }\r\n\r\n        if (isItem) {\r\n            configOrContentItem.remove();\r\n        }\r\n\r\n        browserPopout = new BrowserPopout(config, dimensions, parentId, indexInParent, this);\r\n\r\n        browserPopout.on('initialised', function() {\r\n            self.emit('windowOpened', browserPopout);\r\n        });\r\n\r\n        browserPopout.on('closed', function() {\r\n            self._$reconcilePopoutWindows();\r\n        });\r\n\r\n        this.openPopouts.push(browserPopout);\r\n\r\n        return browserPopout;\r\n    }\r\n\r\n    /**\r\n     * Attaches DragListener to any given DOM element\r\n     * and turns it into a way of creating new ContentItems\r\n     * by 'dragging' the DOM element into the layout\r\n     *\r\n     * @param   {jQuery DOM element} element\r\n     * @param   {Object|Function} itemConfig for the new item to be created, or a function which will provide it\r\n     *\r\n     * @returns {DragSource}  an opaque object that identifies the DOM element\r\n\t *          and the attached itemConfig. This can be used in\r\n\t *          removeDragSource() later to get rid of the drag listeners.\r\n     */\r\n    createDragSource(element, itemConfig) {\r\n        this.config.settings.constrainDragToContainer = false;\r\n        var dragSource = new DragSource($(element), itemConfig, this);\r\n        this._dragSources.push(dragSource);\r\n\r\n        return dragSource;\r\n    }\r\n\r\n    /**\r\n\t * Removes a DragListener added by createDragSource() so the corresponding\r\n\t * DOM element is not a drag source any more.\r\n\t *\r\n\t * @param   {jQuery DOM element} element\r\n\t *\r\n\t * @returns {void}\r\n\t */\r\n\tremoveDragSource(dragSource) {\r\n\t\tdragSource.destroy();\r\n\t\tlm.utils.removeFromArray( dragSource, this._dragSources );\r\n\t}\r\n\r\n    /**\r\n     * Programmatically selects an item. This deselects\r\n     * the currently selected item, selects the specified item\r\n     * and emits a selectionChanged event\r\n     *\r\n     * @param   {AbstractContentItem} item#\r\n     * @param   {[Boolean]} _$silent Wheather to notify the item of its selection\r\n     * @event    selectionChanged\r\n     *\r\n     * @returns {VOID}\r\n     */\r\n    selectItem(item, _$silent) {\r\n\r\n        if (this.config.settings.selectionEnabled !== true) {\r\n            throw new Error('Please set selectionEnabled to true to use this feature');\r\n        }\r\n\r\n        if (item === this.selectedItem) {\r\n            return;\r\n        }\r\n\r\n        if (this.selectedItem !== null) {\r\n            this.selectedItem.deselect();\r\n        }\r\n\r\n        if (item && _$silent !== true) {\r\n            item.select();\r\n        }\r\n\r\n        this.selectedItem = item;\r\n\r\n        this.emit('selectionChanged', item);\r\n    }\r\n\r\n    /*************************\r\n     * PACKAGE PRIVATE\r\n     *************************/\r\n    _$maximiseItem(contentItem) {\r\n        if (this._maximisedItem !== null) {\r\n            this._$minimiseItem(this._maximisedItem);\r\n        }\r\n        this._maximisedItem = contentItem;\r\n        contentItem.on( 'beforeItemDestroyed', this._$cleanupBeforeMaximisedItemDestroyed, this );\r\n        this._maximisedItem.addId('__glMaximised');\r\n        contentItem.element.addClass('lm_maximised');\r\n        contentItem.element.after(this._maximisePlaceholder);\r\n        this.root.element.prepend(contentItem.element);\r\n        contentItem.element.width(this.container.width());\r\n        contentItem.element.height(this.container.height());\r\n        contentItem.callDownwards('setSize');\r\n        this._maximisedItem.emit('maximised');\r\n        this.emit('stateChanged');\r\n    }\r\n\r\n    _$minimiseItem(contentItem) {\r\n        contentItem.element.removeClass('lm_maximised');\r\n        contentItem.removeId('__glMaximised');\r\n        this._maximisePlaceholder.after(contentItem.element);\r\n        this._maximisePlaceholder.remove();\r\n        contentItem.parent.callDownwards('setSize');\r\n        this._maximisedItem = null;\r\n        contentItem.off( 'beforeItemDestroyed', this._$cleanupBeforeMaximisedItemDestroyed, this );\r\n        contentItem.emit('minimised');\r\n        this.emit('stateChanged');\r\n    }\r\n\r\n    _$cleanupBeforeMaximisedItemDestroyed() {\r\n\t\tif (this._maximisedItem === event.origin) {\r\n\t\t\tthis._maximisedItem.off( 'beforeItemDestroyed', this._$cleanupBeforeMaximisedItemDestroyed, this );\r\n\t\t\tthis._maximisedItem = null;\r\n\t\t}\r\n    }\r\n    \r\n    /**\r\n     * This method is used to get around sandboxed iframe restrictions.\r\n     * If 'allow-top-navigation' is not specified in the iframe's 'sandbox' attribute\r\n     * (as is the case with codepens) the parent window is forbidden from calling certain\r\n     * methods on the child, such as window.close() or setting document.location.href.\r\n     *\r\n     * This prevented GoldenLayout popouts from popping in in codepens. The fix is to call\r\n     * _$closeWindow on the child window's gl instance which (after a timeout to disconnect\r\n     * the invoking method from the close call) closes itself.\r\n     *\r\n     * @packagePrivate\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _$closeWindow() {\r\n        window.setTimeout(function() {\r\n            window.close();\r\n        }, 1);\r\n    }\r\n\r\n    _$getArea(x, y) {\r\n        var i, area, smallestSurface = Infinity,\r\n            mathingArea = null;\r\n\r\n        for (i = 0; i < this._itemAreas.length; i++) {\r\n            area = this._itemAreas[i];\r\n\r\n            if (\r\n                x > area.x1 &&\r\n                x < area.x2 &&\r\n                y > area.y1 &&\r\n                y < area.y2 &&\r\n                smallestSurface > area.surface\r\n            ) {\r\n                smallestSurface = area.surface;\r\n                mathingArea = area;\r\n            }\r\n        }\r\n\r\n        return mathingArea;\r\n    }\r\n\r\n    _$createRootItemAreas() {\r\n        var areaSize = 50;\r\n        var sides = {\r\n            y2: 'y1',\r\n            x2: 'x1',\r\n            y1: 'y2',\r\n            x1: 'x2'\r\n        };\r\n        for (var side in sides) {\r\n            var area = this.root._$getArea();\r\n            area.side = side;\r\n            if (sides[side][1] === '2' )\r\n                area[side] = area[sides[side]] - areaSize;\r\n            else\r\n                area[side] = area[sides[side]] + areaSize;\r\n            area.surface = (area.x2 - area.x1) * (area.y2 - area.y1);\r\n            this._itemAreas.push(area);\r\n        }\r\n    }\r\n\r\n    _$calculateItemAreas() {\r\n        var i, area, allContentItems = this._getAllContentItems();\r\n        this._itemAreas = [];\r\n\r\n        /**\r\n         * If the last item is dragged out, highlight the entire container size to\r\n         * allow to re-drop it. allContentItems[ 0 ] === this.root at this point\r\n         *\r\n         * Don't include root into the possible drop areas though otherwise since it\r\n         * will used for every gap in the layout, e.g. splitters\r\n         */\r\n        if (allContentItems.length === 1) {\r\n            this._itemAreas.push(this.root._$getArea());\r\n            return;\r\n        }\r\n        this._$createRootItemAreas();\r\n\r\n        for (i = 0; i < allContentItems.length; i++) {\r\n\r\n            if (!(allContentItems[i].isStack)) {\r\n                continue;\r\n            }\r\n\r\n            area = allContentItems[i]._$getArea();\r\n\r\n            if (area === null) {\r\n                continue;\r\n            } else if (area instanceof Array) {\r\n                this._itemAreas = this._itemAreas.concat(area);\r\n            } else {\r\n                this._itemAreas.push(area);\r\n                var header = {};\r\n                copy(header, area);\r\n                copy(header, area.contentItem._contentAreaDimensions.header.highlightArea);\r\n                header.surface = (header.x2 - header.x1) * (header.y2 - header.y1);\r\n                this._itemAreas.push(header);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Takes a contentItem or a configuration and optionally a parent\r\n     * item and returns an initialised instance of the contentItem.\r\n     * If the contentItem is a function, it is first called\r\n     *\r\n     * @packagePrivate\r\n     *\r\n     * @param   {AbtractContentItem|Object|Function} contentItemOrConfig\r\n     * @param   {AbtractContentItem} parent Only necessary when passing in config\r\n     *\r\n     * @returns {AbtractContentItem}\r\n     */\r\n    _$normalizeContentItem(contentItemOrConfig, parent) {\r\n        if (!contentItemOrConfig) {\r\n            throw new Error('No content item defined');\r\n        }\r\n\r\n        if (isFunction(contentItemOrConfig)) {\r\n            contentItemOrConfig = contentItemOrConfig();\r\n        }\r\n\r\n        if (contentItemOrConfig instanceof AbstractContentItem) {\r\n            return contentItemOrConfig;\r\n        }\r\n\r\n        if ($.isPlainObject(contentItemOrConfig) && contentItemOrConfig.type) {\r\n            var newContentItem = this.createContentItem(contentItemOrConfig, parent);\r\n            newContentItem.callDownwards('_$init');\r\n            return newContentItem;\r\n        } else {\r\n            throw new Error('Invalid contentItem');\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Iterates through the array of open popout windows and removes the ones\r\n     * that are effectively closed. This is necessary due to the lack of reliably\r\n     * listening for window.close / unload events in a cross browser compatible fashion.\r\n     *\r\n     * @packagePrivate\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _$reconcilePopoutWindows() {\r\n        var openPopouts = [],\r\n            i;\r\n\r\n        for (i = 0; i < this.openPopouts.length; i++) {\r\n            if (this.openPopouts[i].getWindow().closed === false) {\r\n                openPopouts.push(this.openPopouts[i]);\r\n            } else {\r\n                this.emit('windowClosed', this.openPopouts[i]);\r\n            }\r\n        }\r\n\r\n        if (this.openPopouts.length !== openPopouts.length) {\r\n            this.openPopouts = openPopouts;\r\n            this.emit('stateChanged');\r\n        }\r\n\r\n    }\r\n\r\n    /***************************\r\n     * PRIVATE\r\n     ***************************/\r\n    /**\r\n     * Returns a flattened array of all content items,\r\n     * regardles of level or type\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _getAllContentItems() {\r\n        var allContentItems = [];\r\n\r\n        var addChildren = function(contentItem) {\r\n            allContentItems.push(contentItem);\r\n\r\n            if (contentItem.contentItems instanceof Array) {\r\n                for (var i = 0; i < contentItem.contentItems.length; i++) {\r\n                    addChildren(contentItem.contentItems[i]);\r\n                }\r\n            }\r\n        };\r\n\r\n        addChildren(this.root);\r\n\r\n        return allContentItems;\r\n    }\r\n\r\n    /**\r\n     * Binds to DOM/BOM events on init\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _bindEvents() {\r\n        if (this._isFullPage) {\r\n            $(window).resize(this._resizeFunction);\r\n        }\r\n        $(window).on('unload beforeunload', this._unloadFunction);\r\n    }\r\n\r\n    /**\r\n     * Debounces resize events\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _onResize() {\r\n        clearTimeout(this._resizeTimeoutId);\r\n        this._resizeTimeoutId = setTimeout(fnBind(this.updateSize, this), 100);\r\n    }\r\n\r\n    /**\r\n     * Extends the default config with the user specific settings and applies\r\n     * derivations. Please note that there's a separate method (AbstractContentItem._extendItemNode)\r\n     * that deals with the extension of item configs\r\n     *\r\n     * @param   {Object} config\r\n     * @static\r\n     * @returns {Object} config\r\n     */\r\n    _createConfig(config) {\r\n        var windowConfigKey = getQueryStringParam('gl-window');\r\n\r\n        if (windowConfigKey) {\r\n            this.isSubWindow = true;\r\n            config = localStorage.getItem(windowConfigKey);\r\n            config = JSON.parse(config);\r\n            config = (new ConfigMinifier()).unminifyConfig(config);\r\n            localStorage.removeItem(windowConfigKey);\r\n        }\r\n\r\n        config = $.extend(true, {}, defaultConfig, config);\r\n\r\n        var nextNode = (node) => {\r\n            for (var key in node) {\r\n                if (key !== 'props' && typeof node[key] === 'object') {\r\n                    nextNode(node[key]);\r\n                } else if (key === 'type' && this.isReactConfig(node)) {\r\n                    node.type = 'component';\r\n                    node.componentName = REACT_COMPONENT_ID;\r\n                }\r\n            }\r\n        }\r\n\r\n        nextNode(config);\r\n\r\n        if (config.settings.hasHeaders === false) {\r\n            config.dimensions.headerHeight = 0;\r\n        }\r\n\r\n        return config;\r\n    }\r\n\r\n    /**\r\n     * This is executed when GoldenLayout detects that it is run\r\n     * within a previously opened popout window.\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _adjustToWindowMode() {\r\n        var popInButton = $('<div class=\"lm_popin\" title=\"' + this.config.labels.popin + '\">' +\r\n            '<div class=\"lm_icon\"></div>' +\r\n            '<div class=\"lm_bg\"></div>' +\r\n            '</div>');\r\n\r\n        popInButton.click(fnBind(function() {\r\n            this.emit('popIn');\r\n        }, this));\r\n\r\n        document.title = stripTags(this.config.content[0].title);\r\n\r\n        $('head').append($('body link, body style, template, .gl_keep'));\r\n\r\n        this.container = $('body')\r\n            .html('')\r\n            .css('visibility', 'visible')\r\n            .append(popInButton);\r\n\r\n        /*\r\n         * This seems a bit pointless, but actually causes a reflow/re-evaluation getting around\r\n         * slickgrid's \"Cannot find stylesheet.\" bug in chrome\r\n         */\r\n        var x = document.body.offsetHeight; // jshint ignore:line\r\n\r\n        /*\r\n         * Expose this instance on the window object\r\n         * to allow the opening window to interact with\r\n         * it\r\n         */\r\n        window.__glInstance = this;\r\n    }\r\n\r\n    /**\r\n     * Creates Subwindows (if there are any). Throws an error\r\n     * if popouts are blocked.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _createSubWindows() {\r\n        var i, popout;\r\n\r\n        for (i = 0; i < this.config.openPopouts.length; i++) {\r\n            popout = this.config.openPopouts[i];\r\n\r\n            this.createPopout(\r\n                popout.content,\r\n                popout.dimensions,\r\n                popout.parentId,\r\n                popout.indexInParent\r\n            );\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Determines what element the layout will be created in\r\n     *\r\n     * @private\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _setContainer() {\r\n        var container = $(this.container || 'body');\r\n\r\n        if (container.length === 0) {\r\n            throw new Error('GoldenLayout container not found');\r\n        }\r\n\r\n        if (container.length > 1) {\r\n            throw new Error('GoldenLayout more than one container element specified');\r\n        }\r\n\r\n        if (container[0] === document.body) {\r\n            this._isFullPage = true;\r\n\r\n            $('html, body').css({\r\n                height: '100%',\r\n                margin: 0,\r\n                padding: 0,\r\n                overflow: 'hidden'\r\n            });\r\n        }\r\n\r\n        this.container = container;\r\n    }\r\n\r\n    /**\r\n     * Kicks of the initial, recursive creation chain\r\n     *\r\n     * @param   {Object} config GoldenLayout Config\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _create(config) {\r\n        var errorMsg;\r\n\r\n        if (!(config.content instanceof Array)) {\r\n            if (config.content === undefined) {\r\n                errorMsg = 'Missing setting \\'content\\' on top level of configuration';\r\n            } else {\r\n                errorMsg = 'Configuration parameter \\'content\\' must be an array';\r\n            }\r\n\r\n            throw new ConfigurationError(errorMsg, config);\r\n        }\r\n\r\n        if (config.content.length > 1) {\r\n            errorMsg = 'Top level content can\\'t contain more then one element.';\r\n            throw new ConfigurationError(errorMsg, config);\r\n        }\r\n\r\n        this.root = new Root(this, {\r\n            content: config.content\r\n        }, this.container);\r\n        this.root.callDownwards('_$init');\r\n\r\n        if (config.maximisedItemId === '__glMaximised') {\r\n            this.root.getItemsById(config.maximisedItemId)[0].toggleMaximise();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Called when the window is closed or the user navigates away\r\n     * from the page\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _onUnload() {\r\n        if (this.config.settings.closePopoutsOnUnload === true) {\r\n            for (var i = 0; i < this.openPopouts.length; i++) {\r\n                this.openPopouts[i].close();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Adjusts the number of columns to be lower to fit the screen and still maintain minItemWidth.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _adjustColumnsResponsive() {\r\n        // If there is no min width set, or not content items, do nothing.\r\n        if (!this._useResponsiveLayout() || this._updatingColumnsResponsive || !this.config.dimensions || !this.config.dimensions.minItemWidth || this.root.contentItems.length === 0 || !this.root.contentItems[0].isRow) {\r\n            this._firstLoad = false;\r\n            return;\r\n        }\r\n\r\n        this._firstLoad = false;\r\n\r\n        // If there is only one column, do nothing.\r\n        var columnCount = this.root.contentItems[0].contentItems.length;\r\n        if (columnCount <= 1) {\r\n            return;\r\n        }\r\n\r\n        // If they all still fit, do nothing.\r\n        var minItemWidth = this.config.dimensions.minItemWidth;\r\n        var totalMinWidth = columnCount * minItemWidth;\r\n        if (totalMinWidth <= this.width) {\r\n            return;\r\n        }\r\n\r\n        // Prevent updates while it is already happening.\r\n        this._updatingColumnsResponsive = true;\r\n\r\n        // Figure out how many columns to stack, and put them all in the first stack container.\r\n        var finalColumnCount = Math.max(Math.floor(this.width / minItemWidth), 1);\r\n        var stackColumnCount = columnCount - finalColumnCount;\r\n\r\n        var rootContentItem = this.root.contentItems[0];\r\n        var firstStackContainer = this._findAllStackContainers()[0];\r\n        for (var i = 0; i < stackColumnCount; i++) {\r\n            // Stack from right.\r\n            var column = rootContentItem.contentItems[rootContentItem.contentItems.length - 1];\r\n            this._addChildContentItemsToContainer(firstStackContainer, column);\r\n        }\r\n\r\n        this._updatingColumnsResponsive = false;\r\n    }\r\n\r\n    /**\r\n     * Determines if responsive layout should be used.\r\n     *\r\n     * @returns {bool} - True if responsive layout should be used; otherwise false.\r\n     */\r\n    _useResponsiveLayout() {\r\n        return this.config.settings && (this.config.settings.responsiveMode == 'always' || (this.config.settings.responsiveMode == 'onload' && this._firstLoad));\r\n    }\r\n\r\n    /**\r\n     * Adds all children of a node to another container recursively.\r\n     * @param {object} container - Container to add child content items to.\r\n     * @param {object} node - Node to search for content items.\r\n     * @returns {void}\r\n     */\r\n    _addChildContentItemsToContainer(container, node) {\r\n        if (node.type === 'stack') {\r\n            node.contentItems.forEach(function(item) {\r\n                container.addChild(item);\r\n                node.removeChild(item, true);\r\n            });\r\n        } else {\r\n            node.contentItems.forEach(fnBind(function(item) {\r\n                this._addChildContentItemsToContainer(container, item);\r\n            }, this));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Finds all the stack containers.\r\n     * @returns {array} - The found stack containers.\r\n     */\r\n    _findAllStackContainers() {\r\n        var stackContainers = [];\r\n        this._findAllStackContainersRecursive(stackContainers, this.root);\r\n\r\n        return stackContainers;\r\n    }\r\n\r\n    /**\r\n     * Finds all the stack containers.\r\n     *\r\n     * @param {array} - Set of containers to populate.\r\n     * @param {object} - Current node to process.\r\n     *\r\n     * @returns {void}\r\n     */\r\n    _findAllStackContainersRecursive(stackContainers, node) {\r\n        node.contentItems.forEach(fnBind(function(item) {\r\n            if (item.type == 'stack') {\r\n                stackContainers.push(item);\r\n            } else if (!item.isComponent) {\r\n                this._findAllStackContainersRecursive(stackContainers, item);\r\n            }\r\n        }, this));\r\n    }\r\n}\r\n\r\n/**\r\n * Hook that allows to access private classes\r\n */\r\n// LayoutManager.__lm = lm;\r\n"],"sourceRoot":""}